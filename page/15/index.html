<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
    
<!-- Google Analytics -->
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-144334903-1', 'auto');
ga('send', 'pageview');
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<!-- End Google Analytics -->


    <script data-ad-client="ca-pub-2581760538335948" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

    

    



    <meta charset="utf-8">
    
    
    
    <link rel="canonical" href="https://vitan.me/page/15/">
    
    
    <title>Vitan&#39;s Blog | ⁣⁣⁣Stay Hungry, Stay Foolish.</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="Coder,Linux,Web,Blog...">
    <meta name="description" content="Vitan&apos;s Personal Website.">
<meta name="keywords" content="Coder,Linux,Web,Blog...">
<meta property="og:type" content="website">
<meta property="og:title" content="Vitan&#39;s Blog">
<meta property="og:url" content="https://vitan.me/page/15/index.html">
<meta property="og:site_name" content="Vitan&#39;s Blog">
<meta property="og:description" content="Vitan&apos;s Personal Website.">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Vitan&#39;s Blog">
<meta name="twitter:description" content="Vitan&apos;s Personal Website.">
    
        <link rel="alternate" type="application/atom+xml" title="Vitan&#39;s Blog" href="/xml/atom.xml">
    
    <link rel="shortcut icon" href="/img/favicon.png">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu"  >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/ivitan.png">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Vitan</h5>
          <a href="mailto:admin@vitan.me" title="admin@vitan.me" class="mail">admin@vitan.me</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                分类
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                归档
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                标签
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/about"  >
                <i class="icon icon-lg icon-info-circle"></i>
                关于
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/ivitan" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Vitan&#39;s Blog</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        
            <a href="https://github.com/ivitan" class="header-icon waves-effect waves-circle waves-light" target="_blank" title="Github">
                <i class="icon icon-lg icon-github"></i>
            </a>
        
    </div>
</header>
<header class="content-header index-header">

    <div class="container fade-scale">
        <h1 class="title">Vitan&#39;s Blog</h1>
        <h5 class="subtitle">
            
            ⁣⁣⁣Stay Hungry, Stay Foolish.
            
        </h5>
    </div>

    


</header>

<div class="container body-wrap">

    <ul class="post-list">
    
        <li class="post-list-item fade">
            <article id="post-SQLconstraint"
  class="article-card article-type-post" itemprop="blogPost">

    <div class="post-meta">
        <time class="post-time" title="2018-05-08 15:16:19" datetime="2018-05-08T07:16:19.000Z"  itemprop="datePublished"><i class="icon icon-calendar"></i> 2018-05-08</time>
        
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Database/">Database</a></li></ul>



           
    </div>

    


  
    <h3 class="post-title" itemprop="name">
      <a class="post-title-link" href="/posts/SQLconstraint.html">SQL 约束</a>
    </h3>
  




    <div class="post-content" id="post-content" itemprop="postContent">

    
        <p>SQL：约束
&lt;!--more--&gt;</p>
<h1>UNIQUE 约束</h1>
<p>各约束意义</p>
<ul>
<li><code>UNIQUE</code>约束唯一标识数据库表中的每条记录。</li>
<li><code>UNIQUE</code>和<code>PRIMARY KEY</code>约束均为列或列集合提供了唯一性的保证。</li>
<li><code>PRIMARY KEY</code>约束拥有自动定义的 UNIQUE 约束。</li>
<li>请注意，每个表可以有多个 UNIQUE 约束，但是每个表只能有一个 PRIMARY KEY 约束。</li>
</ul>
<h2>CREATE TABLE 时的 UNIQUE 约束</h2>
<ul>
<li>在 &quot;Persons&quot; 表创建时在 &quot;P_Id&quot; 列上创建 UNIQUE 约束</li>
<li>MySQL</li>
</ul>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Persons</span><br><span class="line">(</span><br><span class="line">P_Id <span class="built_in">int</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">LastName <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">FirstName <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line">Address <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line">City <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line"><span class="keyword">UNIQUE</span> (P_Id)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<ul>
<li>SQL Server/Oracle/MS Access</li>
</ul>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Persons</span><br><span class="line">(</span><br><span class="line">P_Id <span class="built_in">int</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">UNIQUE</span>,</span><br><span class="line">LastName <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">FirstName <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line">Address <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line">City <span class="built_in">varchar</span>(<span class="number">255</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<h2>命名 UNIQUE 约束，并定义多个列的 UNIQUE 约束</h2>
<ul>
<li>MySQL/SQL Server/Oracle/MS Access</li>
</ul>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Persons</span><br><span class="line">(</span><br><span class="line">P_Id <span class="built_in">int</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">LastName <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">FirstName <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line">Address <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line">City <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line"><span class="keyword">CONSTRAINT</span> uc_PersonID <span class="keyword">UNIQUE</span> (P_Id,LastName)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<h2>ALTER TABLE 时的 UNIQUE 约束</h2>
<p>语法</p>
<ul>
<li>当表已被创建时，如需在 &quot;P_Id&quot; 列创建 UNIQUE 约束</li>
</ul>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Persons</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">UNIQUE</span> (P_Id)</span><br></pre></td></tr></table></figure></p>
<h2>如需命名 UNIQUE 约束，并添加 UNIQUE 约束，</h2>
<p>语法</p>
<p>MySQL / SQL Server / Oracle / MS Access：</p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Persons</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> uc_PersonID <span class="keyword">UNIQUE</span> (P_Id,LastName)</span><br></pre></td></tr></table></figure></p>
<h2>撤销 UNIQUE 约束</h2>
<p>撤销 UNIQUE 约束
MySQL</p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Persons</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">INDEX</span> uc_PersonID</span><br></pre></td></tr></table></figure></p>
<p>SQL Server / Oracle / MS Access：</p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Persons</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">CONSTRAINT</span> uc_PersonID</span><br></pre></td></tr></table></figure></p>
<h1>PRIMARY KEY 约束</h1>
<p>PRIMARY KEY 约束唯一标识数据库表中的每条记录。</p>
<ul>
<li>主键必须包含唯一的值。</li>
<li>主键列不能包含 NULL 值。</li>
<li>每个表都应该有一个主键，并且每个表只能有一个主键。</li>
</ul>
<h2>CREATE TABLE 时的 PRIMARY KEY 约束</h2>
<p>下面的 SQL 在 &quot;Persons&quot; 表创建时在 &quot;P_Id&quot; 列上创建 PRIMARY KEY 约束</p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Persons</span><br><span class="line">(</span><br><span class="line">P_Id <span class="built_in">int</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">LastName <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">FirstName <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line">Address <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line">City <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line">PRIMARY <span class="keyword">KEY</span> (P_Id)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<p>SQL Server / Oracle / MS Access</p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Persons</span><br><span class="line">(</span><br><span class="line">P_Id <span class="built_in">int</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">LastName <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">FirstName <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line">Address <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line">City <span class="built_in">varchar</span>(<span class="number">255</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<ul>
<li>如需命名 PRIMARY KEY 约束，并定义多个列的 PRIMARY KEY 约束</li>
</ul>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Persons</span><br><span class="line">(</span><br><span class="line">P_Id <span class="built_in">int</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">LastName <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">FirstName <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line">Address <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line">City <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line"><span class="keyword">CONSTRAINT</span> pk_PersonID PRIMARY <span class="keyword">KEY</span> (P_Id,LastName)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<ul>
<li>注释：在上面的实例中，只有一个主键 PRIMARY KEY（pk_PersonID）。然而，pk_PersonID 的值是由两个列（P_Id 和 LastName）组成的。</li>
</ul>
<h2>ALTER TABLE 时的 PRIMARY KEY 约束</h2>
<ul>
<li>当表已被创建时，如需在 &quot;P_Id&quot; 列创建 PRIMARY KEY 约束</li>
</ul>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Persons</span><br><span class="line"><span class="keyword">ADD</span> PRIMARY <span class="keyword">KEY</span> (P_Id)</span><br></pre></td></tr></table></figure></p>
<ul>
<li>如需命名 PRIMARY KEY 约束，并定义多个列的 PRIMARY KEY 约束</li>
</ul>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Persons</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> pk_PersonID PRIMARY <span class="keyword">KEY</span> (P_Id,LastName)</span><br></pre></td></tr></table></figure></p>
<p>注释：如果您使用 ALTER TABLE 语句添加主键，必须把主键列声明为不包含 NULL 值（在表首次创建时）。</p>
<h2>撤销 PRIMARY KEY 约束</h2>
<p>MySQL
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Persons</span><br><span class="line"><span class="keyword">DROP</span> PRIMARY <span class="keyword">KEY</span></span><br></pre></td></tr></table></figure></p>
<p>SQL Server / Oracle / MS Access
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Persons</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">CONSTRAINT</span> pk_PersonID</span><br></pre></td></tr></table></figure></p>
<h1>FOREIGN KEY 约束</h1>
<p>一个表中的 FOREIGN KEY 指向另一个表中的 PRIMARY KEY。</p>
<h2>解释外键</h2>
<table>
<thead>
<tr>
<th style="text-align:left">P_Id</th>
<th style="text-align:left">LastName</th>
<th style="text-align:left">FirstName</th>
<th style="text-align:left">Address</th>
<th style="text-align:left">City</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:left">Hansen</td>
<td style="text-align:left">Ola</td>
<td style="text-align:left">Timoteivn</td>
<td style="text-align:left">10</td>
</tr>
<tr>
<td style="text-align:left">2</td>
<td style="text-align:left">Svendson</td>
<td style="text-align:left">Tove</td>
<td style="text-align:left">Borgvn</td>
<td style="text-align:left">23</td>
</tr>
<tr>
<td style="text-align:left">3</td>
<td style="text-align:left">Pettersen</td>
<td style="text-align:left">Kari</td>
<td style="text-align:left">Storgt</td>
<td style="text-align:left">20</td>
</tr>
</tbody>
</table>
<p>&quot;Orders&quot;</p>
<table>
<thead>
<tr>
<th style="text-align:left">O_Id</th>
<th style="text-align:left">OrderNo</th>
<th style="text-align:left">P_Id</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:left">77895</td>
<td style="text-align:left">3</td>
</tr>
<tr>
<td style="text-align:left">2</td>
<td style="text-align:left">44678</td>
<td style="text-align:left">3</td>
</tr>
<tr>
<td style="text-align:left">3</td>
<td style="text-align:left">22456</td>
<td style="text-align:left">2</td>
</tr>
<tr>
<td style="text-align:left">4</td>
<td style="text-align:left">24562</td>
<td style="text-align:left">1</td>
</tr>
</tbody>
</table>
<ul>
<li>请注意，&quot;Orders&quot; 表中的 &quot;P_Id&quot; 列指向 &quot;Persons&quot; 表中的 &quot;P_Id&quot; 列。</li>
<li>&quot;Persons&quot; 表中的 &quot;P_Id&quot; 列是 &quot;Persons&quot; 表中的 PRIMARY KEY。</li>
<li>&quot;Orders&quot; 表中的 &quot;P_Id&quot; 列是 &quot;Orders&quot; 表中的 FOREIGN KEY。</li>
</ul>
<h2>FOREIGN KEY 约束用于预防破坏表之间连接的行为。</h2>
<p>作用: FOREIGN KEY 约束也能防止非法数据插入外键列，因为它必须是它指向的那个表中的值之一。</p>
<ul>
<li>CREATE TABLE 时的 FOREIGN KEY 约束
下面的 SQL 在 &quot;Orders&quot; 表创建时在 &quot;P_Id&quot; 列上创建 FOREIGN KEY 约束：</li>
</ul>
<p>MySQL：
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Orders</span><br><span class="line">(</span><br><span class="line">O_Id <span class="built_in">int</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">OrderNo <span class="built_in">int</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">P_Id <span class="built_in">int</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span> (O_Id),</span><br><span class="line"><span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (P_Id) <span class="keyword">REFERENCES</span> Persons(P_Id)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<p>SQL Server / Oracle / MS Access：
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Orders</span><br><span class="line">(</span><br><span class="line">O_Id <span class="built_in">int</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">OrderNo <span class="built_in">int</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">P_Id <span class="built_in">int</span> <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> <span class="keyword">REFERENCES</span> Persons(P_Id)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<ul>
<li>如需命名 FOREIGN KEY 约束，并定义多个列的 FOREIGN KEY 约束</li>
</ul>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Orders</span><br><span class="line">(</span><br><span class="line">O_Id <span class="built_in">int</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">OrderNo <span class="built_in">int</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">P_Id <span class="built_in">int</span>,</span><br><span class="line">PRIMARY <span class="keyword">KEY</span> (O_Id),</span><br><span class="line"><span class="keyword">CONSTRAINT</span> fk_PerOrders <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (P_Id)</span><br><span class="line"><span class="keyword">REFERENCES</span> Persons(P_Id)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<p>ALTER TABLE 时的 FOREIGN KEY 约束</p>
<ul>
<li>当 &quot;Orders&quot; 表已被创建时，如需在 &quot;P_Id&quot; 列创建 FOREIGN KEY 约束</li>
</ul>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Orders</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (P_Id)</span><br><span class="line"><span class="keyword">REFERENCES</span> Persons(P_Id)</span><br></pre></td></tr></table></figure></p>
<ul>
<li>如需命名 FOREIGN KEY 约束，并定义多个列的 FOREIGN KEY 约束</li>
</ul>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Orders</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> fk_PerOrders</span><br><span class="line"><span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (P_Id)</span><br><span class="line"><span class="keyword">REFERENCES</span> Persons(P_Id)</span><br></pre></td></tr></table></figure></p>
<h2>撤销 FOREIGN KEY 约束</h2>
<p>撤销 FOREIGN KEY 约束：</p>
<ul>
<li>MySQL</li>
</ul>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Orders</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> fk_PerOrders</span><br></pre></td></tr></table></figure></p>
<ul>
<li>SQL Server / Oracle / MS Access
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Orders</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">CONSTRAINT</span> fk_PerOrders</span><br></pre></td></tr></table></figure></li>
</ul>
<h1>CHECK 约束</h1>
<p>范围及作用</p>
<ul>
<li>CHECK 约束用于限制列中的值的范围。</li>
<li>如果对单个列定义 CHECK 约束，那么该列只允许特定的值。</li>
<li>如果对一个表定义 CHECK 约束，那么此约束会基于行中其他列的值在特定的列中对值进行限制。</li>
</ul>
<p>CREATE TABLE 时的 CHECK 约束</p>
<ul>
<li>
<p>下面的 SQL 在 &quot;Persons&quot; 表创建时在 &quot;P_Id&quot; 列上创建 CHECK 约束。CHECK 约束规定 &quot;P_Id&quot; 列必须只包含大于 0 的整数。</p>
</li>
<li>
<p>MySQL</p>
</li>
</ul>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Persons</span><br><span class="line">(</span><br><span class="line">P_Id <span class="built_in">int</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">LastName <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">FirstName <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line">Address <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line">City <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line"><span class="keyword">CHECK</span> (P_Id&gt;<span class="number">0</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<p>SQL Server / Oracle / MS Access：
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Persons</span><br><span class="line">(</span><br><span class="line">P_Id <span class="built_in">int</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">CHECK</span> (P_Id&gt;<span class="number">0</span>),</span><br><span class="line">LastName <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">FirstName <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line">Address <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line">City <span class="built_in">varchar</span>(<span class="number">255</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<ul>
<li>如需命名 CHECK 约束，并定义多个列的 CHECK 约束</li>
</ul>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Persons</span><br><span class="line">(</span><br><span class="line">P_Id <span class="built_in">int</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">LastName <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">FirstName <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line">Address <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line">City <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line"><span class="keyword">CONSTRAINT</span> chk_Person <span class="keyword">CHECK</span> (P_Id&gt;<span class="number">0</span> <span class="keyword">AND</span> City=<span class="string">'Sandnes'</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<p>ALTER TABLE 时的 CHECK 约束</p>
<ul>
<li>当表已被创建时，如需在 &quot;P_Id&quot; 列创建 CHECK 约束，请使用下面的 SQL</li>
</ul>
<p>MySQL / SQL Server / Oracle / MS Access:
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Persons</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">CHECK</span> (P_Id&gt;<span class="number">0</span>)</span><br></pre></td></tr></table></figure></p>
<ul>
<li>如需命名 CHECK 约束，并定义多个列的 CHECK 约束</li>
</ul>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Persons</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> chk_Person <span class="keyword">CHECK</span> (P_Id&gt;<span class="number">0</span> <span class="keyword">AND</span> City=<span class="string">'Sandnes'</span>)</span><br></pre></td></tr></table></figure></p>
<h2>撤销 CHECK 约束</h2>
<p>撤销 CHECK 约束
SQL Server / Oracle / MS Access：
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Persons</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">CONSTRAINT</span> chk_Person</span><br></pre></td></tr></table></figure></p>
<p>MySQL：
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Persons</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">CHECK</span> chk_Person</span><br></pre></td></tr></table></figure></p>
<h1>SQL DEFAULT 约束</h1>
<p>作用</p>
<ul>
<li>DEFAULT 约束用于向列中插入默认值。</li>
<li>如果没有规定其他的值，那么会将默认值添加到所有的新记录。</li>
</ul>
<p>CREATE TABLE 时的 DEFAULT 约束
下面的 SQL 在 &quot;Persons&quot; 表创建时在 &quot;City&quot; 列上创建 DEFAULT 约束：
My SQL / SQL Server / Oracle / MS Access
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Persons</span><br><span class="line">(</span><br><span class="line">P_Id <span class="built_in">int</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">LastName <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">FirstName <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line">Address <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line">City <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="string">'Sandnes'</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<ul>
<li>通过使用类似 GETDATE() 这样的函数，DEFAULT 约束也可以用于插入系统值：</li>
</ul>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Orders</span><br><span class="line">(</span><br><span class="line">O_Id <span class="built_in">int</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">OrderNo <span class="built_in">int</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">P_Id <span class="built_in">int</span>,</span><br><span class="line">OrderDate <span class="built_in">date</span> <span class="keyword">DEFAULT</span> <span class="keyword">GETDATE</span>()</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<p>ALTER TABLE 时的 DEFAULT 约束</p>
<ul>
<li>当表已被创建时，如需在 &quot;City&quot; 列创建 DEFAULT 约束</li>
<li>MySQL</li>
</ul>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Persons</span><br><span class="line"><span class="keyword">ALTER</span> City <span class="keyword">SET</span> <span class="keyword">DEFAULT</span> <span class="string">'SANDNES'</span></span><br></pre></td></tr></table></figure></p>
<ul>
<li>SQL Server / MS Access</li>
</ul>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Persons</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">COLUMN</span> City <span class="keyword">SET</span> <span class="keyword">DEFAULT</span> <span class="string">'SANDNES'</span></span><br></pre></td></tr></table></figure></p>
<ul>
<li>Oracle</li>
</ul>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Persons</span><br><span class="line"><span class="keyword">MODIFY</span> City <span class="keyword">DEFAULT</span> <span class="string">'SANDNES'</span></span><br></pre></td></tr></table></figure></p>
<h2>撤销 DEFAULT 约束</h2>
<p>撤销 DEFAULT 约束</p>
<ul>
<li>MySQL</li>
</ul>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Persons</span><br><span class="line"><span class="keyword">ALTER</span> City <span class="keyword">DROP</span> <span class="keyword">DEFAULT</span></span><br></pre></td></tr></table></figure></p>
<ul>
<li>SQL Server / Oracle / MS Access</li>
</ul>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Persons</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">COLUMN</span> City <span class="keyword">DROP</span> <span class="keyword">DEFAULT</span></span><br></pre></td></tr></table></figure></p>
<hr>
<p><strong>来源</strong></p>
<ul>
<li><a href="http://www.runoob.com" target="_blank" rel="noopener">菜鸟教材</a></li>
</ul>

    

        <a href="/posts/SQLconstraint.html" class="post-more waves-effect waves-button">
            阅读全文…
        </a>
    </div>
    
    <div class="post-footer">
        
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SQL/">SQL</a></li></ul>

    </div>
    
</article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-Win10-Share-WiFI"
  class="article-card article-type-post" itemprop="blogPost">

    <div class="post-meta">
        <time class="post-time" title="2018-05-04 19:03:13" datetime="2018-05-04T11:03:13.000Z"  itemprop="datePublished"><i class="icon icon-calendar"></i> 2018-05-04</time>
        
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Diary/">Diary</a></li></ul>



           
    </div>

    


  
    <h3 class="post-title" itemprop="name">
      <a class="post-title-link" href="/posts/Win10-Share-WiFI.html">Win10 开热点给手机</a>
    </h3>
  




    <div class="post-content" id="post-content" itemprop="postContent">

    
        <blockquote>
<p>在 Windows 10 中使用 &quot;飞机&quot; 工具共享热点给手机,解决刷机后开机登录 Google 账号。</p>
</blockquote>
<h1>方法</h1>
<h2>电脑端</h2>
<ol>
<li>右键飞机托盘图标 --&gt; 选项设置 --&gt; 勾选 <code>允许来自局域网连接</code></li>
<li>CMD --&gt; 输入 <code>ipconfig</code> 获取 <code>无线的IPV4地址</code></li>
<li>正常开启热点
&lt;!--more--&gt;</li>
</ol>
<h2>手机端</h2>
<ol>
<li>长按连接的 WiFi 名,点修改网络</li>
<li>显示高级选项</li>
<li>代理</li>
<li>手动</li>
<li>服务器主机IP输入刚刚获取的 <code>IPV4地址</code>, 端口 <code>1080</code></li>
<li>保存</li>
</ol>
<hr>
<h1>跳过谷歌验证</h1>
<h2>方法一</h2>
<p>即上述 Windows 10 开热点的方法</p>
<h2>方法二</h2>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">adb shell settings put secure user_setup_complete 1</span><br><span class="line">adb shell settings put global device_provisioned 1</span><br></pre></td></tr></table></figure></p>
<h2>方法三</h2>
<p>开机前不插入 SIM 卡,开机后不连接 WIFI,在开机导向时可以有选择跳过登录 Google 账号</p>
<h2>方法四</h2>
<p>顺时针方向，从左上角开始,连点屏幕四角</p>

    

        <a href="/posts/Win10-Share-WiFI.html" class="post-more waves-effect waves-button">
            阅读全文…
        </a>
    </div>
    
    <div class="post-footer">
        
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Note/">Note</a></li></ul>

    </div>
    
</article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-Linux-Commands"
  class="article-card article-type-post" itemprop="blogPost">

    <div class="post-meta">
        <time class="post-time" title="2018-05-02 21:56:31" datetime="2018-05-02T13:56:31.000Z"  itemprop="datePublished"><i class="icon icon-calendar"></i> 2018-05-02</time>
        
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Linux/">Linux</a></li></ul>



           
    </div>

    


  
    <h3 class="post-title" itemprop="name">
      <a class="post-title-link" href="/posts/Linux-Commands.html">Linux 基础命令</a>
    </h3>
  




    <div class="post-content" id="post-content" itemprop="postContent">

    
        <p>Linux 基础命令
&lt;!--more--&gt;</p>
<h1>目录操作命令</h1>
<h2>ls</h2>
<p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">命令英文原意：list</span><br><span class="line">命令所在路径：/bin/ls</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：显示目录文件</span><br><span class="line">ls <span class="comment"># 显示当前目录下文件</span></span><br><span class="line">ls 目录名 <span class="comment"># 显示指定目录下文件</span></span><br><span class="line">ls -l <span class="comment"># 长格式显示目录文件</span></span><br><span class="line">ls -l 文件名 <span class="comment"># 长格式显示指定文件</span></span><br><span class="line">ls -a <span class="comment"># 显示所有文件(包含隐藏文件)</span></span><br><span class="line">ls -al <span class="comment"># 长格式显示当前目录下所有文件)</span></span><br><span class="line">ls -h <span class="comment"># 文件大小显示为常见大小单位 B KB MB ...</span></span><br><span class="line">ls -d <span class="comment"># 显示目录本身，而不是里面的子文件</span></span><br></pre></td></tr></table></figure></p>
<h2>cd</h2>
<p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">命令英文原意：change directory</span><br><span class="line">命令所在路径：shell内置命令</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：切换所在目录</span><br><span class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span>/src 切换到指定路径(使用绝对路径方式)</span><br><span class="line"><span class="built_in">cd</span> ~ <span class="comment"># 进入当前用户的家目录</span></span><br><span class="line"><span class="built_in">cd</span> - <span class="comment"># 进入上次目录</span></span><br><span class="line"><span class="built_in">cd</span> .. <span class="comment"># 进入上一级目录</span></span><br><span class="line"><span class="built_in">cd</span> . <span class="comment"># 进入当前目录</span></span><br><span class="line">绝对路径：<span class="built_in">cd</span> ../usr/<span class="built_in">local</span> 参照当前所在目录，进行查找。一定要先确定当前所在目录。</span><br><span class="line">相对路径：<span class="built_in">cd</span> /usr/<span class="built_in">local</span> 从根目录开始指定，一级一级递归查找。</span><br><span class="line">在任何目录下，都能进入指定位置。</span><br></pre></td></tr></table></figure></p>
<h2>pwd</h2>
<p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">命令英文原意：<span class="built_in">print</span> working directory</span><br><span class="line">命令所在路径：/bin/<span class="built_in">pwd</span></span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：显示当前所在目录(当前工作目录)</span><br></pre></td></tr></table></figure></p>
<h2>mkdir</h2>
<p><figure class="highlight hsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">命令英文原意：make directories</span><br><span class="line">命令所在路径：/bin/<span class="keyword">mkdir</span></span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：建立目录</span><br><span class="line"><span class="keyword">mkdir</span> test  <span class="meta"># 创建名为test的目录</span></span><br><span class="line"><span class="keyword">mkdir</span> -p test1/test2/test3 <span class="meta">#递归创建</span></span><br></pre></td></tr></table></figure></p>
<h2>rmdir</h2>
<p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">命令英文原意：remove empty directories</span><br><span class="line">命令所在路径：/bin/rmdir</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：删除目录 (只能删除空目录)</span><br></pre></td></tr></table></figure></p>
<h1>文件操作命令</h1>
<h2>touch</h2>
<p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">命令所在路径：/bin/touch</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：创建空文件 或 修改文件时间</span><br><span class="line">touch test.py <span class="comment"># 创建空文件，如果文件存在，则修改文件创建时间</span></span><br></pre></td></tr></table></figure></p>
<h2>rm</h2>
<p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">命令英文原意：remove</span><br><span class="line">命令所在路径：/bin/rm</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：删除</span><br><span class="line">rm 文件名 <span class="comment"># 删除文件</span></span><br><span class="line">rm -r 目录名 <span class="comment"># 递归删除文件和目录</span></span><br><span class="line">rm -f 文件名 <span class="comment"># 强制删除</span></span><br><span class="line">rm -rf 目录名 <span class="comment"># 强制删除目录和文件</span></span><br></pre></td></tr></table></figure></p>
<h2>cat</h2>
<p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">命令所在路径：/bin/cat</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：查看文件内容，从头到尾的内容。</span><br><span class="line">cat 文件名  <span class="comment"># 查看文件内容内容</span></span><br><span class="line">cat -n 文件名 <span class="comment"># 查看文件内容，并列出行号</span></span><br></pre></td></tr></table></figure></p>
<h2>more</h2>
<p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">命令所在路径：/bin/more</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：分屏显示文件内容</span><br><span class="line">more 文件名    分屏显示文件内容</span><br><span class="line">向上翻页  空格键</span><br><span class="line">向下翻页  b键</span><br><span class="line">退出查看  q键</span><br></pre></td></tr></table></figure></p>
<h2>head</h2>
<p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">命令所在路径：<span class="meta-keyword">/usr/</span>bin/head</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：显示文件头</span><br><span class="line">head 文件名 <span class="meta"># 显示文件头几行(默认显示10行)</span></span><br><span class="line">head -n <span class="number">20</span> 文件名 <span class="meta"># 显示文件前20行</span></span><br><span class="line">head -n <span class="number">-20</span> 文件名 <span class="meta"># 显示文件最后20行</span></span><br><span class="line">ctrl + c <span class="meta"># 强制终止查看模式</span></span><br><span class="line">ctrl + l  <span class="meta"># 清屏</span></span><br></pre></td></tr></table></figure></p>
<h2>ln</h2>
<p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">命令英文原意：link</span><br><span class="line">命令所在路径：/bin/ln</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：链接文件</span><br><span class="line">等同于Windows中的快捷方式</span><br><span class="line">新建的链接，占用不同的硬盘位置</span><br><span class="line">修改一个文件，两边都会改变</span><br><span class="line">删除源文件，软连接文件打不开</span><br><span class="line">ln -s 源文件 目标文件 <span class="comment"># 创建链接文件(文件名都必须写绝对路径)</span></span><br></pre></td></tr></table></figure></p>
<h1>文件和目录都能操作的命令</h1>
<h2>rm</h2>
<p>删除文件或目录</p>
<h2>cp</h2>
<p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">命令英文原意：copy</span><br><span class="line">命令所在路径：/bin/cp</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：复制文件或目录</span><br><span class="line">cp 源文件 目标位置  <span class="comment"># 复制</span></span><br><span class="line"></span><br><span class="line">cp 源文件 目标位置/目标名称  <span class="comment"># 复制并改名</span></span><br><span class="line">cp -r <span class="comment"># 复制目录</span></span><br><span class="line">cp -p <span class="comment"># 连带文件属性一起复制</span></span><br><span class="line">cp -d <span class="comment"># 若源文件是链接文件，则复制链接属性</span></span><br><span class="line">cp -a <span class="comment"># 相当于 cp -pdr</span></span><br></pre></td></tr></table></figure></p>
<h2>mv</h2>
<p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">命令英文原意：move</span><br><span class="line">命令所在路径：/bin/mv</span><br><span class="line">执行权限：所有用户</span><br><span class="line">mv 源文件 目标位置</span><br><span class="line">mv /root/<span class="built_in">test</span> /tmp/  </span><br><span class="line"><span class="comment"># 将/root/下的test文件移动到/tmp/目录下</span></span><br><span class="line">mv /root/<span class="built_in">test</span> /root/newtest   </span><br><span class="line"><span class="comment"># 将/root/下的test文件改名为newtest</span></span><br></pre></td></tr></table></figure></p>
<h1>挂载命令</h1>
<h2>mount</h2>
<p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">命令所在路径：/<span class="keyword">bin/mount</span></span><br><span class="line"><span class="keyword">执行权限：所有用户</span></span><br><span class="line"><span class="keyword">功能描述：挂载</span></span><br><span class="line"><span class="keyword">linux所有存储设备都必须挂载使用，包括硬盘</span></span><br></pre></td></tr></table></figure></p>
<h2>光盘挂载</h2>
<p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">/dev/</span>sda1 <span class="comment"># 第一个scsi硬盘的第一分区</span></span><br><span class="line"><span class="regexp">/dev/</span>cdrom  <span class="comment"># 光盘</span></span><br><span class="line"><span class="regexp">/dev/</span>hdc  <span class="comment"># fIDE硬盘 centos 5.5</span></span><br><span class="line"><span class="regexp">/dev/</span>sr0  <span class="comment"># 光盘      centos 6.x</span></span><br><span class="line">mount -t 文件系统 设备描述文件 挂载点（已经存在空目录）</span><br><span class="line">mount -t iso9660 <span class="regexp">/dev/</span>cdrom <span class="regexp">/mnt/</span>cdrom</span><br></pre></td></tr></table></figure></p>
<h2>光盘卸载</h2>
<p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">umount <span class="regexp">/dev/</span>cdrom</span><br><span class="line">umount <span class="regexp">/mnt/</span>cdrom      注意：退出挂载目录，才能卸载</span><br><span class="line">fdisk -l 查看设备名</span><br><span class="line">mount -t vfat <span class="regexp">/dev/</span>sdb1 <span class="regexp">/mnt/u</span>sb</span><br></pre></td></tr></table></figure></p>
<h1>网络命令</h1>
<h2>ping</h2>
<p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">命令所在路径：/bin/ping</span><br><span class="line">执行权限：所有用户</span><br><span class="line">功能描述：测试网络畅通性</span><br><span class="line">ping -c 次数<span class="built_in"> ip </span># 探测网络通畅</span><br></pre></td></tr></table></figure></p>
<h2>ifconfig</h2>
<p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">命令英文原意：<span class="keyword">interface</span> <span class="symbol">configure</span></span><br><span class="line">命令所在路径：/<span class="symbol">sbin</span>/<span class="symbol">ifconfig</span></span><br><span class="line">执行权限：<span class="symbol">root</span></span><br><span class="line">功能描述：查询本机网络信息</span><br></pre></td></tr></table></figure></p>
<h1>Linux 系统分类</h1>
<ol>
<li>RedHat 系列：Redhat、Centos、Fedora 等
<ul>
<li>RPM (Red Hat系)：CentOS、Fedora</li>
</ul>
</li>
<li>Debian 系列：Debian、Ubuntu 等
<ul>
<li>Dpkg (Debian系)：Ubuntu LinuxMint</li>
</ul>
</li>
<li>ArchLinux
<ul>
<li>ArchLinux、Manjaro、Antergos 等.</li>
</ul>
</li>
</ol>
<h2>软件包管理工具</h2>
<h3>Debian 系列</h3>
<ol>
<li>常见的安装包格式 deb 包，安装 deb 包的命令是<code>dpkg -选项 -xxx.deb</code></li>
</ol>
<ul>
<li>选项
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="deletion">-i：安装软件包</span></span><br><span class="line"><span class="deletion">-r：删除软件包</span></span><br><span class="line"><span class="deletion">-P：删除软件包的同时删除其配置文件</span></span><br><span class="line"><span class="deletion">-L：显示于软件包关联的文件</span></span><br><span class="line"><span class="deletion">-l：显示已安装软件包列表</span></span><br><span class="line"><span class="deletion">--unpack：解开软件包</span></span><br><span class="line"><span class="deletion">-c：显示软件包内文件列表</span></span><br><span class="line"><span class="deletion">--confiugre：配置软件包</span></span><br></pre></td></tr></table></figure></li>
</ul>
<ol start="2">
<li>包管理工具 apt-get</li>
<li>支持 tar 包</li>
</ol>
<ul>
<li>
<p>dpkg 实例
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">dpkg -i package.deb <span class="comment">#安装包</span></span><br><span class="line">dpkg -r package <span class="comment">#删除包</span></span><br><span class="line">dpkg -P package <span class="comment">#删除包（包括配置文件）</span></span><br><span class="line">dpkg -L package <span class="comment">#列出与该包关联的文件</span></span><br><span class="line">dpkg -l package <span class="comment">#显示该包的版本</span></span><br><span class="line">dpkg --unpack package.deb  <span class="comment">#解开deb包的内容</span></span><br><span class="line">dpkg -S keyword <span class="comment">#搜索所属的包内容</span></span><br><span class="line">dpkg -l <span class="comment">#列出当前已安装的包</span></span><br><span class="line">dpkg -c package.deb<span class="comment">#列出deb包的内容</span></span><br><span class="line">dpkg --configure package<span class="comment">#配置包</span></span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>apt 包管理
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get <span class="comment">(选项)</span><span class="comment">(参数)</span></span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>实例
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">apt-<span class="builtin-name">get</span> update #更新源</span><br><span class="line">apt-<span class="builtin-name">get</span><span class="built_in"> upgrade </span>#更新所有已安装的软件包</span><br><span class="line">apt-<span class="builtin-name">get</span> install packagename #安装软件包</span><br><span class="line">apt-<span class="builtin-name">get</span> <span class="builtin-name">remove</span> packagename #卸载软件包(保留配置文件)</span><br><span class="line">apt-<span class="builtin-name">get</span> –purge <span class="builtin-name">remove</span> packagename # 卸载软件包(删除配置文件)</span><br><span class="line">apt-<span class="builtin-name">get</span> autoclean apt #删除你已经删掉的软件</span><br><span class="line">apt-<span class="builtin-name">get</span> dist-upgrade #将系统升级到新版本</span><br><span class="line">apt-<span class="builtin-name">get</span> autoclean #清除已经卸载的软件包的.deb文件</span><br></pre></td></tr></table></figure></p>
</li>
</ul>
<h2>RedHat 系列</h2>
<ol>
<li>常见的安装包格式 rpm 包，安装rpm包的命令是`rpm -参数 [-rpm包]</li>
</ol>
<ul>
<li>参数
<figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">-<span class="ruby">a：查询所有套件；</span></span><br><span class="line"><span class="ruby">-b&lt;完成阶段&gt;&lt;套件档&gt;+或-t &lt;完成阶段&gt;&lt;套件档&gt;+：设置包装套件的完成阶段，并指定套件档的文件名称；</span></span><br><span class="line"><span class="ruby">-c：只列出组态配置文件，本参数需配合<span class="string">"-l"</span>参数使用；</span></span><br><span class="line"><span class="ruby">-d：只列出文本文件，本参数需配合<span class="string">"-l"</span>参数使用；</span></span><br><span class="line"><span class="ruby">-e&lt;套件档&gt;或--erase&lt;套件档&gt;：删除指定的套件；</span></span><br><span class="line"><span class="ruby">-f&lt;文件&gt;+：查询拥有指定文件的套件；</span></span><br><span class="line"><span class="ruby">-h或--hash：套件安装时列出标记；</span></span><br><span class="line"><span class="ruby">-i：显示套件的相关信息；</span></span><br><span class="line"><span class="ruby">-i&lt;套件档&gt;或--install&lt;套件档&gt;：安装指定的套件档；</span></span><br><span class="line"><span class="ruby">-l：显示套件的文件列表；</span></span><br><span class="line"><span class="ruby">-p&lt;套件档&gt;+：查询指定的RPM套件档；</span></span><br><span class="line"><span class="ruby">-q：使用询问模式，当遇到任何问题时，rpm指令会先询问用户；</span></span><br><span class="line"><span class="ruby">-R：显示套件的关联性信息；</span></span><br><span class="line"><span class="ruby">-s：显示文件状态，本参数需配合<span class="string">"-l"</span>参数使用；</span></span><br><span class="line"><span class="ruby">-U&lt;套件档&gt;或--upgrade&lt;套件档&gt;：升级指定的套件档；</span></span><br><span class="line"><span class="ruby">-v：显示指令执行过程；</span></span><br><span class="line"><span class="ruby">-vv：详细显示指令执行过程，便于排错。</span></span><br></pre></td></tr></table></figure></li>
</ul>
<ol start="2">
<li>包管理工具<code>yum -选项 -参数</code></li>
</ol>
<ul>
<li>
<p>选项
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="deletion">-h：显示帮助信息；</span></span><br><span class="line"><span class="deletion">-y：对所有的提问都回答“yes”；</span></span><br><span class="line"><span class="deletion">-c：指定配置文件；</span></span><br><span class="line"><span class="deletion">-q：安静模式；</span></span><br><span class="line"><span class="deletion">-v：详细模式；</span></span><br><span class="line"><span class="deletion">-d：设置调试等级（0-10）；</span></span><br><span class="line"><span class="deletion">-e：设置错误等级（0-10）；</span></span><br><span class="line"><span class="deletion">-R：设置yum处理一个命令的最大等待时间；</span></span><br><span class="line"><span class="deletion">-C：完全从缓存中运行，而不去下载或者更新任何头文件。</span></span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>参数
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">install：安装rpm软件包；</span><br><span class="line"><span class="keyword">update</span>：更新rpm软件包；</span><br><span class="line">check-<span class="keyword">update</span>：检查是否有可用的更新rpm软件包；</span><br><span class="line"><span class="built_in">remove</span>：删除指定的rpm软件包；</span><br><span class="line"><span class="keyword">list</span>：显示软件包的信息；</span><br><span class="line"><span class="built_in">search</span>：检查软件包的信息；</span><br><span class="line">info：显示指定的rpm软件包的描述信息和概要信息；</span><br><span class="line">clean：清理yum过期的缓存；</span><br><span class="line"><span class="keyword">shell</span>：进入yum的<span class="keyword">shell</span>提示符；</span><br><span class="line">resolvedep：显示rpm软件包的依赖关系；</span><br><span class="line">localinstall：安装本地的rpm软件包；</span><br><span class="line">localupdate：显示本地rpm软件包进行更新；</span><br><span class="line">deplist：显示rpm软件包的所有依赖关系。</span><br></pre></td></tr></table></figure></p>
</li>
</ul>
<ol start="3">
<li>支持 tar 包</li>
</ol>
<ul>
<li>yum 实例</li>
</ul>
<ul>
<li>
<p>安装
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum <span class="keyword">install</span> <span class="comment">#全部安装</span></span><br><span class="line">yum <span class="keyword">install</span> package1 <span class="comment">#安装指定的安装包package1</span></span><br><span class="line">yum groupinsall group1 <span class="comment">#安装程序组group1</span></span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>更新和升级
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">yum update <span class="comment">#全部更新</span></span><br><span class="line">yum update package1 <span class="comment">#更新指定程序包package1</span></span><br><span class="line">yum<span class="built_in"> check-update </span><span class="comment">#检查可更新的程序</span></span><br><span class="line">yum upgrade package1 <span class="comment">#升级指定程序包package1</span></span><br><span class="line">yum groupupdate group1<span class="comment">#升级程序组group1</span></span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>查找和显示
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">yum info package1 <span class="comment">#显示安装包信息package1</span></span><br><span class="line">yum <span class="built_in">list</span> <span class="comment">#显示所有已经安装和可以安装的程序包</span></span><br><span class="line">yum <span class="built_in">list</span> package1 <span class="comment">#显示指定程序包安装情况package1</span></span><br><span class="line">	yum groupinfo group1<span class="comment">#显示程序组group1信息yum search string 根据关键字string查找安装包</span></span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>删除程序
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum remove &amp;#<span class="number">124</span>; erase package1  #删除程序包package1</span><br><span class="line">yum groupremove group1  #删除程序组group1</span><br><span class="line">yum deplist package1  #查看程序package1依赖情况</span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>清除缓存
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">yum</span> clean packages <span class="comment">#清除缓存目录下的软件包</span></span><br><span class="line">yum clean headers <span class="comment">#清除缓存目录下的 headers</span></span><br><span class="line">yum clean oldheaders <span class="comment">#清除缓存目录下旧的 headers</span></span><br></pre></td></tr></table></figure></p>
</li>
</ul>
<p><strong>参考</strong></p>
<ul>
<li><a href="http://man.linuxde.net/" target="_blank" rel="noopener">Linux命令</a></li>
</ul>
<h1>查询命令</h1>
<h2>find</h2>
<p><figure class="highlight golo"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">find</span> [搜索范围] [搜索文件]`</span><br><span class="line"><span class="keyword">find</span> / -name install.log</span><br><span class="line">避免大范围搜索,会非常耗费系统资源</span><br><span class="line"><span class="keyword">find</span>是在系统当中搜索符合条件的文件名,如果需要匹配 使用通配符匹配,通配符是完全匹配。</span><br><span class="line"></span><br><span class="line"><span class="keyword">find</span> /root -iname installlog <span class="comment">#不区分大小写</span></span><br><span class="line"><span class="keyword">find</span> /root -user root <span class="comment">#按照所有者搜索</span></span><br><span class="line"><span class="keyword">find</span>/root -nouser <span class="comment">#查找没有所有者的文件</span></span><br></pre></td></tr></table></figure></p>
<ol>
<li>find /var/log/ -mtime +10 #查找10天前修改的文件</li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:left">-10</th>
<th style="text-align:left">10天内修改文件</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">10</td>
<td style="text-align:left">10天当天修改的文件</td>
</tr>
<tr>
<td style="text-align:left">+10</td>
<td style="text-align:left">10天前修改的文件</td>
</tr>
<tr>
<td style="text-align:left">atime</td>
<td style="text-align:left">文件访问时间</td>
</tr>
</tbody>
</table>
<ol start="2">
<li>find . -size #查找文件大小是25KB的文件</li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:left">-25k</th>
<th style="text-align:left">小于25KB的文件</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">25k</td>
<td style="text-align:left">等于25KB的文件</td>
</tr>
<tr>
<td style="text-align:left">+25k</td>
<td style="text-align:left">大于25KB的文件</td>
</tr>
</tbody>
</table>
<ol start="3">
<li>find -inum 262422 #查找 节点是262422的文件</li>
<li>find /etc -size +20k -a -size -50k #查找/etc/目录下,大于20KB并且小于50KB的文件</li>
</ol>
<ul>
<li>a and逻辑与,两个条件都满足 or 逻辑或,两个条件满足一个即可</li>
</ul>
<ol start="5">
<li>find /etc-size +20k-a-size-50k -exec ls-lh {} 1; #查找/etc/目录下,大于20KB并且小于50KB的文件,并显示详细信  #-exec/-ok命令() 对搜索结果执行操</li>
</ol>
<h2>搜索字符串命令grep</h2>
<ul>
<li>grep [选项]字符串文件名
在文件当中匹配符合条件的字符串
选项: <code>-i</code> 忽略大小写 <code>-v</code>排除指定字符串</li>
</ul>
<h2>find命令与grep命令的区别</h2>
<ul>
<li>find命令:在系统当中搜索符合条件的文件名,如果需要匹配 使用通配符匹配,通配符是完全匹配。</li>
<li>grep命令:在文件当中搜索符合条件的字符串,如果需要匹配 使用正则表达式进行匹配,正则表达式时包含匹配</li>
</ul>
<h1>man 命令</h1>
<p>man 命令 #获取指定命令的帮助<br>
man ls  #查看ls的帮助</p>
<ul>
<li>查看命令拥有那个级别的帮助
man -f 命令 相当于 whatis 命令</li>
</ul>
<p>举例:
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">man <span class="number">-5</span> passwd</span><br><span class="line">man <span class="number">-4</span> <span class="literal">null</span></span><br><span class="line">man <span class="number">-8</span> ifconfig</span><br></pre></td></tr></table></figure></p>
<ul>
<li>shell 内部命令帮助
help shell 内部命令 #获取shell内部命令的帮助</li>
</ul>
<p>例如:
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">whereis <span class="built_in">cd</span> <span class="comment">#确定是否是shell内部命令</span></span><br><span class="line"><span class="built_in">help</span> <span class="built_in">cd</span> <span class="comment">#获取内部命令帮助</span></span><br></pre></td></tr></table></figure></p>
<h2>详细命令帮助info info命令</h2>
<p>回车|进入子帮助页面(带有<code>*</code>号标记)</p>
<p>|:---:|:---:|
|u|进入上层页面|
|n|进入下一个帮助小节|
|p|进入上一个帮助小节|
|q|退出|</p>
<h1>压缩</h1>
<h2>zip格式压缩</h2>
<p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">zip</span> 压缩文件名  源文件 <span class="comment">#压缩文件</span></span><br><span class="line">zip -r 压缩文件名 源目录  <span class="comment">#压缩目录</span></span><br></pre></td></tr></table></figure></p>
<h2>gzip格式压缩</h2>
<p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">gzip</span> 源文件  <span class="comment">#压缩为.gz格式的压缩文件.源文件会消失</span></span><br><span class="line">gzip -c 源文件&gt;压缩文件 <span class="comment"># 压缩为.gzi格式,源文件保留</span></span><br></pre></td></tr></table></figure></p>
<h2>gz格式解压缩</h2>
<p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">gzip</span> -d 压缩文件 <span class="comment">#解压缩文件</span></span><br><span class="line">gunzip 压缩文件  <span class="comment">#解压缩文件</span></span><br></pre></td></tr></table></figure></p>
<h2>bz2格式压缩</h2>
<p><figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">bzip2</span> 源文件 <span class="comment">#压缩为.bz2格式.不保留源文件</span></span><br><span class="line"><span class="literal">bzip2</span> -k 源文件 <span class="comment">#压缩之后保留源文件</span></span><br><span class="line">注意: <span class="literal">bzip2</span>命令不能压缩目录</span><br></pre></td></tr></table></figure></p>
<h1>打包</h1>
<h2>tar</h2>
<p><figure class="highlight ldif"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">tar -cvf 打包文件名 源文件</span></span><br><span class="line"><span class="attribute">选项</span>: -c打包</span><br><span class="line"><span class="literal">-v显示过程</span></span><br><span class="line"><span class="literal">-f指定打包后的文件名</span></span><br></pre></td></tr></table></figure></p>
<h1>解打包命令</h1>
<p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tar -xvf 打包文件名</span><br><span class="line">选项:</span><br><span class="line"><span class="deletion">-x解打包</span></span><br></pre></td></tr></table></figure></p>
<h2>tar.gz压缩格式</h2>
<p>其实.tar.gz格式是先打包为.tar格式,再压缩为.gz格式</p>
<ol>
<li>tar -zcvf 压缩包名tar.gz 源文件</li>
</ol>
<ul>
<li>选项: <code>-z</code>压缩为.tar.gz格式</li>
</ul>
<ol start="2">
<li>tar -zxvf 压缩包名tar.gz</li>
</ol>
<ul>
<li>选项:<code>-x</code> 解压缩.tar.gz格式</li>
</ul>
<h2>tar.bz2压缩格式</h2>
<p>:1. tar -jcvf压缩包名.tar.bz2 源文件</p>
<ul>
<li>选项:<code>-z</code>压缩为.tar.bz2格式</li>
</ul>
<ol start="2">
<li>tar -jxvf 压缩包名·tar.bz2</li>
</ol>
<ul>
<li>选项: <code>-x</code>解压缩.tar.bz2格式</li>
</ul>
<h1>shell命令</h1>
<h2>shutdown命令</h2>
<p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">shutdown [选项] 时间</span><br><span class="line">选项:</span><br><span class="line"><span class="deletion">-c 取消前一个关机命令</span></span><br><span class="line"><span class="deletion">-h 关机  </span></span><br><span class="line"><span class="deletion">-r 重启</span></span><br></pre></td></tr></table></figure></p>
<h2>其他关机命令</h2>
<p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">halt</span></span><br><span class="line"><span class="attr">poweroff</span></span><br><span class="line"><span class="attr">init</span> <span class="string">0</span></span><br><span class="line"><span class="attr">重启命令</span></span><br><span class="line"><span class="attr">reboot</span></span><br><span class="line"><span class="attr">init</span> <span class="string">6</span></span><br><span class="line"></span><br><span class="line"><span class="attr">系统运行级别</span></span><br><span class="line"><span class="attr">查看系统运行级别</span></span><br><span class="line"><span class="attr">cat</span> <span class="string">/etc/inittab</span></span><br><span class="line"><span class="meta">程序员之路</span>: <span class="string">Linux关机与重启</span></span><br><span class="line"><span class="attr">退出登录</span></span><br><span class="line"><span class="attr">logout</span> <span class="string">切记,一般服务器只允许少量用户连接, 如果不正常退出会占用用户id</span></span><br></pre></td></tr></table></figure></p>
<ul>
<li>查询当前登录和过去登录的用户信息
last last #命令默认是读取/var/log/wtmp文件数据</li>
</ul>
<p>命令输出 -用户名 登录终端 登录IP 登录时间 退出时间(在线时间)</p>
<h2>echo输出命令</h2>
<p>echo [选项] [输出内容]</p>
<ul>
<li>选项: -e 支持反斜线控制的字符转换</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">控制字符</th>
<th style="text-align:left">作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">\a</td>
<td style="text-align:left">输出警告音</td>
</tr>
<tr>
<td style="text-align:left">\b</td>
<td style="text-align:left">退格键，也就是向左删除键</td>
</tr>
<tr>
<td style="text-align:left">\n</td>
<td style="text-align:left">换行键</td>
</tr>
<tr>
<td style="text-align:left">\r</td>
<td style="text-align:left">回车键</td>
</tr>
<tr>
<td style="text-align:left">\t</td>
<td style="text-align:left">制表键，也就是Tab键</td>
</tr>
<tr>
<td style="text-align:left">\v</td>
<td style="text-align:left">垂直制表键</td>
</tr>
<tr>
<td style="text-align:left">\Onnn</td>
<td style="text-align:left">按照八进制ASCII码表输出字符。其中0表示数字0，nnn是三位八进制数</td>
</tr>
<tr>
<td style="text-align:left">\xhh</td>
<td style="text-align:left">按照16进制ASCII码表输出字符。其中hh是两位16进制数</td>
</tr>
</tbody>
</table>
<h2>脚本执行</h2>
<p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">赋予执行权限,直接运行</span><br><span class="line">chmod <span class="number">755</span> hello.sh</span><br><span class="line">/hello.sh</span><br><span class="line">bash hello.sh</span><br></pre></td></tr></table></figure></p>
<h1>别名</h1>
<ul>
<li>查看与设定别名</li>
</ul>
<ol>
<li>alias #查看系统中所有的命令别名</li>
<li>alias 别名=&quot;原命令&quot; #设定命令别名</li>
</ol>
<h2>别名永久生效与删除别名</h2>
<p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vi <span class="string">/.bashrc</span> <span class="comment">#写入环境变量配置文件</span></span><br><span class="line"><span class="keyword">unalias</span> 别名 <span class="comment">#删除别名</span></span><br></pre></td></tr></table></figure></p>
<h2>shell常用快捷键</h2>
<table>
<thead>
<tr>
<th style="text-align:center">ctrl+c</th>
<th style="text-align:center">强制终止当前命令</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">ctrl+l</td>
<td style="text-align:center">清屏</td>
</tr>
<tr>
<td style="text-align:center">crtl+a</td>
<td style="text-align:center">光标移动到命令行首</td>
</tr>
<tr>
<td style="text-align:center">ctrl+e</td>
<td style="text-align:center">光标移动到命令行尾</td>
</tr>
<tr>
<td style="text-align:center">ctrl+u</td>
<td style="text-align:center">从光标所在位置删除到行首</td>
</tr>
<tr>
<td style="text-align:center">ctrl+z</td>
<td style="text-align:center">把命令放入后台</td>
</tr>
<tr>
<td style="text-align:center">ctrl+r</td>
<td style="text-align:center">在历史命令中搜</td>
</tr>
</tbody>
</table>
<h2>历史命令</h2>
<p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">history [选项] [历史命令保存文件]</span><br><span class="line"><span class="section">选项:</span></span><br><span class="line"><span class="section">-c:清空历史命令</span></span><br><span class="line"><span class="section">w:把缓存中的历史命令写入历史命令保存文件~/.bash.history</span></span><br></pre></td></tr></table></figure></p>
<h1>输出重定向</h1>
<table>
<thead>
<tr>
<th style="text-align:left">类型</th>
<th style="text-align:left">符号</th>
<th style="text-align:left">作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">标准输出重定向</td>
<td style="text-align:left">命令&gt;文件</td>
<td style="text-align:left">以覆盖的方式,把命令的正确输出 输出到指定的文件或设备当中</td>
</tr>
<tr>
<td style="text-align:left">空</td>
<td style="text-align:left">命令&gt;&gt;文件</td>
<td style="text-align:left">以追加的方式,把命令的正确输出! 输出到指定的文件或设备当中</td>
</tr>
<tr>
<td style="text-align:left">准错误输出重定向</td>
<td style="text-align:left">错误命令2&gt;&gt;文件</td>
<td style="text-align:left">以覆盖的方式,把命令的错误输出 输出到指定的文件或设备当中。</td>
</tr>
</tbody>
</table>
<h1>多命令顺序执行</h1>
<table>
<thead>
<tr>
<th style="text-align:left">多命令执行符</th>
<th style="text-align:left">格式</th>
<th style="text-align:left">作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">:</td>
<td style="text-align:left">命令1:命令2</td>
<td style="text-align:left">多个命顺序执行,命令之间没有逻辑关系</td>
</tr>
<tr>
<td style="text-align:left">&amp;&amp;</td>
<td style="text-align:left">命令1&amp;&amp;命令2</td>
<td style="text-align:left">逻辑与当命令1正确执行,则命令2才会执行,1不正确，2不执行</td>
</tr>
<tr>
<td style="text-align:left">丨丨</td>
<td style="text-align:left">命令1丨丨命令2</td>
<td style="text-align:left">逻辑或，命令1不正确，2才执行，命令1正确，2不会执行</td>
</tr>
</tbody>
</table>
<h1>通配符</h1>
<table>
<thead>
<tr>
<th style="text-align:left">通配符</th>
<th style="text-align:left">作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">?</td>
<td style="text-align:left">匹配一个任意字符</td>
</tr>
<tr>
<td style="text-align:left">*</td>
<td style="text-align:left">匹配0或任意多个任意符，也可以是匹配任何内容</td>
</tr>
<tr>
<td style="text-align:left">[]</td>
<td style="text-align:left">匹配括号中的任意一个字符</td>
</tr>
<tr>
<td style="text-align:left">[-]</td>
<td style="text-align:left">匹配括号中任意一个字符，-代表一个范围。［a-z］小写字母表</td>
</tr>
<tr>
<td style="text-align:left">[^]</td>
<td style="text-align:left">逻辑非，表示匹配不是括号中的一个字符.［^0-9］不是数字的字符</td>
</tr>
</tbody>
</table>
<h1>Bash中其他特殊符号</h1>
<table>
<thead>
<tr>
<th style="text-align:left">符号</th>
<th style="text-align:left">作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">''</td>
<td style="text-align:left">单引号。在单引号中所有的特俗符合，如“$”和“`”（反引号）都没特俗意义</td>
</tr>
<tr>
<td style="text-align:left">&quot;&quot;</td>
<td style="text-align:left">双引号,在双引号中特殊符号都没有特殊含义,但是“S&quot; 、“.”和“&quot;是例外. 拥有“调用变量的值”、“引用命令”和“转义符”的特殊含义</td>
</tr>
<tr>
<td style="text-align:left">``</td>
<td style="text-align:left">反引号。反引号括起来的都是系统命令，在bash中会先执行和$()作用一样。不过推荐使用$(), 因为反引号非常容易看错</td>
</tr>
<tr>
<td style="text-align:left">$()</td>
<td style="text-align:left">和反引号作用一样，用来引用系统命令</td>
</tr>
<tr>
<td style="text-align:left">#</td>
<td style="text-align:left">shell中#开头的行代表注释</td>
</tr>
<tr>
<td style="text-align:left">$</td>
<td style="text-align:left">用于调用变量的值，如要调用变量name的值时，需要用$name的方式得到变量的值</td>
</tr>
<tr>
<td style="text-align:left"><code>\</code></td>
<td style="text-align:left">转义符，跟在\后面的特俗符号失去特俗含义，变为普通字符，。如$将输出$符号，而不是变量引用</td>
</tr>
</tbody>
</table>
<h1>磁盘管理</h1>
<h2>df [参数] 查看磁盘分区使用状况</h2>
<p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="deletion">-l仅显示本地磁盘(默认)</span></span><br><span class="line"><span class="deletion">-a显示所有文件系统的磁盘使用情况,包含比如/proc/</span></span><br><span class="line"><span class="deletion">-h以1024进制计算最合适的单位显示磁盘容量</span></span><br><span class="line"><span class="deletion">-H以1000进制计算最合适的单位显示磁盘容量</span></span><br><span class="line"><span class="deletion">-T显示磁盘分区类型</span></span><br><span class="line"><span class="deletion">-t显示指定类型文件系统的磁盘分区</span></span><br><span class="line"><span class="deletion">-x不显示指定类型文件系统的磁盘分</span></span><br><span class="line"><span class="deletion">- du统计磁盘上的文件大小</span></span><br><span class="line"><span class="deletion">-b以byte为单位统计文件</span></span><br><span class="line"><span class="deletion">-k以KB为单位统计文件</span></span><br><span class="line"><span class="deletion">-m以MB为单位统计文件</span></span><br><span class="line"><span class="deletion">-h按照1024进制以最适合的单位统计文件</span></span><br><span class="line"><span class="deletion">-H按照1000进制以最适合的单位统计文件</span></span><br><span class="line"><span class="deletion">-s指定统计目标</span></span><br></pre></td></tr></table></figure></p>
<h1>权限</h1>
<h2>-rw-r--r--</h2>
<p><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">文件类型(</span><span class="literal">-</span><span class="comment">文件d目录1软链接文件)</span></span><br><span class="line"><span class="comment">rw</span><span class="literal">-</span> <span class="comment">u所有者</span> <span class="comment">r</span><span class="literal">-</span><span class="literal">-</span> <span class="comment">g所属组</span> <span class="comment">r</span><span class="literal">-</span><span class="literal">-</span> <span class="comment">o其他人</span></span><br><span class="line"><span class="comment">r</span> <span class="comment">读</span>  <span class="comment">w</span> <span class="comment">写</span> <span class="comment">x</span> <span class="comment">执行</span></span><br></pre></td></tr></table></figure></p>
<h2>chmod 命令</h2>
<p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">chmod [选项] 模式 文件名</span><br><span class="line">选项 -R递归 模式 [<span class="string">ugoa</span>][<span class="symbol">+-=</span>][<span class="string">rwx</span>]</span><br><span class="line">[mode=421]</span><br></pre></td></tr></table></figure></p>
<h2>修改权限</h2>
<p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">chmod u+x cangls.av</span><br><span class="line">chmod g+w,o+w furong.av</span><br><span class="line">chmod a=rwx fengjie.av</span><br></pre></td></tr></table></figure></p>
<h2>权限的数字表示</h2>
<p>r---4 w---2 x---1 rwxr-xr-x --- 755</p>
<h2>权限对文件的作用</h2>
<ol>
<li>r:读取文件内容(cat more head tail)</li>
<li>w:编辑、新增、修改文件内容( vi echo ) 但是不包含删除文件</li>
<li>x:可执行</li>
</ol>
<h2>权限对目录的作用</h2>
<ol>
<li>r:可以查询目录下文件名 (ls)</li>
<li>w:具有修改目录结构的权限。如新建文件和目录,删除此目录下文件和目录,重命名此目录下文件和目录,剪切(touch rm mv cp)</li>
<li>x:可以进入目录 (cd)</li>
<li>对文件来讲: 最高权限是 x</li>
<li>对目录来讲:最高权限是 w</li>
</ol>
<h2>修改文件的所有者</h2>
<p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">chown</span> 用户名 文件名</span><br><span class="line">例如: <span class="keyword">chown</span> ds h.c</span><br></pre></td></tr></table></figure></p>
<h2>修改文件的所属组</h2>
<p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">chgrp</span> 组名 文件名</span><br><span class="line">例如: <span class="selector-tag">chgrp</span> <span class="selector-tag">group1</span> <span class="selector-tag">h</span><span class="selector-class">.c</span></span><br></pre></td></tr></table></figure></p>
<h2>查看默认权限的命令</h2>
<p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">umask查看默认权限</span><br><span class="line"><span class="number">0022</span>  第一位<span class="number">0</span> :文件特殊权限 <span class="number">022</span> :文件默认权限</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>文件的默认权限 文件默认不能建立为执行文件,必须手工赋予执行权限 所以文件默认权限最大为666 默认权限需要换算成字母再相减 建立文件之后的默认权限,为666减去umask</p>
</blockquote>
<p>例如:</p>
<p>文件默认最大权限666 umask值022</p>
<p>-rw-rw-rw- 减去 ---- w--w-等于 -rw-r-r-</p>
<p>例如: 文件默认最大权限666 umask值033</p>
<p>-rw-rw-rw- 减去 ---- wx-wx 等于 -rw-r-r</p>
<blockquote>
<p>目录的默认权限 目录默认权限最大为777 默认权限需要换算成字母再相减 建立文件之后的默认权限,为777减去umask值</p>
</blockquote>
<p>例如:</p>
<p>目录默认最大权限为777 umask值022</p>
<p>-rwxrwxrwx 减去 ----w--w- 等于 -rwxr-xr-x</p>
<h2>修改umask</h2>
<p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">临时修改 umask <span class="number">0002</span></span><br><span class="line">永久修改  <span class="keyword">vi</span>/etc/<span class="keyword">profile</span></span><br></pre></td></tr></table></figure></p>
<h1>进程</h1>
<ul>
<li>查看所有进程
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">ps aux <span class="comment">#查看系统中所有进程,使用BSD操作系统格式</span></span><br><span class="line">ps -le <span class="comment">#查看系统中所有进程,使用Linux标准命令格式</span></span><br><span class="line">选项</span><br><span class="line"><span class="section">a:显示一个终端的所有进程,除了会话引线</span></span><br><span class="line"><span class="section">-u:显示进程的归属用户及内存的使用情况</span></span><br><span class="line"><span class="section">-x:显示没有控制终端的进程</span></span><br><span class="line"><span class="section">-l:长格式显示,显示更加详细的信息</span></span><br><span class="line"><span class="section">-e:显示所有进程,和-A作用一致</span></span><br><span class="line">- ps命令的输出</span><br><span class="line"><span class="section">USER:该进程是由哪个用户产生的</span></span><br><span class="line"><span class="section">PID:进程的ID号;</span></span><br><span class="line"><span class="section">%CPU:该进程占用CPU资源的百分比,占用越高,进程越耗费资源;</span></span><br><span class="line"><span class="section">%MEM:该进程占用物理内存的百分比,占用越高,进程越耗费资源</span></span><br><span class="line"><span class="section">VSZZ:该进程占用虚拟内存的大小,单位KB:</span></span><br><span class="line"><span class="section">Rss:该进程占用实际物理内存的大小,单位KB:</span></span><br><span class="line"><span class="section">TTY:该进程是在哪个终端中运行的,其中tty1-tty7代表本地控制台 终端, tty1-tty6是本地的字符界面终端, 255代表虚拟终端。 tty7是图形终端. pts/0</span></span><br></pre></td></tr></table></figure></li>
</ul>
<p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">STAT :进程状态,常见的状态有</span><br><span class="line">R:运行 S:睡眠 T:停止状态 -s:包含子进程 +:位于后台</span><br><span class="line">START:该进程的启动时间</span><br><span class="line"><span class="keyword">TIME:</span>该进程占用CPU的运算时间, 不是系统时间</span><br><span class="line">COMMAND:产生此进程的命令名</span><br></pre></td></tr></table></figure></p>

    

        <a href="/posts/Linux-Commands.html" class="post-more waves-effect waves-button">
            阅读全文…
        </a>
    </div>
    
    <div class="post-footer">
        
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Termux/">Termux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Ubuntu/">Ubuntu</a></li></ul>

    </div>
    
</article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-Termux-R"
  class="article-card article-type-post" itemprop="blogPost">

    <div class="post-meta">
        <time class="post-time" title="2018-04-24 17:10:03" datetime="2018-04-24T09:10:03.000Z"  itemprop="datePublished"><i class="icon icon-calendar"></i> 2018-04-24</time>
        
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Diary/">Diary</a></li></ul>



           
    </div>

    


  
    <h3 class="post-title" itemprop="name">
      <a class="post-title-link" href="/posts/Termux-R.html">Termux 安装 R</a>
    </h3>
  




    <div class="post-content" id="post-content" itemprop="postContent">

    
        <p>Termux 安装 R
&lt;!--more--&gt;</p>
<h1>步骤</h1>
<p>建立 storage
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">termux-setup-storage</span><br></pre></td></tr></table></figure></p>
<p>添加镜像
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> EDITOR=vi</span><br><span class="line">apt edit-sources</span><br></pre></td></tr></table></figure></p>
<p>进入之后输入 i 进入编辑模式。</p>
<ul>
<li>添加如下源</li>
</ul>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">deb [trusted=yes] https://its-pointless.github.io/files/ termux extras</span><br></pre></td></tr></table></figure></p>
<p>环境更新
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt-get update</span><br><span class="line">apt-get upgrade</span><br></pre></td></tr></table></figure></p>
<p>安装 R
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pkg <span class="keyword">install</span> r-cran</span><br></pre></td></tr></table></figure></p>

    

        <a href="/posts/Termux-R.html" class="post-more waves-effect waves-button">
            阅读全文…
        </a>
    </div>
    
    <div class="post-footer">
        
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/R/">R</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Termux/">Termux</a></li></ul>

    </div>
    
</article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-Adb"
  class="article-card article-type-post" itemprop="blogPost">

    <div class="post-meta">
        <time class="post-time" title="2018-04-19 15:41:31" datetime="2018-04-19T07:41:31.000Z"  itemprop="datePublished"><i class="icon icon-calendar"></i> 2018-04-19</time>
        
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Diary/">Diary</a></li></ul>



           
    </div>

    


  
    <h3 class="post-title" itemprop="name">
      <a class="post-title-link" href="/posts/Adb.html">ADB 与 Fastboot 常用命令</a>
    </h3>
  




    <div class="post-content" id="post-content" itemprop="postContent">

    
        <p>Adb 与 Fastboot 常用命令
&lt;!--more--&gt;</p>
<h1>ADB</h1>
<h2>刷机命令</h2>
<table>
<thead>
<tr>
<th style="text-align:left">解释</th>
<th style="text-align:left">命令</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">启动</td>
<td style="text-align:left">adb server,adb start-server</td>
</tr>
<tr>
<td style="text-align:left">停止</td>
<td style="text-align:left">adb server,adb kill-server</td>
</tr>
<tr>
<td style="text-align:left">查看连接状态</td>
<td style="text-align:left">adb devices</td>
</tr>
<tr>
<td style="text-align:left">重启命令</td>
<td style="text-align:left">adb reboot</td>
</tr>
<tr>
<td style="text-align:left">重启到Rec</td>
<td style="text-align:left">adb reboot recovery</td>
</tr>
<tr>
<td style="text-align:left">重启到Fastboot</td>
<td style="text-align:left">adb reboot bootloader</td>
</tr>
<tr>
<td style="text-align:left">推送ROM包</td>
<td style="text-align:left">adb sideload &lt;Rom包&gt;</td>
</tr>
</tbody>
</table>
<h2>错误提示</h2>
<ol>
<li><code>offline</code> 设备未连接成功或无响应；</li>
<li><code>device</code> 设备已连接；</li>
<li><code>no device</code> 没有设备/模拟器连接；</li>
<li><code>List of devices attached</code> 设备/模拟器未连接到 adb 或无响应</li>
</ol>
<h2>安装卸载</h2>
<table>
<thead>
<tr>
<th style="text-align:left">解释</th>
<th style="text-align:left">命令</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">安装</td>
<td style="text-align:left">adb install &lt;package&gt;</td>
</tr>
<tr>
<td style="text-align:left">卸载</td>
<td style="text-align:left">adb uninstall &lt;package&gt;</td>
</tr>
<tr>
<td style="text-align:left">保留数据卸载</td>
<td style="text-align:left">adb uninstall -k &lt;package&gt;</td>
</tr>
</tbody>
</table>
<h2>复制文件</h2>
<table>
<thead>
<tr>
<th style="text-align:left">解释</th>
<th style="text-align:left">命令</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">复制设备到电脑</td>
<td style="text-align:left">adb pull &lt;设备文件路径&gt; &lt;电脑目录&gt; 例如：adb pull /sdcard/1.txt E:\</td>
</tr>
<tr>
<td style="text-align:left">复制电脑到设备</td>
<td style="text-align:left">abd pull &lt;电脑文件路径&gt; &lt;设备目录&gt; 例如：adb pull E:\1.txt /sdcard/</td>
</tr>
</tbody>
</table>
<h2>查看手机信息</h2>
<table>
<thead>
<tr>
<th style="text-align:left">解释</th>
<th style="text-align:left">命令</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">查看设备型号</td>
<td style="text-align:left">adb shell getprop ro.product.model</td>
</tr>
<tr>
<td style="text-align:left">获取IMEI</td>
<td style="text-align:left">adb shell [回车] su [回车] service call iphonesubinfo 1</td>
</tr>
<tr>
<td style="text-align:left">获取手机程序包名</td>
<td style="text-align:left">adb shell pm list packages</td>
</tr>
<tr>
<td style="text-align:left">获取序列号</td>
<td style="text-align:left">adb get-serialno</td>
</tr>
<tr>
<td style="text-align:left">查看所有应用列表</td>
<td style="text-align:left">adb shell pm list packages</td>
</tr>
<tr>
<td style="text-align:left">查看系统应用列表</td>
<td style="text-align:left">db shell pm list packages -s</td>
</tr>
<tr>
<td style="text-align:left">查看第三方应用列表</td>
<td style="text-align:left">adb shell pm list packages -3</td>
</tr>
</tbody>
</table>
<h2>其他</h2>
<table>
<thead>
<tr>
<th style="text-align:left">解释</th>
<th style="text-align:left">命令</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">查看log</td>
<td style="text-align:left">adb logcat</td>
</tr>
<tr>
<td style="text-align:left">终止adb服务进程</td>
<td style="text-align:left">adb kill-server</td>
</tr>
<tr>
<td style="text-align:left">重启adb服务进程</td>
<td style="text-align:left">adb start-server</td>
</tr>
<tr>
<td style="text-align:left">获取机器MAC地址</td>
<td style="text-align:left">adb shell  cat /sys/class/net/wlan0/address</td>
</tr>
<tr>
<td style="text-align:left">获取CPU序列号</td>
<td style="text-align:left">adb shell cat /proc/cpuinfo</td>
</tr>
<tr>
<td style="text-align:left">安装APK</td>
<td style="text-align:left">adb install &lt;apkfile&gt;</td>
</tr>
<tr>
<td style="text-align:left">卸载APK</td>
<td style="text-align:left">adb uninstall &lt;package&gt;</td>
</tr>
<tr>
<td style="text-align:left">查看设备cpu和内存占用情况</td>
<td style="text-align:left">adb shell top</td>
</tr>
<tr>
<td style="text-align:left">查询各进程内存使用情况</td>
<td style="text-align:left">adb shell procrank</td>
</tr>
<tr>
<td style="text-align:left">查看wifi密码</td>
<td style="text-align:left">adb shell cat /data/misc/wifi/*.conf</td>
</tr>
</tbody>
</table>
<p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb install &lt;参数&gt; &lt;apk_path&gt;</span><br></pre></td></tr></table></figure></p>
<ul>
<li><code>-l</code> 将应用安装到保护目录 /mnt/asec</li>
<li><code>-r</code> 允许覆盖安装；</li>
<li><code>-t</code> 允许安装 AndroidManifest.xml 里 application 指定 android:testOnly=&quot;true&quot; 的应用</li>
<li><code>-s</code> 将应用安装到 sdcard</li>
<li><code>-d</code> 允许降级覆盖安装</li>
<li><code>-g</code> 授予所有运行时权限</li>
</ul>
<p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb uninstall -k &lt;PackageName&gt;</span><br></pre></td></tr></table></figure></p>
<ul>
<li><code>-k</code> 卸载应用但保留数据和缓存目录,可选，</li>
</ul>
<h1>Fastboot</h1>
<table>
<thead>
<tr>
<th style="text-align:left">解释</th>
<th style="text-align:left">命令</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">查看连接状态</td>
<td style="text-align:left">fastboot devices</td>
</tr>
<tr>
<td style="text-align:left">解锁</td>
<td style="text-align:left">fastboot flashing unlock OR fastboot oem unlock</td>
</tr>
<tr>
<td style="text-align:left">上锁</td>
<td style="text-align:left">fastboot flashing lock OR fastboot oem lock</td>
</tr>
<tr>
<td style="text-align:left">重启</td>
<td style="text-align:left">fastboot reboot</td>
</tr>
<tr>
<td style="text-align:left">重启到Fastboot</td>
<td style="text-align:left">fastboot reboot-bootloader</td>
</tr>
<tr>
<td style="text-align:left">清除分区数据</td>
<td style="text-align:left">fastboot erase &lt;boot/system/data/cache/userdata/recovery&gt;</td>
</tr>
<tr>
<td style="text-align:left">清除分区(四清)</td>
<td style="text-align:left">fastboot erase system -w</td>
</tr>
<tr>
<td style="text-align:left">格式化分区数据</td>
<td style="text-align:left">fastboot format &lt;boot/system/data/cache/userdata/recovery&gt;</td>
</tr>
<tr>
<td style="text-align:left">烧写分区</td>
<td style="text-align:left">fastboot flash &lt; boot/system /recovery/radio/bootloader/ splash1/&gt; &lt;*.img&gt;</td>
</tr>
</tbody>
</table>
<h2>系统分区</h2>
<p>Via: <a href="https://segmentfault.com/a/1190000021601415" target="_blank" rel="noopener">Android 分区</a></p>
<table>
<thead>
<tr>
<th style="text-align:left">分区</th>
<th style="text-align:left">介绍</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">boot</td>
<td style="text-align:left">包含通过 mkbootimg 组合在一起的kernel镜像和 ramdisk。使能system-as-root后，该分区仅存放kernel镜像</td>
</tr>
<tr>
<td style="text-align:left">system</td>
<td style="text-align:left">主要包含 Android 框架。使能system-as-root后，该分区会包含原始 system.img 和 ramdisk.img 的合并内容</td>
</tr>
<tr>
<td style="text-align:left">recovery</td>
<td style="text-align:left">用于存储在 OTA 升级时使用的recovery系统。如果设备支持A/B更新，OTA升级可以通过ramdisk执行，该分区可以不需要</td>
</tr>
<tr>
<td style="text-align:left">cache</td>
<td style="text-align:left">用于存储临时数据，OTA升级包也会下载到这个分区。如果设备使用 A/B 更新，则可以不要此分区</td>
</tr>
<tr>
<td style="text-align:left">misc</td>
<td style="text-align:left">分区供recovery使用，存储空间不能小于 4KB</td>
</tr>
<tr>
<td style="text-align:left">userdata</td>
<td style="text-align:left">存储用户安装的应用和数据</td>
</tr>
<tr>
<td style="text-align:left">metadata</td>
<td style="text-align:left">如果设备被加密，则需要使用该分区，分区的存储空间不能小于 16MB</td>
</tr>
<tr>
<td style="text-align:left">vendor</td>
<td style="text-align:left">包含所有不可分发给 Android 开源项目 (AOSP) 的二进制文件。如果没有专有信息，可以不要该分区</td>
</tr>
<tr>
<td style="text-align:left">radio</td>
<td style="text-align:left">包含无线装置映像。只有包含无线装置的设备才需要此分区</td>
</tr>
<tr>
<td style="text-align:left">tos</td>
<td style="text-align:left">用于存储 Trusty 操作系统的二进制映像文件，仅在设备包含 Trusty 时使用</td>
</tr>
<tr>
<td style="text-align:left">product</td>
<td style="text-align:left">用于存放产品专用的配置和应用，以便OEM定制自己的系统。Android 9 及更高版本支持该分区。product分区是对system分区的扩展，必须同时升级这两个分区</td>
</tr>
<tr>
<td style="text-align:left">odm</td>
<td style="text-align:left">用于ODM自定义自己的板级支持包。Android 10 开始支持该分区。odm分区是对vendor分区的扩展，必须同时升级这两个分区</td>
</tr>
</tbody>
</table>
<h2>常用 Fastboot 命令</h2>
<ul>
<li>刷入临时 TWRP</li>
</ul>
<p><figure class="highlight shell"><figcaption><span>bootloader 下</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fastboot boot twrp.img</span><br></pre></td></tr></table></figure></p>
<ul>
<li>输入镜像</li>
</ul>
<p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">fastboot flash system system.img</span><br><span class="line">fastboot flash boot boot.img</span><br><span class="line">fastboot flash recovery recovery.img</span><br><span class="line">fastboot reboot</span><br></pre></td></tr></table></figure></p>

    

        <a href="/posts/Adb.html" class="post-more waves-effect waves-button">
            阅读全文…
        </a>
    </div>
    
    <div class="post-footer">
        
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ADB/">ADB</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Win/">Win</a></li></ul>

    </div>
    
</article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-SQL-Exists"
  class="article-card article-type-post" itemprop="blogPost">

    <div class="post-meta">
        <time class="post-time" title="2018-04-15 18:12:22" datetime="2018-04-15T10:12:22.000Z"  itemprop="datePublished"><i class="icon icon-calendar"></i> 2018-04-15</time>
        
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Database/">Database</a></li></ul>



           
    </div>

    


  
    <h3 class="post-title" itemprop="name">
      <a class="post-title-link" href="/posts/SQL-Exists.html">SQL EXISTS</a>
    </h3>
  




    <div class="post-content" id="post-content" itemprop="postContent">

    
        <p>SQL 中 EXISTS
&lt;!--more--&gt;</p>
<h1>三点概念</h1>
<p>概念</p>
<ul>
<li><code>EXISTS</code> 子查询找到的提交</li>
<li><code>NOT EXISTS</code>子查询中 找不到的提交</li>
</ul>
<p>说明</p>
<ul>
<li>不要去翻译为存在和不存在，把脑袋搞晕。</li>
<li><code>exists</code>代表存在量词<code>ョ</code>，该查询结果没有值，只有逻辑值真true和逻辑假false两个值。
<ul>
<li>建立程序循环的概念，这是一个动态的查询过程。如 FOR循环.</li>
<li><code>Exists</code>执行的流程<code>Exists</code>首先执行外层查询，再执行内存查询,与<code>IN</code>相反。 流程为首先取出外层中的第一元组，再执行内层查询，将外层表的第一元组代入,若内层查询为真，即有结果时。返回外层表中的第一元 组，接着取出第二元组，执行相同的算法。一直到扫描完外层整表。
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">for(int i =0;  i&lt;&gt;EOFout;i++)</span><br><span class="line">  &#123;</span><br><span class="line">  for (int j = 0 ; j&lt;EOFint,j++)</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h1>例子</h1>
<p>表
学生表student (Sno,Sname)</p>
<p>课程表course (Cno,Cname)</p>
<p>选课表SC(Sno,Cno)</p>
<p>要求查询出 ：选修了全部课程的学生姓名</p>
<h2>思路</h2>
<p>思路一
首先学生的选课信息存在于SC表中， 要想知道某个学生是否选修了全部课程，至少我们需要知道一共有几门课程，这是首要的条件。其次，学生选修了与否，我们又要扫描SC全表，统计出选修了所有课程的学生号，最后在STUDENT表中根据学生号打出姓名 。</p>
<ul>
<li>语句如下：
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> Sname <span class="keyword">from</span> student</span><br><span class="line"><span class="keyword">where</span> Sno <span class="keyword">IN</span></span><br><span class="line">(<span class="keyword">select</span> Sno <span class="keyword">from</span> SC</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> Sno</span><br><span class="line"> //根据Sno分组，统计每个学生选修了几门课程。如果等于course的总数，就是我们要找的Sno</span><br><span class="line"><span class="keyword">having</span> <span class="keyword">count</span>(*) = (<span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">from</span> course ))</span><br><span class="line">//统计course中共有几门课程</span><br></pre></td></tr></table></figure></li>
</ul>
<p>另一种思路：</p>
<ul>
<li>
<p>引入：将题目换为 查找学号为 00003 没有选修的科目</p>
<ul>
<li>思路：我们可以将已知学号代入，把每一个科目代入（循环），这将形成<code>1*count(*)</code>种组合。将这组成作为条件，一一与SC表种进行比对，找不到匹配的我们提交.
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> Cname <span class="keyword">from</span> course  <span class="keyword">where</span></span><br><span class="line"><span class="keyword">not</span> <span class="keyword">exists</span>  //找不到的组合，提交course</span><br><span class="line">(<span class="keyword">select</span> * <span class="keyword">from</span> SC <span class="keyword">where</span> course.cno = cno <span class="keyword">and</span> sno = <span class="string">''</span><span class="number">00002</span><span class="string">''</span>)</span><br><span class="line">//在SC中匹配</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>
<p>查找没有 没有选修科目的学生姓名</p>
<ul>
<li>
<p>思路：</p>
<ul>
<li>学号未知,科目未知，说明有两个未知变量。应该有两个EXISTS。我们可以扫描student 和 course共有 s * c 中组合，将这些组合与SC的每一项进行匹配，注意s*c组合已经包含所有可能。如果全部找到 ，就说明已经选修了全部课程。找不到就说明有课程没选修 。再将没选修的的提交给上一exists 循环 。若上一exists 不存在的再提交给外循环。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> Sname <span class="keyword">from</span> student</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">NOT</span> <span class="keyword">exists</span>        //</span><br><span class="line">(<span class="keyword">select</span>  * <span class="keyword">from</span> course</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">NOT</span> <span class="keyword">exists</span>      //不存在的提交给course</span><br><span class="line">(<span class="keyword">select</span> * <span class="keyword">from</span> SC <span class="keyword">where</span></span><br><span class="line">Sno = student.sno  <span class="keyword">and</span> cno = Course.Cno))   // 代入两个未知变量</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>
<p>选修了全部课程的学生姓名.
将这组成作为条件，一一与SC表种进行比对，找不到匹配的我们提交 。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> Cname <span class="keyword">from</span> course <span class="keyword">where</span></span><br><span class="line"><span class="keyword">not</span> <span class="keyword">exists</span>  //找不到的组合，提交course</span><br><span class="line">(<span class="keyword">select</span> * <span class="keyword">from</span> SC <span class="keyword">where</span> course.cno = cno <span class="keyword">and</span> sno = <span class="string">''</span><span class="number">00003</span><span class="string">''</span>)</span><br><span class="line">//在SC中匹配</span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>查找没有选修科目的学生姓名</p>
<ul>
<li>思路：1. 学号未知 科目未知 说明有两个未知变量。2. 应该有两个<code>EXISTS</code>。我们可以扫描<code>student</code>和<code>course</code>共有<code>s*c</code>中组合，将这些组合与SC的每一项进行匹配，注意s*c组合已经包含所有可能。如果全部找到 ，就说明已经选修了全部课程。找不到就说明有课程没选修 。再将没选修的的提交给上一exists 循环 。若上一exists 不存在的再提交给外循环。</li>
</ul>
</li>
<li>
<p>查询选修了全部课程的学生姓名。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Sname</span><br><span class="line"><span class="keyword">FROM</span> Student</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span></span><br><span class="line">（<span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> Course</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span></span><br><span class="line">(<span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> SC</span><br><span class="line"><span class="keyword">WHERE</span> Sno= Student.Sno</span><br><span class="line"><span class="keyword">AND</span> Cno= Course.Cno）</span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>查询所有选修了001课程的学生名单
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> sname</span><br><span class="line"><span class="keyword">from</span> student a</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">exists</span> (</span><br><span class="line"><span class="keyword">select</span> *</span><br><span class="line"><span class="keyword">from</span> sc b</span><br><span class="line"><span class="keyword">where</span> a.sno=b.sno <span class="keyword">and</span> cno=<span class="string">'001'</span>)</span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>查询没有选修了001课程的学生名单
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> sname</span><br><span class="line"><span class="keyword">from</span> student a</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">not</span> <span class="keyword">exists</span> (</span><br><span class="line"><span class="keyword">select</span> *</span><br><span class="line"><span class="keyword">from</span> sc b</span><br><span class="line"><span class="keyword">where</span> a.sno=b.sno <span class="keyword">and</span> cno=<span class="string">'001'</span>)</span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>查询选修了所有课程的学生名单。</p>
</li>
</ul>
<p>由于SQL中没有全称量词，可以这样理解：查询这样的学生，没有一门课程他没有选
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> sname</span><br><span class="line"><span class="keyword">from</span> student a</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">not</span> <span class="keyword">exists</span> (</span><br><span class="line"><span class="keyword">select</span> *</span><br><span class="line"><span class="keyword">from</span> course b</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">not</span> <span class="keyword">exists</span> (</span><br><span class="line"><span class="keyword">select</span> *</span><br><span class="line"><span class="keyword">from</span> sc c</span><br><span class="line"><span class="keyword">where</span> a.sno=c.sno <span class="keyword">and</span> c.cno=b.cno))</span><br></pre></td></tr></table></figure></p>
<p>注意：SQL没有蕴涵谓词，可以使用等价变换进行转换<code>p→q ≡ ┑p∨q</code></p>
<ul>
<li>查询至少选修了学生95002选修的全部课程的学生名单。</li>
</ul>
<p>将查询进行变换： p表示的谓词：95002选修了课程y</p>
<p>q表示的谓词：学生x选修了课程y</p>
<p>该查询转换为：( y)p→q</p>
<p>进一步转换：( y)p→q ≡</p>
<p>┑(ョy( ┑(p→q))) ≡ ┑(ョy( ┑(┑p∨q)))</p>
<p>≡ ┑ョy(p∧q) 德模根定律</p>
<p>它所表达的含义为：不存在这样的课程y，95002选修了y而x没有选，SQL语句如下：
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> sname,sno</span><br><span class="line"><span class="keyword">from</span> student a</span><br><span class="line"><span class="keyword">where</span> sno &lt;&gt; <span class="string">'95002'</span> <span class="keyword">and</span> <span class="keyword">not</span> <span class="keyword">exists</span> (</span><br><span class="line"><span class="keyword">select</span> *</span><br><span class="line"><span class="keyword">from</span> sc b</span><br><span class="line"><span class="keyword">where</span> sno=<span class="string">'95002'</span> <span class="keyword">and</span> <span class="keyword">not</span> <span class="keyword">exists</span> (</span><br><span class="line"><span class="keyword">select</span> *</span><br><span class="line"><span class="keyword">from</span> sc c</span><br><span class="line"><span class="keyword">where</span> a.sno=c.sno <span class="keyword">and</span> c.cno=b.cno))</span><br></pre></td></tr></table></figure></p>
</li>
</ul>
<p><a href="http://www.cnblogs.com/losesea/archive/2012/06/14/2549023.html" target="_blank" rel="noopener">参考：</a></p>

    

        <a href="/posts/SQL-Exists.html" class="post-more waves-effect waves-button">
            阅读全文…
        </a>
    </div>
    
    <div class="post-footer">
        
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SQL/">SQL</a></li></ul>

    </div>
    
</article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-Git-error"
  class="article-card article-type-post" itemprop="blogPost">

    <div class="post-meta">
        <time class="post-time" title="2018-04-13 16:49:24" datetime="2018-04-13T08:49:24.000Z"  itemprop="datePublished"><i class="icon icon-calendar"></i> 2018-04-13</time>
        
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Diary/">Diary</a></li></ul>



           
    </div>

    


  
    <h3 class="post-title" itemprop="name">
      <a class="post-title-link" href="/posts/Git-error.html">Git Push 错误解决方法</a>
    </h3>
  




    <div class="post-content" id="post-content" itemprop="postContent">

    
        <p>git push用法和常见问题分析
&lt;!--more--&gt;</p>
<h1>Git push</h1>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git push origin test:master</span><br><span class="line">// 提交本地test分支作为远程的master分支</span><br><span class="line">git push origin test:test</span><br><span class="line">// 提交本地test分支作为远程的test分支</span><br></pre></td></tr></table></figure></p>
<p>如果想删除远程的分支呢？类似于上面，如果:左边的分支为空，那么将删除:右边的远程的分支。</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git push origin :test</span><br><span class="line">// 刚提交到远程的test将被删除，但是本地还会保存的，不用担心</span><br></pre></td></tr></table></figure></p>
<p>举个例子:
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">git push origin  :origin/Android_HK_K501_77-W916</span><br><span class="line">//由于:前面为空所以本来在服务器上面存在的分支origin/Android_HK_K501_77-W916和Android_HK_K501_77-W916</span><br><span class="line">现在就只有一个了,因为分支origin/Android_HK_K501_77-W916被删除了,但是本地的还在</span><br><span class="line"> git push ssh://git@dev.lemote.com/rt4ls.git master</span><br><span class="line"> // 把本地仓库提交到远程仓库的master分支中</span><br><span class="line">git remote add origin ssh://git@dev.lemote.com/rt4ls.git</span><br><span class="line">git push origin master</span><br></pre></td></tr></table></figure></p>
<p>这两个操作是等价的，第二个操作的第一行的意思是添加一个标记，让origin指向ssh://git@dev.lemote.com/rt4ls.git，也就是说你操 作origin的时候，实际上就是在操作ssh://git@dev.lemote.com/rt4ls.git。origin在这里完全可以理解为后者 的别名。</p>
<pre><code>注意：需要说明的是，默认情况下这条语句等价于提交本地的master仓库到远程仓库，并作为远程的master分支。
如果想把本地的某个分支test提交到远程仓库，并作为远程仓库的master分支，或者作为另外一个名叫test的分支，那么可以这么做。
</code></pre>
<h1>常见错误:</h1>
<ul>
<li>1.error:failed to push some refs to ...</li>
</ul>
<p>当要push代码到git时，出现提示：
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">error:failed to push some refs to ...</span><br><span class="line">Dealing <span class="keyword">with</span> “non-<span class="keyword">fast</span>-forward” <span class="keyword">errors</span></span><br><span class="line"><span class="keyword">From</span> <span class="built_in">time</span> <span class="keyword">to</span> <span class="built_in">time</span> you may encounter this <span class="keyword">error</span> <span class="keyword">while</span> pushing:</span><br><span class="line">git push origin <span class="keyword">master</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">To</span> ../remote/</span><br><span class="line"></span><br><span class="line"> ! [rejected]        <span class="keyword">master</span> -&gt; <span class="keyword">master</span> (non-<span class="keyword">fast</span> forward)</span><br><span class="line"></span><br><span class="line"><span class="keyword">error</span>: <span class="keyword">failed</span> <span class="keyword">to</span> push <span class="keyword">some</span> refs <span class="keyword">to</span> <span class="string">'../remote/'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">To</span> prevent you <span class="keyword">from</span> losing history, non-<span class="keyword">fast</span>-forward updates were rejected</span><br><span class="line"></span><br><span class="line"><span class="keyword">Merge</span> the remote changes <span class="keyword">before</span> pushing again.  See the <span class="string">'non-fast forward'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">section</span> <span class="keyword">of</span> <span class="string">'git push --help'</span> <span class="keyword">for</span> details.</span><br></pre></td></tr></table></figure></p>
<p>问题（Non-fast-forward）的出现原因在于：git仓库中已经有一部分代码，所以它不允许你直接把你的代码覆盖上去。于是你有2个选择方式：</p>
<p>强推，即利用强覆盖方式用你本地的代码替代git仓库内的内容
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">git</span> <span class="keyword">push </span>-f</span><br></pre></td></tr></table></figure></p>
<ul>
<li>
<ol start="2">
<li>先把git的东西fetch到你本地然后merge后再push
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git fetch</span><br><span class="line">git merge</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ul>
<p>这2句命令等价于<code>git pull</code></p>
<p>可是，这时候又出现了如下的问题：</p>
<p>上面出现的 [branch &quot;master&quot;]是需要明确(.git/config)如下的内容
<figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[branch <span class="string">"master"</span>]</span><br><span class="line"></span><br><span class="line">    <span class="attr">remote</span> = origin</span><br><span class="line"></span><br><span class="line">    <span class="attr">merge</span> = refs/heads/master</span><br></pre></td></tr></table></figure></p>
<p>这等于告诉git2件事:</p>
<ul>
<li>1，当你处于master branch, 默认的remote就是origin。</li>
<li>2，当你在master branch上使用git pull时，没有指定remote和branch，那么git就会采用默认的remote（也就是origin）来merge在master branch上所有的改变</li>
</ul>
<p>如果不想或者不会编辑config文件的话，可以在bash上输入如下命令行：
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git<span class="built_in"> config </span>branch.master.remote origin</span><br><span class="line">git<span class="built_in"> config </span>branch.master.merge refs/heads/master</span><br></pre></td></tr></table></figure></p>
<p>之后再重新git pull下。最后git push你的代码.</p>
<p><strong>参考</strong></p>
<ul>
<li><a href="http://www.cnblogs.com/renkangke/archive/2013/05/31/conquerAndroid.html" target="_blank" rel="noopener">CSDN-Renkangke</a></li>
</ul>

    

        <a href="/posts/Git-error.html" class="post-more waves-effect waves-button">
            阅读全文…
        </a>
    </div>
    
    <div class="post-footer">
        
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Git/">Git</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Termux/">Termux</a></li></ul>

    </div>
    
</article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-SQLexam"
  class="article-card article-type-post" itemprop="blogPost">

    <div class="post-meta">
        <time class="post-time" title="2018-04-13 08:18:38" datetime="2018-04-13T00:18:38.000Z"  itemprop="datePublished"><i class="icon icon-calendar"></i> 2018-04-13</time>
        
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Database/">Database</a></li></ul>



           
    </div>

    


  
    <h3 class="post-title" itemprop="name">
      <a class="post-title-link" href="/posts/SQLexam.html">SQL 上机实验题</a>
    </h3>
  




    <div class="post-content" id="post-content" itemprop="postContent">

    
        <p>SQL 上机习题与练习
&lt;!--more--&gt;</p>
<h1>实验一   SQL SERVER 2008的基本知识与操作</h1>
<p>实验日期：</p>
<h2>实验目标：</h2>
<p>（1）	以SQL Server2008为实验平台掌握SQL Server服务器的注册、启动、暂停、查看与设置服务器的属性等操作；</p>
<p>（2）	了解SQL Server Management Studio的功能</p>
<p>（3）	学习SQL Server2008所提供的系统数据库；</p>
<p>（4）	学习利用SQL Server Management Studio创建数据库。掌握数据库中这主数据文件、辅助数据文件、日志文件三类文件的作用；</p>
<p>（5）	学习利用SQL Server Management Studio数据库中创建表；创建表的字段、字段的数据类型、设置表的主键；</p>
<p>（6）	学习利用SQL Server Management Studio修改数据库中表的数据，删除表的数据、向表中插入数据；</p>
<p>（7）	利用SQL Server Management Studio删除数据库中的表；</p>
<p>（8）	利用SQL Server Management Studio删除数据库、分离数据库、附加数据库库。</p>
<h2>实验内容</h2>
<p>SQL Server 2008将数据保存在数据库中，并为用户提供了访问这些数据的接口。对数据库的基本操作包括创建、查看、修改和删除数据库等。在学习这些操作之前，先来了解一下数据库文件和SQL Server系统数据库。</p>
<h3>1.	数据库文件</h3>
<p>在SQL Server中数据库文件是存储数据的文件，其可以分为三类。</p>
<p>主数据文件：扩展名是.mdf，它包含数据库的启动信息以及数据库数据，每个数据库只能包含一个主数据文件。在SQL Server中数据的存储单位是页。</p>
<p>辅助数据文件：扩展名是.ndf,因为有些数据库可能非常大，用一个主数据文件可能放不下，因此就需要有一个多个辅助数据文件存储这些数据，可以和主数据文件放在相同的位置也可以存放在不同的位置。</p>
<p>日志文件：用来记录页的分配和释放以及对数据库数据的修改操作，扩展名为.ldf,包含用于恢复数据库的日志信息。每个数据库必须至少有一个日志文件，也可以有多个。</p>
<p>创建数据库时，一个数据库至少包含一个主数据文件和一个或多个日志文件，还可能包含一些辅助数据文件。这些文件默认的位置为：\program files\Microsoft SQL Server\MSSQL\Data文件夹。</p>
<h3>2.	SQL Server系统数据库</h3>
<p>在 SQL Server 2008有两类数据库：系统数据库和用户数据库。系统数据库存储有关SQL Server 的系统信息，它们是SQL Server 2008管理数据库的依据。如果系统数据库遭到破坏，那么SQL Server将不能正常启动。在安装了SQL Server 2008的系统共中将创建4个可见系统数据库。</p>
<h4>（1）master数据库</h4>
<p>master数据库是SQL Server中最重要的数据库，它是SQL Server的核心数据库，如果该数据库被损坏，SQL Server将无法正常工作，master数据库中包含所有的登录名或用户ID所属的角色、服务器中的数据库的名称及相关的信息、数据库的位置、SQL Server如何初始化四个方面的重要信息。</p>
<h4>（2）model数据库</h4>
<p>用户创建数据库时是以一套预定义的标准为模型。例如，若希望所有的数据库都有确定的初始大小，或者都有特定的信息集，那么可以吧这些信息放在model数据库中，以model数据库作为其他数据库的模板数据库。如果想要使用所有的数据库都有一个特定的表，可以把该表放在model数据库里。model数据库是tempdb数据库的基础。对model数据库的任何改动都将反映在tempdb数据库中，所以，在决定对model数据库有所改变时，必须预先考虑好。</p>
<h4>（3）msdb数据库</h4>
<p>msdb数据库给SQL Server代理提供必要的信息来运行作业，其供SQL Server 2008代理程序调度警报作业以及记录操作时使用。</p>
<h4>（4）tempdb数据库</h4>
<p>tempdb数据库用作系统的临时存储空间，其主要作用是存储用户建立的临时表和临时存储过程，存储用户说明的全局变量值，为数据排序创建临时表，存储用户利用游标说明所筛选出来的数据。</p>
<h3>3.	创建数据库</h3>
<p>选择开始菜单中→程序→【Management SQL Server 2008】→【SQL Server Management Studio】命令，打开【SQL Server Management Studio】窗口，并使用Windows或 SQL Server身份验证建立连接。</p>
<p><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://ws1.sinaimg.cn/large/d71f8b2fgy1fq55rpftisj20id0crq4i.jpg" alt title>
                </div>
                <div class="image-caption"></div>
            </figure></p>
<p>图1.1 新建数据库</p>
<p>在【对象资源管理器】窗口中展开服务器，然后选择【数据库】节点。右键单击【数据库】节点，从弹出来的快捷菜单中选择【新建数据库】命令。执行上述操作后，会弹出【新建数据库】对话框。在对话框、左侧有3个选项，分别是【常规】、【选项】和【文件组】。完成这三个选项中的设置会后，就完成了数据库的创建工作，在【数据库名称】文本框中输入要新建数据库的名称。例如，这里以“Students”。
【数据库文件】列表中包括两行，一行是数据库文件，而另一行是日志文件。通过单击下面的【添加】、【删除】按钮添加或删除数据库文件，如图1.1。</p>
<p>【逻辑名称】指定该文件的文件名。</p>
<p>【文件类型】用于区别当前文件是数据文件还是日志文件。</p>
<p>【文件组】显示当前数据库文件所属的文件组。一个数据只能存在一个文件组里。</p>
<p>【初始大小】指定该文件的初始容量。默认值为3MB.日志默认值为1MB。</p>
<p>【自动增长】用于设置文件的容量不够用时，文件根据何中增长方式自动增长。</p>
<p>完成以上操作后，单击【确定】按钮关闭【新建数据库】对话框。至此“新建的数据”数据库创建成功。新建的数据库可以再【对象资源管理器】窗口看到，如下图1.2所示。</p>
<p><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://ws1.sinaimg.cn/large/d71f8b2fgy1fq55qxojyqj20bu090di5.jpg" alt title>
                </div>
                <div class="image-caption"></div>
            </figure></p>
<p>图1.2建好后的数据库Students</p>
<h3>4.	修改数据库</h3>
<p>建立一个数据库之后，可以根据需要对该数据库的结构进行修改。</p>
<p>启动SSMS，在“对象资源管理器”窗格中展开数据库节点，右击要修改的数据库名称，在弹出的快捷菜单中选择“属性”命令，打开“数据库属性”对话框。可以通过修改数据库属性来修改数据库。修改数据库的操作包括增减数据库文件、修改文件属性（包括数据库的名称、大小和属性）、修改数据库选项等。</p>
<h3>5.	删除数据库</h3>
<p>为了减少系统资源的消耗，对于不再需要的用户创建数据库，应当把它从数据库服务器中删除，从而将其所占的磁盘空间全部释放掉。
删除数据库的具体操作如下：</p>
<p>启动SSMS，在“对象资源管理器”窗格中展开数据库节点，右击要删除的数据库名称，在弹出的快捷菜单中选择“删除”命令，打开“删除对象”对话框，单击“确定”按钮，数据库就被删除。</p>
<h4>1.	分离和附件数据库</h4>
<p>当数据库需要从一台计算机移到另一台计算机，或者需要从一个物理磁盘移到另一个物理磁盘时，常要进行数据库的附加与分离操作。
附加数据库是指将当前数据库以外的数据库附加到当前数据库服务器中。
附加数据库的具体操作如下：</p>
<p>启动SSMS，在“对象资源管理器”窗格中右击“数据库”节点在快捷菜单中选择“附加”命令，打开“附加数据库”对话框，如图1.3所示，单击“添加”按钮，打开“定位数据库文件”对话框，选择要附加的数据库主数据文件（.mdf），单击“确定”按钮，返回上述“附加数据库”对话框，单击“确定”按钮，完成数据库的附加操作。</p>
<p><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://ws1.sinaimg.cn/large/d71f8b2fgy1fq55sk9nhsj209v0b541h.jpg" alt title>
                </div>
                <div class="image-caption"></div>
            </figure></p>
<p>图1.3 附加数据库</p>
<p><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://ws1.sinaimg.cn/large/d71f8b2fgy1fq55tj2m36j20bq0as41r.jpg" alt title>
                </div>
                <div class="image-caption"></div>
            </figure></p>
<p>图1.4 分离数据库</p>
<p>分离数据库就是讲数据库从SQLserver2008服务器中卸载，但依然保存数据库的数据文件和日志文件。需要时，分离的数据库，可以重新附加到SQL server2008服务器中。</p>
<p>分离数据库的具体操作如下：</p>
<p>启动SSMS，在“对象资源管理器”窗格中展开数据库节点，右击要分离的数据库名称，在弹出的快捷菜单中单击“任务”→“分离”命令，如图1.4所示，打开“分离数据库”对话框，单击“确定”按钮，实现数据库的分离。</p>
<h2>简答题：</h2>
<p>（1）打开SQL Server Management Studio时，怎样进行数据库的登录认证？</p>
<p>答：</p>
<ol>
<li>打开 SQL Server Management Studio，以 Windows身份认证方式登录</li>
<li>在对象资源管理器下，右键 Security ==&gt; Logins ==&gt; New Login</li>
<li>点击图片中的Logins</li>
<li>会显示SQL server 的所有用户</li>
</ol>
<p>（2）对象资源管理器的作用是什么？
答：“对象资源管理器”是服务器中所有数据库对象的树视图。此树视图可以包括SQL Server Database Engine、Reporting Services、Analysis Services、Integration Services和SQL Server Mobile的数据库。对象资源管理器包括与其链接的所有服务器的信息。</p>
<h1>实验二   管理数据库操作</h1>
<p>实验日期：</p>
<h2>实验目标：</h2>
<p>（1）熟练掌握用SQL语句创建数据库的方法。</p>
<p>（2）熟练掌握数据库属性的设置。</p>
<p>（3）掌握数据库的修改和删除方法。</p>
<h2>实验内容：</h2>
<p>（1）利用SQL Server Management Studio创建一个”SM”的数据库，初始大小为3MB,最大为50MB，数据库自动增长，增长方式按10%；日志文件初始大小为2MB，最大值不受限制，按1MB增长。</p>
<p>（2）通过SQL语句创建一个名为“学籍”的数据库，指定主文件名为“学籍_data”，存储路径为“d:\example\学籍_data.mdf”，该数据文件的初始大小为10MB，最大为100MB，增长方式按10MB增长；指定主日志文件名为“学籍_log”，存储路径为“d:\example\学籍_log.ldf”，该日志文件初始大小为20MB，最大为200MB，按10MB增长。</p>
<p>①	在工具栏单击“新建查询”按钮，打开代码编辑器，输入如下SQL语句。</p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">   <span class="keyword">Create</span> <span class="keyword">database</span> 学籍</span><br><span class="line">   <span class="keyword">On</span>  primary</span><br><span class="line">(<span class="keyword">name</span>=学籍_data,</span><br><span class="line">Filename=’d:\example\学籍_data.mdf’,</span><br><span class="line"><span class="keyword">Size</span>=<span class="number">10</span>,</span><br><span class="line"><span class="keyword">Maxsize</span>=<span class="number">100</span>,</span><br><span class="line">Filegrowth=<span class="number">10</span>)</span><br><span class="line"><span class="keyword">Log</span> <span class="keyword">on</span></span><br><span class="line">(<span class="keyword">name</span>=学籍_log,</span><br><span class="line">Filename=’d:\example\学籍_log.ldf’,</span><br><span class="line"><span class="keyword">Size</span>=<span class="number">20</span>,</span><br><span class="line"><span class="keyword">Maxsize</span>=<span class="number">200</span>,</span><br><span class="line">Filegrowth=<span class="number">10</span>)</span><br></pre></td></tr></table></figure></p>
<p>请执行该语句，即可创建“学籍”数据库。</p>
<p>② 使用对象资源管理器，可以修改“学籍”数据库。选择“学籍”数据库的节点，点击右键，在弹出的快捷菜单中选择“属性”命令，打开“数据库属性”对话框，即可进行数据库的修改操作。</p>
<p>③ 使用”SQL”语句，在“学籍”数据库中添加一个数据文件“学籍_data1”，指定其初始大小为4MB，最大不受限制，增长方式按10%增长。</p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Alter</span> <span class="keyword">database</span> 学籍</span><br><span class="line"><span class="keyword">Add</span> <span class="keyword">file</span></span><br><span class="line">(<span class="keyword">name</span>=’学籍_data1’,</span><br><span class="line">Filename=’d:\example\学籍_data1.mdf’,</span><br><span class="line"><span class="keyword">Size</span>=<span class="number">4</span>,</span><br><span class="line"><span class="keyword">Maxsize</span>=<span class="keyword">unlimited</span>,</span><br><span class="line">Filegrowth=<span class="number">10</span>%)</span><br><span class="line"><span class="keyword">Go</span></span><br></pre></td></tr></table></figure></p>
<p>④	使用SQL语句删除“学籍”数据库。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Drop</span> <span class="keyword">database</span> 学籍</span><br><span class="line"><span class="keyword">GO</span></span><br></pre></td></tr></table></figure></p>
<p>提示：当数据库正在参与复制是不能删除，当数据库正在被复制时不能删除，当有用户正在使用数据库时不能删除。</p>
<h2>简答题：</h2>
<p>（1）SQL Server2008中的数据库能否只包含数据文件？</p>
<h1>实验三   用T-SQL创建与修改表的操作</h1>
<p>实验日期：</p>
<h2>实验目标：</h2>
<p>（1）熟练掌握各种数据类型。</p>
<p>（2）熟练运用T-SQL（Transact-SQL）语句正确创建表。</p>
<p>（3）掌握常用的数据完整性约束。</p>
<h2>实验内容：</h2>
<p>（1）创建“学籍”数据库，在该数据库中创建Student表。
表3.1 Student表的结构</p>
<table>
<thead>
<tr>
<th style="text-align:center">列名</th>
<th style="text-align:center">数据类型</th>
<th style="text-align:center">长度</th>
<th style="text-align:center">字段说明</th>
<th style="text-align:center">能否为空</th>
<th style="text-align:center">是否主键</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Sno</td>
<td style="text-align:center">CHAR</td>
<td style="text-align:center">10</td>
<td style="text-align:center">学号</td>
<td style="text-align:center">否</td>
<td style="text-align:center">是</td>
</tr>
<tr>
<td style="text-align:center">Sname</td>
<td style="text-align:center">CHAR</td>
<td style="text-align:center">10</td>
<td style="text-align:center">姓名</td>
<td style="text-align:center">是</td>
<td style="text-align:center">否</td>
</tr>
<tr>
<td style="text-align:center">Ssex</td>
<td style="text-align:center">CHAR</td>
<td style="text-align:center">2</td>
<td style="text-align:center">性别</td>
<td style="text-align:center">是</td>
<td style="text-align:center">否</td>
</tr>
<tr>
<td style="text-align:center">Sage</td>
<td style="text-align:center"></td>
<td style="text-align:center">TINYINT</td>
<td style="text-align:center">年龄</td>
<td style="text-align:center">是</td>
<td style="text-align:center">否</td>
</tr>
<tr>
<td style="text-align:center">Sdept</td>
<td style="text-align:center">CHAR</td>
<td style="text-align:center">10</td>
<td style="text-align:center">系</td>
<td style="text-align:center">是</td>
<td style="text-align:center">否</td>
</tr>
</tbody>
</table>
<p>利用T-SQL命令创建Student表，表的结构如表3.1所示。
代码如下：
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span>  <span class="keyword">TABLE</span>  Student</span><br><span class="line">( Sno  <span class="built_in">CHAR</span>(<span class="number">10</span>)  primary <span class="keyword">key</span>,</span><br><span class="line"> Sname  <span class="built_in">CHAR</span>(<span class="number">10</span>),</span><br><span class="line"> Ssex  <span class="built_in">CHAR</span>(<span class="number">2</span>) <span class="keyword">check</span> (Ssex <span class="keyword">in</span> (‘男’,’女’)),</span><br><span class="line"> Sage  <span class="built_in">TINYINT</span>,</span><br><span class="line"> Sdept  <span class="built_in">CHAR</span>(<span class="number">10</span>)</span><br><span class="line">  )</span><br></pre></td></tr></table></figure></p>
<p>（2）利用T-SQL命令创建Course表，表的结构如表3.2所示。</p>
<p>表3.2 Course表的结构</p>
<table>
<thead>
<tr>
<th style="text-align:center">列名</th>
<th style="text-align:center">数据类型</th>
<th style="text-align:center">长度</th>
<th style="text-align:center">字段说明</th>
<th style="text-align:center">能否为空</th>
<th style="text-align:center">是否主键</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Cno</td>
<td style="text-align:center">CHAR</td>
<td style="text-align:center">5</td>
<td style="text-align:center">课程号</td>
<td style="text-align:center">否</td>
<td style="text-align:center">是</td>
</tr>
<tr>
<td style="text-align:center">Cname</td>
<td style="text-align:center">CHAR</td>
<td style="text-align:center">10</td>
<td style="text-align:center">课程名</td>
<td style="text-align:center">否</td>
<td style="text-align:center">否</td>
</tr>
<tr>
<td style="text-align:center">Credits</td>
<td style="text-align:center">TINYINT</td>
<td style="text-align:center"></td>
<td style="text-align:center">学分</td>
<td style="text-align:center">是</td>
<td style="text-align:center">否</td>
</tr>
<tr>
<td style="text-align:center">PCno</td>
<td style="text-align:center">CHAR</td>
<td style="text-align:center">5</td>
<td style="text-align:center">先修课程号</td>
<td style="text-align:center">是</td>
<td style="text-align:center">否</td>
</tr>
</tbody>
</table>
<p>代码如下：</p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Course (</span><br><span class="line">Cno     <span class="built_in">char</span>(<span class="number">5</span>)  <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">Cname   <span class="built_in">char</span>(<span class="number">10</span>)  <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"> PCno    <span class="built_in">char</span>(<span class="number">5</span>),</span><br><span class="line">Credit  <span class="built_in">tinyint</span>  <span class="keyword">CHECK</span> (Credit &gt; <span class="number">0</span>),</span><br><span class="line">PRIMARY <span class="keyword">KEY</span>(Cno),</span><br><span class="line"><span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (PCno) <span class="keyword">REFERENCES</span> Course(Cno),</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<p>（3）为已经创建了的Student表创建一个约束，规定在Student表中，如果学生没有提供所在系，就写入默认值“计算机系”。df_dept为该约束的名。
代码如下：</p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Alter</span> <span class="keyword">table</span> Student</span><br><span class="line"><span class="keyword">Add</span> <span class="keyword">constraint</span> df_dept</span><br><span class="line"><span class="keyword">Default</span>  ‘计算机系’  <span class="keyword">for</span>  Sdept</span><br></pre></td></tr></table></figure></p>
<p>（4）利用T-SQL命令创建SC表，表的结构如表3.3所示。
表3.3  SC表的结构</p>
<table>
<thead>
<tr>
<th style="text-align:center">列名</th>
<th style="text-align:center">数据类型</th>
<th style="text-align:center">长度</th>
<th style="text-align:center">字段说明</th>
<th style="text-align:center">能否为空</th>
<th style="text-align:center">是否主键</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Sno</td>
<td style="text-align:center">CHAR</td>
<td style="text-align:center">10</td>
<td style="text-align:center">学号</td>
<td style="text-align:center">否</td>
<td style="text-align:center">是</td>
</tr>
<tr>
<td style="text-align:center">Cno</td>
<td style="text-align:center">CHAR</td>
<td style="text-align:center">5</td>
<td style="text-align:center">课程号</td>
<td style="text-align:center">否</td>
<td style="text-align:center">是</td>
</tr>
<tr>
<td style="text-align:center">Grade</td>
<td style="text-align:center">TINYINT</td>
<td style="text-align:center"></td>
<td style="text-align:center">成绩</td>
<td style="text-align:center">是</td>
<td style="text-align:center">否</td>
</tr>
</tbody>
</table>
<p>代码如下：
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span>  <span class="keyword">TABLE</span>  SC(</span><br><span class="line">Sno <span class="built_in">char</span>(<span class="number">10</span>) <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span>(Sno) <span class="keyword">REFERENCES</span> Student(Sno) <span class="keyword">ON</span> <span class="keyword">DELETE</span> <span class="keyword">CASCADE</span>,</span><br><span class="line">Cno <span class="built_in">char</span>(<span class="number">5</span>)  <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span>(Cno) <span class="keyword">REFERENCES</span> Course(Cno),</span><br><span class="line">Grade <span class="built_in">tinyint</span> <span class="keyword">CHECK</span>(grade&lt;=<span class="number">100</span> <span class="keyword">and</span> grade&gt;=<span class="number">0</span>),</span><br><span class="line">PRIMARY <span class="keyword">KEY</span>(Sno,Cno)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<p>执行并思考Sno char(10) FOREIGN KEY(Sno) REFERENCES Student(Sno) ON DELETE CASCADE语句中ON DELETE CASCADE的含义与作用。</p>
<h2>问答题</h2>
<p>（1）T-SQL支持的数据类型有哪些？</p>
<p>答：整数数据类型，浮点数据类型，字符型数据类型，日期和时间数据类型。</p>
<p>（2）Tinyint数据类型定义的数据的取值范围是多少？</p>
<p>存储0~255之间的整数</p>
<p>（3）写出创建以下表3.4-3.6所示的表结构的SQL语句，要求在定义表的同时定义数据的完整性约束。</p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Create</span> <span class="keyword">table</span> 图书表(  </span><br><span class="line">书号 <span class="keyword">nchar</span>(<span class="number">6</span>) primary <span class="keyword">key</span>,   </span><br><span class="line">书名 <span class="keyword">nvarchar</span>(<span class="number">30</span>) <span class="keyword">not</span> <span class="literal">null</span>,   </span><br><span class="line">第一作者 <span class="built_in">char</span>(<span class="number">10</span>) <span class="keyword">not</span> <span class="literal">null</span>,   </span><br><span class="line">出版日期 smalldatetime,   </span><br><span class="line">价格：<span class="built_in">numeric</span>(<span class="number">4</span>,<span class="number">1</span>) )</span><br></pre></td></tr></table></figure></p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Create</span> <span class="keyword">table</span> 书店表(    </span><br><span class="line">书店编号 <span class="keyword">nchar</span>(<span class="number">6</span>) primary <span class="keyword">key</span>,   </span><br><span class="line">店名 <span class="keyword">nvarchar</span>(<span class="number">30</span>) <span class="keyword">not</span> <span class="literal">null</span>,    </span><br><span class="line">电话<span class="built_in">char</span>(<span class="number">8</span>) <span class="keyword">check</span>(电话 <span class="keyword">like</span>   ‘[<span class="number">0</span><span class="number">-9</span>][<span class="number">0</span><span class="number">-9</span>][<span class="number">0</span><span class="number">-9</span>][<span class="number">0</span><span class="number">-9</span>][<span class="number">0</span><span class="number">-9</span>][<span class="number">0</span><span class="number">-9</span>][<span class="number">0</span><span class="number">-9</span>] [<span class="number">0</span><span class="number">-9</span>]’),   </span><br><span class="line">地址 <span class="built_in">varchar</span>(<span class="number">40</span>),   </span><br><span class="line">邮政编码 <span class="built_in">char</span>(<span class="number">6</span>) )</span><br></pre></td></tr></table></figure></p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Create</span> <span class="keyword">table</span> 图书销售表(   </span><br><span class="line">书号 <span class="keyword">nchar</span>(<span class="number">6</span>) <span class="keyword">not</span> <span class="literal">null</span>,    </span><br><span class="line">书店编号 <span class="keyword">nchar</span>(<span class="number">6</span>) <span class="keyword">not</span> <span class="literal">null</span>,    </span><br><span class="line">销售日期 smalldatetime <span class="keyword">no</span> tnull,</span><br><span class="line">销售数量 smalldatetime <span class="keyword">check</span>(</span><br><span class="line">销售数量 &gt;= <span class="number">1</span>) )</span><br></pre></td></tr></table></figure></p>
<p>表3.4 图书表</p>
<table>
<thead>
<tr>
<th style="text-align:center">列名</th>
<th style="text-align:center">数据类型</th>
<th style="text-align:center">约束</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">书号</td>
<td style="text-align:center">统一字符编码定长类型，长度为6</td>
<td style="text-align:center">主键</td>
</tr>
<tr>
<td style="text-align:center">书名</td>
<td style="text-align:center">统一字符编码可变长类型，长度为30</td>
<td style="text-align:center">非空</td>
</tr>
<tr>
<td style="text-align:center">第一作者</td>
<td style="text-align:center">普通编码定长字符，长度为10</td>
<td style="text-align:center">非空</td>
</tr>
<tr>
<td style="text-align:center">出版日期</td>
<td style="text-align:center">小日期时间型</td>
<td style="text-align:center">非空</td>
</tr>
<tr>
<td style="text-align:center">价格</td>
<td style="text-align:center">定点小数，小数部分1位，整数部分3位</td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<p>表3.5 书店表</p>
<table>
<thead>
<tr>
<th style="text-align:center">列名</th>
<th style="text-align:center">数据类型</th>
<th style="text-align:center">约束</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">书店编号</td>
<td style="text-align:center">统一字符编码定长类型，长度为6</td>
<td style="text-align:center">主键</td>
</tr>
<tr>
<td style="text-align:center">店名</td>
<td style="text-align:center">字符编码可变长类型，长度为30</td>
<td style="text-align:center">非空</td>
</tr>
<tr>
<td style="text-align:center">电话</td>
<td style="text-align:center">普通编码定长字符类型，长度为8</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">地址</td>
<td style="text-align:center">普通编码可变长字符类型，长度40</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">邮政编码</td>
<td style="text-align:center">普通编码定长字符类型，长度6</td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<p>表3.6 销售表</p>
<table>
<thead>
<tr>
<th style="text-align:center">列名</th>
<th style="text-align:center">数据类型</th>
<th style="text-align:center">约束</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">书号</td>
<td style="text-align:center">统一字符编码定长类型，长度为6</td>
<td style="text-align:center">主键，外键</td>
</tr>
<tr>
<td style="text-align:center">书店编号</td>
<td style="text-align:center">统一字符编码定长类型，长度为6</td>
<td style="text-align:center">主键，外键</td>
</tr>
<tr>
<td style="text-align:center">销售日期</td>
<td style="text-align:center">小日期时间型</td>
<td style="text-align:center">主键</td>
</tr>
<tr>
<td style="text-align:center">销售数量</td>
<td style="text-align:center">小整型</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">邮政编码</td>
<td style="text-align:center">普通编码定长字符类型，长度6</td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<p>（4）删除“销售表”中的“邮政编码”列；
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 书店表 <span class="keyword">Drop</span> <span class="keyword">column</span> 邮政编码</span><br></pre></td></tr></table></figure></p>
<p>（5）将“销售表”中的“销售数量”列的数据类型改为整型
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 图书销售表 <span class="keyword">Alter</span> <span class="keyword">column</span> 销售数量 <span class="built_in">int</span></span><br></pre></td></tr></table></figure></p>
<h1>实验四   数据查询的操作（一）</h1>
<p>实验日期：</p>
<h2>实验目标：</h2>
<p>（1）掌握SELECT子句以及WHERE子句的使用方法。</p>
<p>（2）学会应用ORDER BY子句。</p>
<p>（3）掌握5种基本的聚合函数。</p>
<p>（4）学会分组统计和二次查询。</p>
<p>（5）学会数据的导入与导出的方法。</p>
<h2>实验内容：</h2>
<p>在SELECT语句中使用WHERE子句，在WHERE子句后跟一个条件式，就可以查询满足条件的行。
WHERE子句的格式：WHERE〈条件〉。
表4.1 常用的查询条件</p>
<table>
<thead>
<tr>
<th style="text-align:center">查询条件</th>
<th style="text-align:center">运算符</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">比较</td>
<td style="text-align:center">=、&lt;、&lt;=、&gt;、&gt;=、&lt;&gt;、!=、!&lt;、!&gt;</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">范围谓词</td>
<td style="text-align:center">BETWEEN   AND 、NOT  BETWEEN  AND</td>
<td style="text-align:center">介于二者之间（包括两端）、不介于二者之间</td>
</tr>
<tr>
<td style="text-align:center">集合谓词</td>
<td style="text-align:center">IN 、 NOT  IN</td>
<td style="text-align:center">在集合中、不在集合中</td>
</tr>
<tr>
<td style="text-align:center">字符匹配谓词</td>
<td style="text-align:center">LIKE、NOT LIKE</td>
<td style="text-align:center">匹配、不匹配</td>
</tr>
<tr>
<td style="text-align:center">空值</td>
<td style="text-align:center">IS NULL 、IS NOT NULL</td>
<td style="text-align:center">是空值、不是空值</td>
</tr>
<tr>
<td style="text-align:center">逻辑运算</td>
<td style="text-align:center">NOT、AND、OR</td>
<td style="text-align:center">逻辑非、逻辑与、逻辑或</td>
</tr>
</tbody>
</table>
<p>打开对象资源管理器，创建一个名为”lianxi1”的数据库，在该数据库中导入以下的仓库表4.2和职工表4.3。
表4.2 仓库表</p>
<table>
<thead>
<tr>
<th style="text-align:center">仓库号</th>
<th style="text-align:center">城市</th>
<th style="text-align:center">面积</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">WH1</td>
<td style="text-align:center">北京</td>
<td style="text-align:center">370</td>
</tr>
<tr>
<td style="text-align:center">WH2</td>
<td style="text-align:center">上海</td>
<td style="text-align:center">500</td>
</tr>
<tr>
<td style="text-align:center">WH3</td>
<td style="text-align:center">广州</td>
<td style="text-align:center">200</td>
</tr>
<tr>
<td style="text-align:center">WH4</td>
<td style="text-align:center">广州</td>
<td style="text-align:center">300</td>
</tr>
<tr>
<td style="text-align:center">WH5</td>
<td style="text-align:center">天津</td>
<td style="text-align:center">340</td>
</tr>
<tr>
<td style="text-align:center">WH6</td>
<td style="text-align:center">上海</td>
<td style="text-align:center">350</td>
</tr>
<tr>
<td style="text-align:center">WH7</td>
<td style="text-align:center">上海</td>
<td style="text-align:center">600</td>
</tr>
<tr>
<td style="text-align:center">WH8</td>
<td style="text-align:center">天津</td>
<td style="text-align:center">300</td>
</tr>
</tbody>
</table>
<p>注意：面积以平方为单位。</p>
<p>表4.3 职工表</p>
<table>
<thead>
<tr>
<th style="text-align:center">职工号</th>
<th style="text-align:center">姓名</th>
<th style="text-align:center">仓库号</th>
<th style="text-align:center">月工资</th>
<th style="text-align:center">性别</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">E1</td>
<td style="text-align:center">朱迪</td>
<td style="text-align:center">WH2</td>
<td style="text-align:center">2220</td>
<td style="text-align:center">女</td>
</tr>
<tr>
<td style="text-align:center">E2</td>
<td style="text-align:center">牛丽丽</td>
<td style="text-align:center">WH1</td>
<td style="text-align:center">1810</td>
<td style="text-align:center">女</td>
</tr>
<tr>
<td style="text-align:center">E4</td>
<td style="text-align:center">李安</td>
<td style="text-align:center">WH2</td>
<td style="text-align:center">1850</td>
<td style="text-align:center">男</td>
</tr>
<tr>
<td style="text-align:center">E5</td>
<td style="text-align:center">王进步</td>
<td style="text-align:center">WH3</td>
<td style="text-align:center">1530</td>
<td style="text-align:center">男</td>
</tr>
<tr>
<td style="text-align:center">E6</td>
<td style="text-align:center">李光铭</td>
<td style="text-align:center">WH1</td>
<td style="text-align:center">1550</td>
<td style="text-align:center">男</td>
</tr>
<tr>
<td style="text-align:center">E7</td>
<td style="text-align:center">赵芙蓉</td>
<td style="text-align:center">WH4</td>
<td style="text-align:center">2300</td>
<td style="text-align:center">女</td>
</tr>
<tr>
<td style="text-align:center">E8</td>
<td style="text-align:center">刘山</td>
<td style="text-align:center">WH4</td>
<td style="text-align:center">2000</td>
<td style="text-align:center">男</td>
</tr>
<tr>
<td style="text-align:center">E9</td>
<td style="text-align:center">张尚琳</td>
<td style="text-align:center">WH5</td>
<td style="text-align:center">2050</td>
<td style="text-align:center">女</td>
</tr>
<tr>
<td style="text-align:center">E10</td>
<td style="text-align:center">王玛丽</td>
<td style="text-align:center">WH5</td>
<td style="text-align:center">1900</td>
<td style="text-align:center">女</td>
</tr>
<tr>
<td style="text-align:center">E11</td>
<td style="text-align:center">胡尼克</td>
<td style="text-align:center">WH6</td>
<td style="text-align:center">2100</td>
<td style="text-align:center">男</td>
</tr>
<tr>
<td style="text-align:center">E12</td>
<td style="text-align:center">古梅</td>
<td style="text-align:center">WH7</td>
<td style="text-align:center">1700</td>
<td style="text-align:center">女</td>
</tr>
<tr>
<td style="text-align:center">E15</td>
<td style="text-align:center">胡俊</td>
<td style="text-align:center">WH5</td>
<td style="text-align:center">1780</td>
<td style="text-align:center">男</td>
</tr>
<tr>
<td style="text-align:center">E16</td>
<td style="text-align:center">胡轩</td>
<td style="text-align:center">WH1</td>
<td style="text-align:center">1600</td>
<td style="text-align:center">男</td>
</tr>
</tbody>
</table>
<p>用SQL语句完成以下的练习题：</p>
<ol>
<li>
<p>从职工关系中检索所有工资值。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 月工资</span><br><span class="line"><span class="keyword">from</span> zg</span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>检索仓库关系中的所有元组。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> *</span><br><span class="line"><span class="keyword">from</span> ck</span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>检索工资多于2000元的职工对应的职工号，姓名。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  职工号,月工资 </span><br><span class="line"><span class="keyword">from</span> zg </span><br><span class="line"><span class="keyword">where</span> 月工资&gt;<span class="number">2000</span></span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>检索哪些仓库的面积在400到550平方之间，列出仓库号和所在的城市。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 仓库号,城市 </span><br><span class="line"><span class="keyword">from</span> ck </span><br><span class="line"><span class="keyword">where</span> 面积&lt;=<span class="number">550</span> </span><br><span class="line"><span class="keyword">and</span> 面积&gt;=<span class="number">400</span></span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>检索出有广州哪些仓库，列出仓库号。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 仓库号</span><br><span class="line"><span class="keyword">from</span> ck </span><br><span class="line"><span class="keyword">where</span> 城市=<span class="string">'广州'</span></span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>检索出所在城市为广州的仓库的个数。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(仓库号)</span><br><span class="line"><span class="keyword">from</span> ck </span><br><span class="line"><span class="keyword">where</span> 城市=<span class="string">'广州'</span></span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>检索出所有职工的平均工资。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">avg</span>(月工资) </span><br><span class="line"><span class="keyword">from</span> zg</span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>检索出在WH5仓库工作的职工的人数。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(职工号) </span><br><span class="line"><span class="keyword">from</span> zg </span><br><span class="line"><span class="keyword">where</span> 仓库号=<span class="string">'WH5'</span></span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>检索出职工表的所有的仓库号，去掉重复值。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> 仓库号 <span class="keyword">from</span> zg</span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>检索出每个仓库的人数。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 仓库号,<span class="keyword">count</span>(*) <span class="keyword">as</span> 人数 </span><br><span class="line"><span class="keyword">from</span> zg </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> 仓库号</span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>检索出上海的仓库有哪些，列出仓库号、面积。查询结果按面积降序排列。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 仓库号,面积 </span><br><span class="line"><span class="keyword">from</span> ck </span><br><span class="line"><span class="keyword">where</span> 城市=<span class="string">'上海'</span> </span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> 面积</span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>检索出哪些仓库女职工的人数达到了3人。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 仓库号,<span class="keyword">count</span>(职工号)人数</span><br><span class="line"><span class="keyword">from</span> zg </span><br><span class="line"><span class="keyword">where</span> 性别=<span class="string">'女'</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> 仓库号 </span><br><span class="line"><span class="keyword">having</span> <span class="keyword">count</span>(职工号)&gt;<span class="number">3</span></span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>检索出所有姓胡的职工的职工号、姓名、性别、工资。查询结果按性别排降序、工资排升序。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 职工号,姓名,性别,月工资</span><br><span class="line"><span class="keyword">from</span> zg</span><br><span class="line"><span class="keyword">where</span> 姓名 <span class="keyword">like</span><span class="string">'胡%'</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> 性别 <span class="keyword">desc</span>,月工资 <span class="keyword">asc</span></span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>检索出职工“王玛丽”的年工资。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 月工资*<span class="number">12</span> <span class="keyword">as</span> 年薪</span><br><span class="line"><span class="keyword">from</span> zg</span><br><span class="line"><span class="keyword">where</span> 姓名=<span class="string">'王玛丽'</span></span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>检索出“WH1”和“WH2”两个仓库工作的职工的基本信息。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> *</span><br><span class="line"><span class="keyword">from</span> zg</span><br><span class="line"><span class="keyword">where</span> 仓库号=<span class="string">'WH1'</span><span class="keyword">or</span> 仓库号=<span class="string">'WH2'</span></span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>检索出年工资在24000以上的职工的姓名，年工资值。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 姓名</span><br><span class="line"><span class="keyword">from</span> zg</span><br><span class="line"><span class="keyword">where</span> 月工资*<span class="number">12</span>&gt;<span class="number">24000</span></span><br></pre></td></tr></table></figure></p>
</li>
</ol>
<h2>问答题：</h2>
<p>（1）WHERE子句与HAVING子句有和不同？</p>
<p>答：Where子句--指定查询条件，having短语—选择出只有满足指定条件的组.</p>
<p>where 子句的作用是在对查询结果进行分组前，将不符合where条件的行去掉，即在分组之前过滤数据，条件中不能包含聚组函数，使用where条件显示特定的行。</p>
<p>having 子句的作用是筛选满足条件的组，即在分组之后过滤数据，条件中经常包含聚组函数，使用having 条件显示特定的组，也可以使用多个分组标准进行分组。</p>
<p>（2）在WHERE子句中可以使用的运算符有哪些？WHERE子句中能不能使用聚集函数？</p>
<p>答：in，not in；字符匹配：like，not like；空值：is null，is not null；多重条件：and，or。
Where子句中不能使用聚集函数。</p>
<p>不能使用聚集函数</p>
<h1>实验五   数据查询的操作（二）</h1>
<p>实验日期：</p>
<h2>实验目标：</h2>
<p>（1）熟练掌握基本的连接操作，掌握内连接与外连接的方法，学会应用自身连接。</p>
<p>（2）熟练掌握不相关子查询。</p>
<p>（3）掌握相关子查询。</p>
<p>（4）学会给表命别名。</p>
<p>（5）学会数据的导入与导出的方法。</p>
<h3>实验内容：</h3>
<p>打开对象资源管理器，创建一个名为”lianxi2”的数据库，在该数据库中导入以下的仓库表5.1、职工表5.2、订购表5.3和供应商表5.4。</p>
<p>表5.1仓库表</p>
<table>
<thead>
<tr>
<th style="text-align:center">仓库号</th>
<th style="text-align:center">城市</th>
<th style="text-align:center">面积</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">WH1</td>
<td style="text-align:center">北京</td>
<td style="text-align:center">3700</td>
</tr>
<tr>
<td style="text-align:center">WH2</td>
<td style="text-align:center">上海</td>
<td style="text-align:center">5000</td>
</tr>
<tr>
<td style="text-align:center">WH3</td>
<td style="text-align:center">广州</td>
<td style="text-align:center">2000</td>
</tr>
<tr>
<td style="text-align:center">WH4</td>
<td style="text-align:center">武汉</td>
<td style="text-align:center">4000</td>
</tr>
<tr>
<td style="text-align:center">WH5</td>
<td style="text-align:center">上海</td>
<td style="text-align:center">4560</td>
</tr>
<tr>
<td style="text-align:center">WH6</td>
<td style="text-align:center">广州</td>
<td style="text-align:center">6700</td>
</tr>
<tr>
<td style="text-align:center">WH7</td>
<td style="text-align:center">珠海</td>
<td style="text-align:center">4800</td>
</tr>
</tbody>
</table>
<p>表5.2职工表</p>
<table>
<thead>
<tr>
<th style="text-align:center">仓库号</th>
<th style="text-align:center">职工号</th>
<th style="text-align:center">月工资</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">WH2</td>
<td style="text-align:center">E1</td>
<td style="text-align:center">2220</td>
</tr>
<tr>
<td style="text-align:center">WH1</td>
<td style="text-align:center">E2</td>
<td style="text-align:center">2210</td>
</tr>
<tr>
<td style="text-align:center">WH2</td>
<td style="text-align:center">E3</td>
<td style="text-align:center">4050</td>
</tr>
<tr>
<td style="text-align:center">WH3</td>
<td style="text-align:center">E4</td>
<td style="text-align:center">3230</td>
</tr>
<tr>
<td style="text-align:center">WH1</td>
<td style="text-align:center">E5</td>
<td style="text-align:center">3250</td>
</tr>
<tr>
<td style="text-align:center">WH1</td>
<td style="text-align:center">E6</td>
<td style="text-align:center">2300</td>
</tr>
<tr>
<td style="text-align:center">WH4</td>
<td style="text-align:center">E7</td>
<td style="text-align:center">5000</td>
</tr>
<tr>
<td style="text-align:center">WH5</td>
<td style="text-align:center">E8</td>
<td style="text-align:center">4000</td>
</tr>
<tr>
<td style="text-align:center">WH5</td>
<td style="text-align:center">E9</td>
<td style="text-align:center">3400</td>
</tr>
<tr>
<td style="text-align:center">WH6</td>
<td style="text-align:center">E10</td>
<td style="text-align:center">3800</td>
</tr>
</tbody>
</table>
<p>表5.3 订购表</p>
<table>
<thead>
<tr>
<th style="text-align:center">职工号</th>
<th style="text-align:center">供应商号</th>
<th style="text-align:center">订购单号</th>
<th style="text-align:center">订购日期</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">E3</td>
<td style="text-align:center">S7</td>
<td style="text-align:center">OR091204</td>
<td style="text-align:center">2009-12-4</td>
</tr>
<tr>
<td style="text-align:center">E1</td>
<td style="text-align:center">S4</td>
<td style="text-align:center">OR090101</td>
<td style="text-align:center">2009-4-1</td>
</tr>
<tr>
<td style="text-align:center">E7</td>
<td style="text-align:center">S4</td>
<td style="text-align:center">OR100402</td>
<td style="text-align:center">2010-4-2</td>
</tr>
<tr>
<td style="text-align:center">E6</td>
<td style="text-align:center">S6</td>
<td style="text-align:center">OR100121</td>
<td style="text-align:center">2010-1-21</td>
</tr>
<tr>
<td style="text-align:center">E3</td>
<td style="text-align:center">S4</td>
<td style="text-align:center">OR091115</td>
<td style="text-align:center">2009-11-15</td>
</tr>
<tr>
<td style="text-align:center">E1</td>
<td style="text-align:center">S6</td>
<td style="text-align:center">OR060201</td>
<td style="text-align:center">2006-2-1</td>
</tr>
<tr>
<td style="text-align:center">E3</td>
<td style="text-align:center">S6</td>
<td style="text-align:center">OR100312</td>
<td style="text-align:center">2010-3-12</td>
</tr>
<tr>
<td style="text-align:center">E3</td>
<td style="text-align:center">S3</td>
<td style="text-align:center">OR090302</td>
<td style="text-align:center">2009-3-2</td>
</tr>
<tr>
<td style="text-align:center">E8</td>
<td style="text-align:center">S7</td>
<td style="text-align:center">OR100928</td>
<td style="text-align:center">2010-9-28</td>
</tr>
<tr>
<td style="text-align:center">E6</td>
<td style="text-align:center">S7</td>
<td style="text-align:center">OR100712</td>
<td style="text-align:center">2010-7-12</td>
</tr>
<tr>
<td style="text-align:center">E5</td>
<td style="text-align:center">S3</td>
<td style="text-align:center">OR100507</td>
<td style="text-align:center">2010-5-7</td>
</tr>
</tbody>
</table>
<p>表5.4 供应商表</p>
<table>
<thead>
<tr>
<th style="text-align:center">供应商号</th>
<th style="text-align:center">供应商名</th>
<th style="text-align:center">地址</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">S3</td>
<td style="text-align:center">振华电子厂</td>
<td style="text-align:center">西安</td>
</tr>
<tr>
<td style="text-align:center">S4</td>
<td style="text-align:center">华通电子公司</td>
<td style="text-align:center">北京</td>
</tr>
<tr>
<td style="text-align:center">S6</td>
<td style="text-align:center">607厂</td>
<td style="text-align:center">郑州</td>
</tr>
<tr>
<td style="text-align:center">S7</td>
<td style="text-align:center">爱华电子厂</td>
<td style="text-align:center">北京</td>
</tr>
</tbody>
</table>
<p>用SQL语句完成以下的练习题：</p>
<ol>
<li>
<p>查询每个城市的仓库总面积。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 城市,<span class="keyword">sum</span>(面积) <span class="keyword">as</span> 总面积</span><br><span class="line"><span class="keyword">from</span> ck</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> 城市</span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>查询每个仓库的职工人数，如果该仓库没有职工，也要列出人数为0。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 仓库号,<span class="keyword">count</span>(职工号) <span class="keyword">as</span> 职工人数</span><br><span class="line"><span class="keyword">from</span> zg</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> 仓库号</span><br><span class="line"><span class="keyword">having</span> <span class="keyword">count</span>(职工号)&gt;=<span class="number">0</span></span><br></pre></td></tr></table></figure></p>
</li>
</ol>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ck.仓库号,<span class="keyword">count</span>(职工号)<span class="keyword">as</span> 职工人数</span><br><span class="line"><span class="keyword">from</span> ck <span class="keyword">left</span> <span class="keyword">join</span> zg <span class="keyword">on</span> ck.仓库号=zg.仓库号</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> ck.仓库号</span><br></pre></td></tr></table></figure></p>
<ol start="3">
<li>
<p>查询在上海工作的职工有多少个。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 城市,<span class="keyword">count</span>(职工号) <span class="keyword">as</span> 上海职工数</span><br><span class="line"><span class="keyword">from</span> ck,zg</span><br><span class="line"><span class="keyword">where</span> ck.仓库号=zg.仓库号</span><br><span class="line"><span class="keyword">and</span> </span><br><span class="line">ck.城市=<span class="string">'上海'</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> 城市</span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>查询哪些职工在上海工作，列出他们的职工号，仓库号。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 职工号,zg.仓库号</span><br><span class="line"><span class="keyword">from</span> ck,zg</span><br><span class="line"><span class="keyword">where</span> ck.城市=<span class="string">'上海'</span> </span><br><span class="line"><span class="keyword">and</span> </span><br><span class="line">ck.仓库号=zg.仓库号</span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>查询与E3号职工有订购业务联系的供应商号，供应商名。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> dg.供应商号,gys.供应商名</span><br><span class="line"><span class="keyword">from</span> dg,gys</span><br><span class="line"><span class="keyword">where</span> 职工号=<span class="string">'E3'</span> <span class="keyword">and</span> dg.供应商号=gys.供应商号</span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>查询哪些职工与爱华电子厂有订购业务联系，列出他们的职工号，仓库号。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> zg.职工号,zg.仓库号</span><br><span class="line"><span class="keyword">from</span> zg,gy</span><br><span class="line"><span class="keyword">where</span> gy.供应商名=<span class="string">'爱华电子厂'</span></span><br></pre></td></tr></table></figure></p>
</li>
</ol>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> zg.职工号,zg.仓库号</span><br><span class="line"><span class="keyword">from</span> dg <span class="keyword">join</span> gys <span class="keyword">on</span> dg.供应商号=gys.供应商号</span><br><span class="line"><span class="keyword">join</span> zg <span class="keyword">on</span> zg.职工号=dg.职工号</span><br><span class="line"><span class="keyword">where</span> 供应商名=<span class="string">'爱华电子厂'</span></span><br></pre></td></tr></table></figure></p>
<ol start="7">
<li>查询每个供应商的订购单数目，列出供应商号和他们的订购单数目。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> dg.供应商号,<span class="keyword">count</span>(dg.订购单号) <span class="keyword">as</span> 订购单数目</span><br><span class="line"><span class="keyword">from</span> dg,gy</span><br><span class="line"><span class="keyword">where</span> gy.供应商号=dg.供应商号</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> gy.供应商名,dg.供应商号</span><br></pre></td></tr></table></figure></li>
</ol>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> dg.供应商号,<span class="keyword">count</span>(订购单号) 订购单数目</span><br><span class="line"><span class="keyword">from</span> dg <span class="keyword">join</span> gys <span class="keyword">on</span> dg.供应商号=gys.供应商号</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> dg.供应商号</span><br></pre></td></tr></table></figure></p>
<ol start="8">
<li>查询工资在3000元以上，并在北京或上海工作的职工，列出他们的职工号和工资。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> zg.职工号,zg.月工资</span><br><span class="line"><span class="keyword">from</span> zg,ck</span><br><span class="line"><span class="keyword">where</span> (ck.城市=<span class="string">'北京'</span> <span class="keyword">or</span> ck.城市=<span class="string">'上海'</span>)</span><br><span class="line"><span class="keyword">and</span> zg.月工资&gt;<span class="number">3000</span></span><br></pre></td></tr></table></figure></li>
</ol>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 职工号,月工资</span><br><span class="line"><span class="keyword">from</span> ck <span class="keyword">join</span> zg <span class="keyword">on</span> ck.仓库号=zg.仓库号</span><br><span class="line"><span class="keyword">where</span> (城市=<span class="string">'北京'</span><span class="keyword">or</span> 城市=<span class="string">'上海'</span>) <span class="keyword">and</span> 月工资&gt;<span class="number">3000</span></span><br></pre></td></tr></table></figure></p>
<ol start="9">
<li>
<p>查询与供应商为S3的供应商有业务联系的职工他们的职工号、订购单号、仓库号、城市。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> dg.职工号,dg.订购单号,ck.仓库号,ck.城市</span><br><span class="line"><span class="keyword">from</span> gys <span class="keyword">join</span> dg <span class="keyword">on</span> gys.供应商号=dg.供应商号</span><br><span class="line"><span class="keyword">join</span> zg <span class="keyword">on</span> dg.职工号=zg.职工号</span><br><span class="line"><span class="keyword">join</span> ck <span class="keyword">on</span> zg.仓库号=ck.仓库号</span><br><span class="line"><span class="keyword">where</span> gys.供应商号=<span class="string">'S3'</span></span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>查询出哪些仓库没有分配职工。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ck.仓库号</span><br><span class="line"><span class="keyword">from</span> ck <span class="keyword">left</span> <span class="keyword">join</span> zg <span class="keyword">on</span> ck.仓库号=zg.仓库号</span><br><span class="line"><span class="keyword">where</span> zg.职工号 <span class="keyword">is</span> <span class="literal">null</span></span><br></pre></td></tr></table></figure></p>
</li>
</ol>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ck.仓库号,<span class="keyword">count</span>(zg.仓库号) 人数</span><br><span class="line"><span class="keyword">from</span> ck <span class="keyword">left</span> <span class="keyword">join</span> zg <span class="keyword">on</span> zg.仓库号 = ck.仓库号</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> ck.仓库号</span><br><span class="line"><span class="keyword">having</span> <span class="keyword">count</span>(zg.仓库号)=<span class="number">0</span></span><br></pre></td></tr></table></figure></p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 仓库号</span><br><span class="line"><span class="keyword">from</span> ck</span><br><span class="line"><span class="keyword">where</span> 仓库号 <span class="keyword">not</span> <span class="keyword">in</span> (<span class="keyword">select</span> <span class="keyword">distinct</span> 仓库号 <span class="keyword">from</span> zg)</span><br></pre></td></tr></table></figure></p>
<ol start="11">
<li>
<p>查询出哪些职工的工资高于全体职工平均工资。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 职工号</span><br><span class="line"><span class="keyword">from</span> zg</span><br><span class="line"><span class="keyword">where</span> 月工资&gt;(<span class="keyword">select</span> <span class="keyword">avg</span>(月工资) <span class="keyword">from</span> zg )</span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>查询出哪些职工的工资高于他所在仓库的职工的平均工资。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 职工号</span><br><span class="line"><span class="keyword">from</span> zg <span class="keyword">join</span> </span><br><span class="line">(<span class="keyword">select</span> 仓库号 <span class="keyword">avg</span>(月工资) <span class="keyword">as</span> 平均工资</span><br><span class="line"><span class="keyword">from</span> zg <span class="keyword">group</span> <span class="keyword">by</span> 仓库号) <span class="keyword">as</span> a <span class="keyword">on</span> zg.仓库号=ck.职工号</span><br><span class="line"><span class="keyword">where</span> zg.月工资&gt;a.avg(月工资)</span><br></pre></td></tr></table></figure></p>
</li>
</ol>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 职工号</span><br><span class="line"><span class="keyword">from</span> zg a</span><br><span class="line"><span class="keyword">where</span> 月工资&gt;(<span class="keyword">select</span> <span class="keyword">avg</span>(月工资) </span><br><span class="line"><span class="keyword">from</span> zg b</span><br><span class="line"><span class="keyword">where</span> b.仓库号=a.仓库号)</span><br></pre></td></tr></table></figure></p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 职工号</span><br><span class="line"><span class="keyword">from</span> zg <span class="keyword">as</span> a <span class="keyword">join</span></span><br><span class="line">(<span class="keyword">select</span> 仓库号,<span class="keyword">avg</span>(月工资) <span class="keyword">as</span> 平均工资 </span><br><span class="line"><span class="keyword">from</span> zg <span class="keyword">group</span> <span class="keyword">by</span> 仓库号)</span><br><span class="line"><span class="keyword">as</span> b <span class="keyword">on</span> a.仓库号=b.仓库号</span><br><span class="line"><span class="keyword">where</span> a.月工资&gt; b.平均工资</span><br></pre></td></tr></table></figure></p>
<ol start="13">
<li>求出哪个职工所发出的订购单最多。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  top <span class="number">1</span> 职工号,<span class="keyword">count</span>(订购单号) <span class="keyword">as</span> 订购单数</span><br><span class="line"><span class="keyword">from</span> dg</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> 职工号</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> 订购单数 <span class="keyword">desc</span></span><br></pre></td></tr></table></figure></li>
</ol>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 职工号</span><br><span class="line"><span class="keyword">from</span> dg</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> 职工号</span><br><span class="line"><span class="keyword">having</span> <span class="keyword">count</span>(订购单号)=</span><br><span class="line">(<span class="keyword">select</span> top <span class="number">1</span> <span class="keyword">count</span>(订购单号) <span class="keyword">as</span> 订单数</span><br><span class="line"><span class="keyword">from</span> dg</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> 职工号</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> 订单数 <span class="keyword">desc</span>)</span><br></pre></td></tr></table></figure></p>
<h1>实验六   数据查询的操作（三）</h1>
<p>实验日期：</p>
<h2>实验目标：</h2>
<p>（1）熟练掌握基本的连接操作，掌握内连接与外连接的方法，学会应用自身连接。</p>
<p>（2）熟练掌握不相关子查询。</p>
<p>（3）掌握相关子查询。</p>
<p>（4）学会给表命别名。</p>
<p>（5）学会在FROM子句中派生关系，构造查询。</p>
<h2>实验内容：</h2>
<p>假设“教学管理”数据库中有4个基本表（关系）：</p>
<p>学生关系：学生（学号，姓名，性别，所在系）</p>
<p>课程关系：课程（课程号，课程名，开课学期，教师号）</p>
<p>选课关系：选课（学号，课程号，成绩）</p>
<p>教师关系：教师（教师号，姓名，职称，部门）</p>
<p>每个关系的当前值分别如表所示。</p>
<p>打开对象资源管理器，创建一个名为”教学管理”的数据库，在该数据库中导入以下的</p>
<p>表6.1—6.4。</p>
<p>表6.1 学生关系</p>
<table>
<thead>
<tr>
<th style="text-align:center">学号</th>
<th style="text-align:center">姓名</th>
<th style="text-align:center">性别</th>
<th style="text-align:left">年龄</th>
<th style="text-align:center">所在系</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">S101101</td>
<td style="text-align:center">陈名军</td>
<td style="text-align:center">男</td>
<td style="text-align:left">18</td>
<td style="text-align:center">计算机系</td>
</tr>
<tr>
<td style="text-align:center">S101102</td>
<td style="text-align:center">吴小晴</td>
<td style="text-align:center">女</td>
<td style="text-align:left">19</td>
<td style="text-align:center">计算机系</td>
</tr>
<tr>
<td style="text-align:center">S101103</td>
<td style="text-align:center">王明燕</td>
<td style="text-align:center">女</td>
<td style="text-align:left">19</td>
<td style="text-align:center">计算机系</td>
</tr>
<tr>
<td style="text-align:center">S101104</td>
<td style="text-align:center">严利</td>
<td style="text-align:center">男</td>
<td style="text-align:left">20</td>
<td style="text-align:center">计算机系</td>
</tr>
<tr>
<td style="text-align:center">S101105</td>
<td style="text-align:center">朱欣</td>
<td style="text-align:center">男</td>
<td style="text-align:left">20</td>
<td style="text-align:center">计算机系</td>
</tr>
<tr>
<td style="text-align:center">S101201</td>
<td style="text-align:center">李国庆</td>
<td style="text-align:center">男</td>
<td style="text-align:left">21</td>
<td style="text-align:center">信息系</td>
</tr>
<tr>
<td style="text-align:center">S101202</td>
<td style="text-align:center">李祥</td>
<td style="text-align:center">男</td>
<td style="text-align:left">21</td>
<td style="text-align:center">信息系</td>
</tr>
<tr>
<td style="text-align:center">S101203</td>
<td style="text-align:center">孙渝研</td>
<td style="text-align:center">男</td>
<td style="text-align:left">20</td>
<td style="text-align:center">信息系</td>
</tr>
<tr>
<td style="text-align:center">S101204</td>
<td style="text-align:center">赵艳</td>
<td style="text-align:center">女</td>
<td style="text-align:left">18</td>
<td style="text-align:center">信息系</td>
</tr>
<tr>
<td style="text-align:center">S101205</td>
<td style="text-align:center">刘唯</td>
<td style="text-align:center">女</td>
<td style="text-align:left">19</td>
<td style="text-align:center">信息系</td>
</tr>
<tr>
<td style="text-align:center">S101206</td>
<td style="text-align:center">林玉霞</td>
<td style="text-align:center">女</td>
<td style="text-align:left">20</td>
<td style="text-align:center">信息系</td>
</tr>
<tr>
<td style="text-align:center">S101207</td>
<td style="text-align:center">王江</td>
<td style="text-align:center">男</td>
<td style="text-align:left">21</td>
<td style="text-align:center">信息系</td>
</tr>
<tr>
<td style="text-align:center">S101301</td>
<td style="text-align:center">王成</td>
<td style="text-align:center">男</td>
<td style="text-align:left">20</td>
<td style="text-align:center">会计系</td>
</tr>
<tr>
<td style="text-align:center">S101302</td>
<td style="text-align:center">张平安</td>
<td style="text-align:center">男</td>
<td style="text-align:left">18</td>
<td style="text-align:center">会计系</td>
</tr>
<tr>
<td style="text-align:center">S101401</td>
<td style="text-align:center">钟琴</td>
<td style="text-align:center">女</td>
<td style="text-align:left">19</td>
<td style="text-align:center">会计系</td>
</tr>
<tr>
<td style="text-align:center">S101402</td>
<td style="text-align:center">吴娟娟</td>
<td style="text-align:center">女</td>
<td style="text-align:left">21</td>
<td style="text-align:center">会计系</td>
</tr>
<tr>
<td style="text-align:center">S101403</td>
<td style="text-align:center">李月</td>
<td style="text-align:center">女</td>
<td style="text-align:left">22</td>
<td style="text-align:center">会计系</td>
</tr>
<tr>
<td style="text-align:center">S101404</td>
<td style="text-align:center">陈名军</td>
<td style="text-align:center">男</td>
<td style="text-align:left">23</td>
<td style="text-align:center">会计系</td>
</tr>
<tr>
<td style="text-align:center">S101405</td>
<td style="text-align:center">赵艳</td>
<td style="text-align:center">女</td>
<td style="text-align:left">21</td>
<td style="text-align:center">会计系</td>
</tr>
</tbody>
</table>
<p>表6.2课程关系</p>
<table>
<thead>
<tr>
<th style="text-align:center">课程号</th>
<th style="text-align:center">课程名</th>
<th style="text-align:center">开课学期</th>
<th style="text-align:center">学分</th>
<th style="text-align:center">教师号</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">101</td>
<td style="text-align:center">计算机基础</td>
<td style="text-align:center">1</td>
<td style="text-align:center">3</td>
<td style="text-align:center">T1</td>
</tr>
<tr>
<td style="text-align:center">102</td>
<td style="text-align:center">体育</td>
<td style="text-align:center">2</td>
<td style="text-align:center">4</td>
<td style="text-align:center">T2</td>
</tr>
<tr>
<td style="text-align:center">201</td>
<td style="text-align:center">英语</td>
<td style="text-align:center">1</td>
<td style="text-align:center">4</td>
<td style="text-align:center">T3</td>
</tr>
<tr>
<td style="text-align:center">202</td>
<td style="text-align:center">大学语文</td>
<td style="text-align:center">3</td>
<td style="text-align:center">4</td>
<td style="text-align:center">T4</td>
</tr>
<tr>
<td style="text-align:center">305</td>
<td style="text-align:center">操作系统</td>
<td style="text-align:center">4</td>
<td style="text-align:center">4</td>
<td style="text-align:center">T5</td>
</tr>
<tr>
<td style="text-align:center">304</td>
<td style="text-align:center">计算机原理</td>
<td style="text-align:center">4</td>
<td style="text-align:center">4</td>
<td style="text-align:center">T5</td>
</tr>
<tr>
<td style="text-align:center">301</td>
<td style="text-align:center">计算机网络</td>
<td style="text-align:center">3</td>
<td style="text-align:center">3</td>
<td style="text-align:center">T6</td>
</tr>
<tr>
<td style="text-align:center">302</td>
<td style="text-align:center">电子技术</td>
<td style="text-align:center">3</td>
<td style="text-align:center">4</td>
<td style="text-align:center">T6</td>
</tr>
<tr>
<td style="text-align:center">303</td>
<td style="text-align:center">数据库应用</td>
<td style="text-align:center">4</td>
<td style="text-align:center">3</td>
<td style="text-align:center">T7</td>
</tr>
</tbody>
</table>
<p>表6.3 选课关系</p>
<table>
<thead>
<tr>
<th style="text-align:center">学号</th>
<th style="text-align:center">课程号</th>
<th style="text-align:center">成绩</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">S101101</td>
<td style="text-align:center">101</td>
<td style="text-align:center">60</td>
</tr>
<tr>
<td style="text-align:center">S101101</td>
<td style="text-align:center">102</td>
<td style="text-align:center">83</td>
</tr>
<tr>
<td style="text-align:center">S101101</td>
<td style="text-align:center">201</td>
<td style="text-align:center">78</td>
</tr>
<tr>
<td style="text-align:center">S101101</td>
<td style="text-align:center">305</td>
<td style="text-align:center">79</td>
</tr>
<tr>
<td style="text-align:center">S101101</td>
<td style="text-align:center">202</td>
<td style="text-align:center">87</td>
</tr>
<tr>
<td style="text-align:center">S101101</td>
<td style="text-align:center">304</td>
<td style="text-align:center">89</td>
</tr>
<tr>
<td style="text-align:center">S101101</td>
<td style="text-align:center">303</td>
<td style="text-align:center">64</td>
</tr>
<tr>
<td style="text-align:center">S101101</td>
<td style="text-align:center">302</td>
<td style="text-align:center">90</td>
</tr>
<tr>
<td style="text-align:center">S101102</td>
<td style="text-align:center">101</td>
<td style="text-align:center">84</td>
</tr>
<tr>
<td style="text-align:center">S101101</td>
<td style="text-align:center">301</td>
<td style="text-align:center">83</td>
</tr>
<tr>
<td style="text-align:center">S101102</td>
<td style="text-align:center">102</td>
<td style="text-align:center">75</td>
</tr>
<tr>
<td style="text-align:center">S101102</td>
<td style="text-align:center">202</td>
<td style="text-align:center">86</td>
</tr>
<tr>
<td style="text-align:center">S101102</td>
<td style="text-align:center">303</td>
<td style="text-align:center">67</td>
</tr>
<tr>
<td style="text-align:center">S101201</td>
<td style="text-align:center">101</td>
<td style="text-align:center">78</td>
</tr>
<tr>
<td style="text-align:center">S101201</td>
<td style="text-align:center">102</td>
<td style="text-align:center">72</td>
</tr>
<tr>
<td style="text-align:center">S101201</td>
<td style="text-align:center">303</td>
<td style="text-align:center">76</td>
</tr>
<tr>
<td style="text-align:center">S101201</td>
<td style="text-align:center">201</td>
<td style="text-align:center">50</td>
</tr>
<tr>
<td style="text-align:center">S101301</td>
<td style="text-align:center">101</td>
<td style="text-align:center">90</td>
</tr>
<tr>
<td style="text-align:center">S101302</td>
<td style="text-align:center">101</td>
<td style="text-align:center">90</td>
</tr>
<tr>
<td style="text-align:center">S101302</td>
<td style="text-align:center">303</td>
<td style="text-align:center">83</td>
</tr>
</tbody>
</table>
<p>表6.4教师表</p>
<table>
<thead>
<tr>
<th style="text-align:center">教师号</th>
<th style="text-align:center">姓名</th>
<th style="text-align:center">职称</th>
<th style="text-align:center">部门</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">T1</td>
<td style="text-align:center">胡美丽</td>
<td style="text-align:center">讲师</td>
<td style="text-align:center">公共教学</td>
</tr>
<tr>
<td style="text-align:center">T2</td>
<td style="text-align:center">王珊珊</td>
<td style="text-align:center">讲师</td>
<td style="text-align:center">公共教学</td>
</tr>
<tr>
<td style="text-align:center">T3</td>
<td style="text-align:center">王新</td>
<td style="text-align:center">讲师</td>
<td style="text-align:center">公共教学</td>
</tr>
<tr>
<td style="text-align:center">T4</td>
<td style="text-align:center">李再敏</td>
<td style="text-align:center">副教授</td>
<td style="text-align:center">公共教学</td>
</tr>
<tr>
<td style="text-align:center">T5</td>
<td style="text-align:center">李红玉</td>
<td style="text-align:center">教授</td>
<td style="text-align:center">计算机系</td>
</tr>
<tr>
<td style="text-align:center">T6</td>
<td style="text-align:center">周进</td>
<td style="text-align:center">助教</td>
<td style="text-align:center">计算机系</td>
</tr>
<tr>
<td style="text-align:center">T7</td>
<td style="text-align:center">张丽丽</td>
<td style="text-align:center">助教</td>
<td style="text-align:center">计算机系</td>
</tr>
<tr>
<td style="text-align:center">T8</td>
<td style="text-align:center">王晓舟</td>
<td style="text-align:center">副教授</td>
<td style="text-align:center">计算机系</td>
</tr>
<tr>
<td style="text-align:center">T9</td>
<td style="text-align:center">周樱</td>
<td style="text-align:center">讲师</td>
<td style="text-align:center">信息系</td>
</tr>
</tbody>
</table>
<ol>
<li>查询“101”课程成绩比“102”课程成绩高的所有学生的学号。
提示：
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> a.学号</span><br><span class="line"><span class="keyword">From</span> (<span class="keyword">select</span> 学号,成绩 <span class="keyword">from</span> xkgx <span class="keyword">where</span> 课程号=<span class="string">'101'</span>) a,</span><br><span class="line">(<span class="keyword">select</span> 学号,成绩</span><br><span class="line"><span class="keyword">from</span> xkgx <span class="keyword">where</span> 课程号=<span class="string">'102'</span>) b</span><br><span class="line"><span class="keyword">where</span> a.成绩&gt;b.成绩 <span class="keyword">and</span> a.学号=b.学号</span><br></pre></td></tr></table></figure></li>
</ol>
<p>自然连接：
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> a.学号</span><br><span class="line"><span class="keyword">from</span> xkgx a <span class="keyword">join</span> xkgx b <span class="keyword">on</span> a.学号=b.学号</span><br><span class="line"><span class="keyword">where</span> a.课程号=<span class="string">'101'</span> <span class="keyword">and</span> b.课程号=<span class="string">'102'</span> </span><br><span class="line"><span class="keyword">and</span> a.成绩&gt;b.成绩</span><br></pre></td></tr></table></figure></p>
<ol start="2">
<li>
<p>查询全部选修课程表中所有课的同学的学号、姓名。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 学号,姓名</span><br><span class="line"><span class="keyword">from</span> xsgx</span><br><span class="line"><span class="keyword">where</span> 学号 <span class="keyword">in</span></span><br><span class="line">(<span class="keyword">select</span> 学号 <span class="keyword">from</span> xkgx <span class="keyword">group</span> <span class="keyword">by</span> 学号 </span><br><span class="line"> <span class="keyword">having</span> <span class="keyword">count</span>(课程号)=</span><br><span class="line">(<span class="keyword">select</span> <span class="keyword">count</span>(课程号) <span class="keyword">from</span> kcgx))</span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>查询哪些老师没有教授任何课程。列出老师的全部列。（<code>not in</code>和<code>not EXISTS</code>两种方式实现）。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> *</span><br><span class="line"><span class="keyword">from</span> js</span><br><span class="line"><span class="keyword">where</span> 教师号 <span class="keyword">not</span> <span class="keyword">in</span></span><br><span class="line">(<span class="keyword">select</span> 教师号 <span class="keyword">from</span> xkgx <span class="keyword">join</span> kcgx <span class="keyword">on</span> </span><br><span class="line">xkgx.课程号=kcgx.课程号)</span><br></pre></td></tr></table></figure></p>
</li>
</ol>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> *</span><br><span class="line"><span class="keyword">from</span> js</span><br><span class="line"><span class="keyword">where</span> 教师号 <span class="keyword">not</span> <span class="keyword">in</span> </span><br><span class="line">(<span class="keyword">select</span> 教师号 <span class="keyword">from</span> kcgx </span><br><span class="line"><span class="keyword">where</span> kcgx.教师号=jsgx.教师号)</span><br></pre></td></tr></table></figure></p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> *</span><br><span class="line"><span class="keyword">from</span> js</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span></span><br><span class="line">(<span class="keyword">select</span> <span class="keyword">distinct</span> js.教师号  </span><br><span class="line"><span class="keyword">from</span> kcgx </span><br><span class="line"><span class="keyword">where</span> kcgx.教师号=js.教师号)</span><br></pre></td></tr></table></figure></p>
<ol start="4">
<li>查询出只选修了一门课程的学生的学号和姓名。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> xsgx.学号,xsgx.姓名</span><br><span class="line"><span class="keyword">from</span> xsgx</span><br><span class="line"><span class="keyword">where</span> xsgx.学号 <span class="keyword">in</span></span><br><span class="line">(<span class="keyword">select</span> xkgx.学号 <span class="keyword">from</span> xkgx </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> xkgx.学号 </span><br><span class="line"><span class="keyword">having</span> <span class="keyword">count</span>(xkgx.课程号)=<span class="number">1</span>)</span><br></pre></td></tr></table></figure></li>
</ol>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> xsgx.学号,姓名</span><br><span class="line"><span class="keyword">from</span> xsgx <span class="keyword">join</span> xkgx <span class="keyword">on</span> xsgx.学号=xkgxx.学号</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> xsgx.学号,xsgx.姓名</span><br><span class="line"><span class="keyword">having</span> <span class="keyword">count</span>(xkgx.课程号)=<span class="number">1</span></span><br></pre></td></tr></table></figure></p>
<ol start="5">
<li>查询张丽丽老师教过的学生的学号、姓名。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> xsgx.学号,xsgx.姓名</span><br><span class="line"><span class="keyword">from</span> xsgx</span><br><span class="line"><span class="keyword">where</span> kcgx.课程号 <span class="keyword">in</span></span><br><span class="line">(<span class="keyword">select</span> 课程号 <span class="keyword">from</span> xkgx</span><br><span class="line"><span class="keyword">where</span> kcgx.教师号 <span class="keyword">in</span>(</span><br><span class="line"><span class="keyword">select</span> js.教师号</span><br><span class="line"><span class="keyword">from</span> js</span><br><span class="line"><span class="keyword">where</span> js.姓名=<span class="string">'张丽丽'</span>)</span><br></pre></td></tr></table></figure></li>
</ol>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> xsgx.学号,xsgx.姓名</span><br><span class="line"><span class="keyword">from</span> xsgx,kcgx,xkgx,js</span><br><span class="line"><span class="keyword">where</span> xsgx.学号=xkgx.学号 </span><br><span class="line"><span class="keyword">and</span> </span><br><span class="line">kcgx.课程号=xkgx.课程号 </span><br><span class="line"><span class="keyword">and</span></span><br><span class="line">js.教师号=kcgx.教师号</span><br><span class="line"><span class="keyword">and</span> </span><br><span class="line">js.姓名=<span class="string">'张丽丽'</span></span><br></pre></td></tr></table></figure></p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> sxgx.学号,s.姓名</span><br><span class="line"><span class="keyword">from</span> js <span class="keyword">join</span> kcgx <span class="keyword">on</span> js.教师号=kcgx.教师号</span><br><span class="line"><span class="keyword">join</span> xkgx <span class="keyword">on</span> kcgx.课程号=xkgx.课程号</span><br><span class="line"><span class="keyword">join</span> xsgx <span class="keyword">on</span> xkgx.学号=xsgx.学号</span><br><span class="line"><span class="keyword">where</span> t.姓名=<span class="string">'张丽丽'</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> xsgx.学号,xsgx.姓名</span><br></pre></td></tr></table></figure></p>
<ol start="6">
<li>
<p>查询相同姓名的学生，列出相同的姓名及相应的同名人数。（有几个学生同名）
提示：考虑按姓名分组，分组内元组的个数。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> *</span><br><span class="line"><span class="keyword">from</span> xsgx</span><br><span class="line"><span class="keyword">where</span> 姓名 <span class="keyword">in</span>(<span class="keyword">select</span> 姓名 <span class="keyword">from</span> xsgx</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> 姓名</span><br><span class="line"><span class="keyword">having</span> <span class="keyword">count</span>(*)&gt;<span class="number">1</span>)</span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>查询每门功成绩最好的前两名。</p>
</li>
</ol>
<p>提示：</p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> t1.学号,t1.课程号,成绩</span><br><span class="line"><span class="keyword">FROM</span> 选课 t1</span><br><span class="line"><span class="keyword">WHERE</span> 成绩 <span class="keyword">IN</span> (<span class="keyword">SELECT</span> TOP <span class="number">2</span> 成绩</span><br><span class="line"><span class="keyword">FROM</span> 选课</span><br><span class="line"><span class="keyword">WHERE</span> 课程号= t1.课程号</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> 成绩 <span class="keyword">DESC</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> t1.学号,t1.课程号,成绩</span><br><span class="line"><span class="keyword">FROM</span> xkgx t1</span><br><span class="line"><span class="keyword">WHERE</span> 成绩 <span class="keyword">IN</span> (<span class="keyword">SELECT</span> TOP <span class="number">2</span> 成绩</span><br><span class="line"><span class="keyword">FROM</span> xkgx</span><br><span class="line"><span class="keyword">WHERE</span> 课程号= t1.课程号</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> 成绩 <span class="keyword">DESC</span>)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> 课程号 <span class="keyword">DESC</span></span><br></pre></td></tr></table></figure></p>
<p>这道题每次父亲查询都提供课程号的值给子查询，其子查询的功能就是计算父查询对应课程的前两名。</p>
<ol start="8">
<li>查询学过“101”并且也学过编号“102”课程的同学的学号、姓名。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> xsgx.学号,xsgx.姓名</span><br><span class="line"><span class="keyword">from</span> xsgx</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> xkgx.学号</span><br><span class="line"><span class="keyword">where</span> 学号 <span class="keyword">in</span> (<span class="keyword">select</span> 学号 <span class="keyword">from</span> xkgx</span><br><span class="line"><span class="keyword">where</span> 课程号=<span class="string">'101'</span>)</span><br><span class="line"><span class="keyword">and</span> 学号 <span class="keyword">in</span> (<span class="keyword">select</span> 学号 <span class="keyword">from</span> xkgx</span><br><span class="line"><span class="keyword">where</span> 课程号=<span class="string">'102'</span>)</span><br></pre></td></tr></table></figure></li>
</ol>
<p>9.查询没有选修课程表中所有课的同学的学号、姓名。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> xsgx.学号,xsgx.姓名</span><br><span class="line"><span class="keyword">from</span> xsgx</span><br><span class="line"><span class="keyword">where</span> 学号 <span class="keyword">in</span></span><br><span class="line">(<span class="keyword">select</span> 学号 <span class="keyword">from</span> xkgx </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> 学号</span><br><span class="line"><span class="keyword">having</span> <span class="keyword">count</span>(课程号)&lt;(<span class="keyword">select</span> <span class="keyword">count</span>(课程号) <span class="keyword">from</span> kcgx))</span><br></pre></td></tr></table></figure></p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> xsgx.学号,xsgx.姓名</span><br><span class="line"><span class="keyword">from</span> xsgx <span class="keyword">join</span> xkgx <span class="keyword">on</span> xsgx.学号=xkgx.学号</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> xsgx.学号,xkgx.姓名</span><br><span class="line"><span class="keyword">having</span> <span class="keyword">count</span>(kcgs.课程号)&lt;</span><br><span class="line">(<span class="keyword">select</span> <span class="keyword">count</span> (课程号) <span class="keyword">from</span> kcgx )</span><br></pre></td></tr></table></figure></p>
<p>或者
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> kcgx.学号,xsgx.姓名</span><br><span class="line"><span class="keyword">from</span> xkgx <span class="keyword">join</span> xsgx <span class="keyword">on</span> xkgx.学号=xsgx.学号</span><br><span class="line"><span class="keyword">where</span> xkgx.学号 <span class="keyword">not</span> <span class="keyword">in</span></span><br><span class="line">(<span class="keyword">select</span> 学号 <span class="keyword">from</span> xkgx</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> 学号</span><br><span class="line"><span class="keyword">having</span> <span class="keyword">count</span>(课程号) =</span><br><span class="line">(<span class="keyword">select</span> <span class="keyword">count</span> (课程号) <span class="keyword">from</span> kcgx))</span><br></pre></td></tr></table></figure></p>
<p>10.查询全部学生都选修过的课程对应的课程号和课程名。
提示：
意味着该课程的选课人数与学生总人数相等。考虑按课程号分组，查询哪个分组中学号的个数与学生个数相等，得到这样的分组它的课程号。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> kcgx.课程号,kcgx.课程名</span><br><span class="line"><span class="keyword">from</span> kcgx</span><br><span class="line"><span class="keyword">where</span> 课程号 <span class="keyword">in</span></span><br><span class="line">(<span class="keyword">select</span> 课程号 <span class="keyword">from</span> xkgx </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> 课程号 </span><br><span class="line"><span class="keyword">having</span> <span class="keyword">count</span>(学号)=</span><br><span class="line">(<span class="keyword">select</span> <span class="keyword">count</span>(学号) <span class="keyword">from</span> xsgx))</span><br></pre></td></tr></table></figure></p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 课程名,课程号</span><br><span class="line"><span class="keyword">from</span> kcgx</span><br><span class="line"><span class="keyword">where</span> kcgx.课程号 <span class="keyword">in</span> (<span class="keyword">select</span> 课程号</span><br><span class="line"><span class="keyword">from</span> xkgx</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> 课程号</span><br><span class="line"><span class="keyword">having</span> <span class="keyword">count</span>(学号) =</span><br><span class="line">(<span class="keyword">select</span> <span class="keyword">count</span>(学号)<span class="keyword">from</span> xsgx))</span><br></pre></td></tr></table></figure></p>
<p>11.查询没学过“李红玉”老师讲授的任一门课程的学生姓名。（not in不相关即可实现）</p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 姓名</span><br><span class="line"><span class="keyword">from</span> xsgx</span><br><span class="line"><span class="keyword">where</span> 学号 <span class="keyword">not</span> <span class="keyword">in</span></span><br><span class="line">(<span class="keyword">select</span> 学号 <span class="keyword">from</span> xkgx,js,kcgx </span><br><span class="line"><span class="keyword">where</span> xkgx.课程号=kcgx.课程号 </span><br><span class="line"><span class="keyword">and</span></span><br><span class="line">kcgx.教师号=js.教师号 </span><br><span class="line"><span class="keyword">and</span> </span><br><span class="line">js.姓名=<span class="string">'李红玉'</span>)</span><br></pre></td></tr></table></figure></p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 姓名</span><br><span class="line"><span class="keyword">from</span> xsgx</span><br><span class="line"><span class="keyword">where</span> 学号 <span class="keyword">not</span> <span class="keyword">in</span></span><br><span class="line">(<span class="keyword">select</span> 学号 <span class="keyword">from</span> xkgx </span><br><span class="line"><span class="keyword">join</span> kcgx <span class="keyword">on</span> xkgx.课程号=kcgx.课程号</span><br><span class="line"><span class="keyword">join</span> t <span class="keyword">on</span> kcgx.教师号=xkgx.教师号</span><br><span class="line"><span class="keyword">where</span> 姓名=<span class="string">'李红玉'</span>)</span><br></pre></td></tr></table></figure></p>
<h1>实验七   视图与索引</h1>
<p>实验日期：</p>
<h2>实验目标：</h2>
<p>（1）掌握创建视图、删除视图；</p>
<p>（2）查询视图。</p>
<p>（3）更新视图、修改视图对应的数据。</p>
<p>（4）理解索引的概念和索引的作用，学会使用索引。</p>
<p>（5）了解聚簇索引和非聚簇索引。</p>
<h2>实验内容：</h2>
<p>假设“学生选课”数据库中有3个基本表（关系）：</p>
<p>学生关系：学生（学号，姓名，性别，所在系）</p>
<p>课程关系：课程（课程号，课程名，开课学期，教师号）</p>
<p>选课关系：选课（学号，课程号，成绩）</p>
<p>每个关系的当前值分别如表所示。</p>
<p>打开对象资源管理器，创建一个名为”学生选课”的数据库，在该数据库中导入以下的</p>
<p>表7.1—7.3。
表7.1 学生关系</p>
<table>
<thead>
<tr>
<th style="text-align:center">学号</th>
<th style="text-align:center">姓名</th>
<th style="text-align:center">性别</th>
<th style="text-align:center">年龄</th>
<th style="text-align:center">所在系</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">S101101</td>
<td style="text-align:center">陈名军</td>
<td style="text-align:center">男</td>
<td style="text-align:center">18</td>
<td style="text-align:center">计算机系</td>
</tr>
<tr>
<td style="text-align:center">S101102</td>
<td style="text-align:center">吴小晴</td>
<td style="text-align:center">女</td>
<td style="text-align:center">19</td>
<td style="text-align:center">计算机系</td>
</tr>
<tr>
<td style="text-align:center">S101103</td>
<td style="text-align:center">王明燕</td>
<td style="text-align:center">女</td>
<td style="text-align:center">19</td>
<td style="text-align:center">计算机系</td>
</tr>
<tr>
<td style="text-align:center">S101104</td>
<td style="text-align:center">严利</td>
<td style="text-align:center">男</td>
<td style="text-align:center">20</td>
<td style="text-align:center">计算机系</td>
</tr>
<tr>
<td style="text-align:center">S101105</td>
<td style="text-align:center">朱欣</td>
<td style="text-align:center">男</td>
<td style="text-align:center">20</td>
<td style="text-align:center">计算机系</td>
</tr>
<tr>
<td style="text-align:center">S101201</td>
<td style="text-align:center">李国庆</td>
<td style="text-align:center">男</td>
<td style="text-align:center">21</td>
<td style="text-align:center">信息系</td>
</tr>
<tr>
<td style="text-align:center">S101202</td>
<td style="text-align:center">李祥</td>
<td style="text-align:center">男</td>
<td style="text-align:center">21</td>
<td style="text-align:center">信息系</td>
</tr>
<tr>
<td style="text-align:center">S101203</td>
<td style="text-align:center">孙渝研</td>
<td style="text-align:center">男</td>
<td style="text-align:center">20</td>
<td style="text-align:center">信息系</td>
</tr>
<tr>
<td style="text-align:center">S101204</td>
<td style="text-align:center">赵艳</td>
<td style="text-align:center">女</td>
<td style="text-align:center">18</td>
<td style="text-align:center">信息系</td>
</tr>
<tr>
<td style="text-align:center">S101205</td>
<td style="text-align:center">刘唯</td>
<td style="text-align:center">女</td>
<td style="text-align:center">19</td>
<td style="text-align:center">信息系</td>
</tr>
<tr>
<td style="text-align:center">S101206</td>
<td style="text-align:center">林玉霞</td>
<td style="text-align:center">女</td>
<td style="text-align:center">20</td>
<td style="text-align:center">信息系</td>
</tr>
<tr>
<td style="text-align:center">S101207</td>
<td style="text-align:center">王江</td>
<td style="text-align:center">男</td>
<td style="text-align:center">21</td>
<td style="text-align:center">信息系</td>
</tr>
<tr>
<td style="text-align:center">S101301</td>
<td style="text-align:center">王成</td>
<td style="text-align:center">男</td>
<td style="text-align:center">20</td>
<td style="text-align:center">会计系</td>
</tr>
<tr>
<td style="text-align:center">S101302</td>
<td style="text-align:center">张平安</td>
<td style="text-align:center">男</td>
<td style="text-align:center">18</td>
<td style="text-align:center">会计系</td>
</tr>
<tr>
<td style="text-align:center">S101401</td>
<td style="text-align:center">钟琴</td>
<td style="text-align:center">女</td>
<td style="text-align:center">19</td>
<td style="text-align:center">会计系</td>
</tr>
<tr>
<td style="text-align:center">S101402</td>
<td style="text-align:center">吴娟娟</td>
<td style="text-align:center">女</td>
<td style="text-align:center">21</td>
<td style="text-align:center">会计系</td>
</tr>
<tr>
<td style="text-align:center">S101403</td>
<td style="text-align:center">李月</td>
<td style="text-align:center">女</td>
<td style="text-align:center">22</td>
<td style="text-align:center">会计系</td>
</tr>
<tr>
<td style="text-align:center">S101404</td>
<td style="text-align:center">陈名军</td>
<td style="text-align:center">男</td>
<td style="text-align:center">23</td>
<td style="text-align:center">会计系</td>
</tr>
<tr>
<td style="text-align:center">S101405</td>
<td style="text-align:center">赵艳</td>
<td style="text-align:center">女</td>
<td style="text-align:center">21</td>
<td style="text-align:center">会计系</td>
</tr>
</tbody>
</table>
<p>表7.2课程关系</p>
<table>
<thead>
<tr>
<th style="text-align:center">课程号</th>
<th style="text-align:center">课程名</th>
<th style="text-align:center">开课学期</th>
<th style="text-align:center">学分</th>
<th style="text-align:center">教师号</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">101</td>
<td style="text-align:center">计算机基础</td>
<td style="text-align:center">1</td>
<td style="text-align:center">3</td>
<td style="text-align:center">T1</td>
</tr>
<tr>
<td style="text-align:center">102</td>
<td style="text-align:center">体育</td>
<td style="text-align:center">2</td>
<td style="text-align:center">4</td>
<td style="text-align:center">T2</td>
</tr>
<tr>
<td style="text-align:center">201</td>
<td style="text-align:center">英语</td>
<td style="text-align:center">1</td>
<td style="text-align:center">4</td>
<td style="text-align:center">T3</td>
</tr>
<tr>
<td style="text-align:center">202</td>
<td style="text-align:center">大学语文</td>
<td style="text-align:center">3</td>
<td style="text-align:center">4</td>
<td style="text-align:center">T4</td>
</tr>
<tr>
<td style="text-align:center">305</td>
<td style="text-align:center">操作系统</td>
<td style="text-align:center">4</td>
<td style="text-align:center">4</td>
<td style="text-align:center">T5</td>
</tr>
<tr>
<td style="text-align:center">304</td>
<td style="text-align:center">计算机原理</td>
<td style="text-align:center">4</td>
<td style="text-align:center">4</td>
<td style="text-align:center">T5</td>
</tr>
<tr>
<td style="text-align:center">301</td>
<td style="text-align:center">计算机网络</td>
<td style="text-align:center">3</td>
<td style="text-align:center">3</td>
<td style="text-align:center">T6</td>
</tr>
<tr>
<td style="text-align:center">302</td>
<td style="text-align:center">电子技术</td>
<td style="text-align:center">3</td>
<td style="text-align:center">4</td>
<td style="text-align:center">T6</td>
</tr>
<tr>
<td style="text-align:center">303</td>
<td style="text-align:center">数据库应用</td>
<td style="text-align:center">4</td>
<td style="text-align:center">3</td>
<td style="text-align:center">T7</td>
</tr>
</tbody>
</table>
<p>表7.3 选课关系</p>
<table>
<thead>
<tr>
<th style="text-align:center">学号</th>
<th style="text-align:center">课程号</th>
<th style="text-align:center">成绩</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">S101101</td>
<td style="text-align:center">102</td>
<td style="text-align:center">83</td>
</tr>
<tr>
<td style="text-align:center">S101101</td>
<td style="text-align:center">101</td>
<td style="text-align:center">60</td>
</tr>
<tr>
<td style="text-align:center">S101101</td>
<td style="text-align:center">201</td>
<td style="text-align:center">78</td>
</tr>
<tr>
<td style="text-align:center">S101101</td>
<td style="text-align:center">202</td>
<td style="text-align:center">87</td>
</tr>
<tr>
<td style="text-align:center">S101101</td>
<td style="text-align:center">305</td>
<td style="text-align:center">79</td>
</tr>
<tr>
<td style="text-align:center">S101101</td>
<td style="text-align:center">304</td>
<td style="text-align:center">89</td>
</tr>
<tr>
<td style="text-align:center">S101101</td>
<td style="text-align:center">303</td>
<td style="text-align:center">64</td>
</tr>
<tr>
<td style="text-align:center">S101101</td>
<td style="text-align:center">302</td>
<td style="text-align:center">90</td>
</tr>
<tr>
<td style="text-align:center">S101101</td>
<td style="text-align:center">301</td>
<td style="text-align:center">83</td>
</tr>
<tr>
<td style="text-align:center">S101102</td>
<td style="text-align:center">101</td>
<td style="text-align:center">84</td>
</tr>
<tr>
<td style="text-align:center">S101102</td>
<td style="text-align:center">102</td>
<td style="text-align:center">75</td>
</tr>
<tr>
<td style="text-align:center">S101102</td>
<td style="text-align:center">202</td>
<td style="text-align:center">86</td>
</tr>
<tr>
<td style="text-align:center">S101102</td>
<td style="text-align:center">303</td>
<td style="text-align:center">67</td>
</tr>
<tr>
<td style="text-align:center">S101201</td>
<td style="text-align:center">101</td>
<td style="text-align:center">78</td>
</tr>
<tr>
<td style="text-align:center">S101201</td>
<td style="text-align:center">102</td>
<td style="text-align:center">72</td>
</tr>
<tr>
<td style="text-align:center">S101201</td>
<td style="text-align:center">303</td>
<td style="text-align:center">76</td>
</tr>
<tr>
<td style="text-align:center">S101201</td>
<td style="text-align:center">201</td>
<td style="text-align:center">50</td>
</tr>
<tr>
<td style="text-align:center">S101301</td>
<td style="text-align:center">101</td>
<td style="text-align:center">90</td>
</tr>
<tr>
<td style="text-align:center">S101302</td>
<td style="text-align:center">101</td>
<td style="text-align:center">90</td>
</tr>
<tr>
<td style="text-align:center">S101302</td>
<td style="text-align:center">303</td>
<td style="text-align:center">83</td>
</tr>
</tbody>
</table>
<p>用学生、课程、选课这三张表，利用SQL语句完成以下练习题。</p>
<p>（1）创建V1视图，学生的学号、姓名、所在系、课程号、课程名、课程学分的视图。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> V1	</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> xs.学号,姓名,所在系,xk.课程号,kc.课程名,学分</span><br><span class="line"><span class="keyword">from</span> xs </span><br><span class="line"><span class="keyword">join</span> xk <span class="keyword">on</span> xs.学号=xk.学号 </span><br><span class="line"><span class="keyword">join</span> kc <span class="keyword">on</span> xk.课程号=kc.课程号</span><br></pre></td></tr></table></figure></p>
<p>（2）创建V2视图，查个学生的平均成绩的视图，要求列出学生学号及平均成绩。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> V2</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> 学号,<span class="keyword">avg</span>(成绩) <span class="keyword">as</span> 平均成绩</span><br><span class="line"><span class="keyword">from</span> xk</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> 学号</span><br></pre></td></tr></table></figure></p>
<p>（3）创建V3视图，每个学生的修课学分的视图，要求列出学生学号及总学分。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> V3</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> 学号,<span class="keyword">sum</span>(学分) <span class="keyword">as</span> 总学分</span><br><span class="line"><span class="keyword">from</span> xk <span class="keyword">join</span>  kc <span class="keyword">on</span> xk.课程号=kc.课程号</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> 学号</span><br></pre></td></tr></table></figure></p>
<p>（4）上面的视图V3能否对其总学分对应的数据进行修改？
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> V3 <span class="keyword">set</span> 总学分=<span class="number">10</span> <span class="keyword">where</span> 学号=<span class="string">'S101101'</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> V3</span><br></pre></td></tr></table></figure></p>
<p>对视图或函数 'V3' 的更新或插入失败，因其包含派生域或常量域。</p>
<p>（5）创建V4视图，计算机系的学生基本信息的视图。该视图能否更新学生的姓名？（无需选课的信息）。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> V4</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> *</span><br><span class="line"><span class="keyword">from</span> xs</span><br><span class="line"><span class="keyword">where</span> 所在系=<span class="string">'计算机系'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">update</span> V4 <span class="keyword">set</span> 姓名=<span class="string">'陈大军'</span> </span><br><span class="line"><span class="keyword">where</span> 姓名=<span class="string">'陈名军'</span></span><br></pre></td></tr></table></figure></p>
<p>可以更新</p>
<p>（6）创建V5视图，每个学生获得的最高成绩，要求列出学号和最高成绩
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> V5</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> 学号,<span class="keyword">max</span>(成绩) <span class="keyword">as</span> 最高成绩</span><br><span class="line"><span class="keyword">from</span> xk</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> 学号</span><br></pre></td></tr></table></figure></p>
<p>（7）借助视图V5，实现该查询，对每个学生找出他获得最高成绩的课程号。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> V5.学号,课程号</span><br><span class="line"><span class="keyword">from</span> V5 <span class="keyword">join</span> xk <span class="keyword">on</span> V5.学号=xk.学号</span><br><span class="line"><span class="keyword">where</span> 成绩=top <span class="number">1</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> xk.课程号</span><br></pre></td></tr></table></figure></p>
<p>（8）删除视图V1。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">view</span> V1</span><br></pre></td></tr></table></figure></p>
<p>（9）为学生关系的姓名列创建一个非聚簇索引。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> nonclustered <span class="keyword">index</span> 非聚簇索引 <span class="keyword">on</span> xs(姓名)</span><br></pre></td></tr></table></figure></p>
<p>（10）为课程表的课程名创建一个聚簇索引。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> clustered <span class="keyword">index</span> 聚簇索引 <span class="keyword">on</span> kc(课程名)</span><br></pre></td></tr></table></figure></p>
<h2>简答题</h2>
<ol>
<li>视图可以加快数据的查询速度，这句话对吗？为什么？</li>
</ol>
<ul>
<li>不对，因为通过视图查询数据时，比直接针对基本表查询数据多了一个转换过程，即从外模式到模式的转换。</li>
</ul>
<ol start="2">
<li>视图可以简化查询，这句话对吗？为什么？</li>
</ol>
<ul>
<li>对，简化操作</li>
</ul>
<ol start="3">
<li>视图是一个虚表，数据库中只存放视图的定义，而不存放视图包含的数据，这些数据仍存放在原来基本表中。这句话对吗？</li>
</ol>
<ul>
<li>对</li>
</ul>
<ol start="4">
<li>基本表中的数据如果发生变化，视图中查询出数据也随之变化。这句话对吗？</li>
</ol>
<ul>
<li>对</li>
</ul>
<ol start="5">
<li>索引是否越多越好？</li>
</ol>
<ul>
<li>否</li>
<li>索引需要在内存和物理磁盘驱动器上使用更多的存储空间。在执行插入声明的过程中可能会在一定程度上导致系统性能的下降，因为在插入数据的时候是需要根据索引的顺序插入，而不是在第一个可用的位置直接插入数据，这样一来，存在的索引越多将导致插入或者更新声明所需要的时间就越多。</li>
<li>1)索引影响DML操作,任何DML操作都要更新INDEX, 这是代价。</li>
<li>2)任何方便都是有代价的，select的时候方便，insert、update、delete的时候就要维护index。</li>
<li>3)索引多了, 执行计划的制定要费更多的资源。</li>
<li>4)创建和维护索引是有成本的。</li>
<li>5)索引能够极大的提高数据检索效率，也能够改善排序分组操作的性能，但是我们不能忽略的 一个问题就  是索引是完全独立于基础数据之外的一部分数据。</li>
</ul>
<ol start="6">
<li>哪些视图不能更新？</li>
</ol>
<ul>
<li>若视图的属性来自集函数、表达式，则该视图肯定是不可以更新的</li>
<li>若视图是由两个以上基本表导出的，则次视图不允许更新。-- 若视图的字段来自字段表达式或常数，则不允许对此视图执行INSERT和UPDATE操作，但允许执行DELETE操作。</li>
<li>若视图的字段来自集函数，则此视图不允许更新。</li>
<li>若视图定义中含有GROUP BY子句，则此视图不允许更新若视图中含有DISTINCT短语，则此视图不允许更新</li>
<li>若视图定义中有嵌套查询，并且内层查询FROM子句中涉及的表也是导出该视图的基本表，则此视图不允许更新。</li>
<li>一个不允许更新的视图上定义的视图也不允许更新。</li>
</ul>
<ol start="7">
<li>聚簇索引和非聚簇索引有何区别，为什么每个表只能有一个聚簇索引？</li>
</ol>
<p>答：聚集索引是一种稀疏索引，数据页上一级的索引页存储的是页指针，而不是行指针。而对于非聚集索引，则是密集索引，在数据页的上一级索引页它为每一个数据行存储一条索引记录。一个表只能有一个聚簇索引，因为数据一旦存储，顺序只能有一种。</p>
<ul>
<li>聚簇索引</li>
</ul>
<p>(1) 一个索引项直接对应实际数据记录的存储页，可谓“直达”</p>
<p>(2) 主键缺省使用它</p>
<p>(3) 索引项的排序和数据行的存储排序完全一致，利用这一点，想修改数据的存储顺序，可以通过改变主键的方法（撤销原有主键，另找也能满足主键要求的一个字段或一组字段，重建主键）</p>
<p>(4) 一个表只能有一个聚簇索引（理由：数据一旦存储，顺序只能有一种）</p>
<ul>
<li>非聚簇索引</li>
</ul>
<p>(1) 不能“直达”，可能链式地访问多级页表后，才能定位到数据页</p>
<p>(2)一个表可以有多个非聚簇索引</p>
<ul>
<li>聚簇索引的顺序就是数据的物理存储顺序，而对非聚簇索引的解释是:索引顺序与数据物理排列顺序无关。正式因为如此，所以一个表最多只能有一个聚簇索引。</li>
</ul>
<h1>实验八   数据操作</h1>
<p>实验日期：</p>
<h2>实验目标：</h2>
<p>（1）掌握插入数据到表中。</p>
<p>（2）掌握删除表中的数据。</p>
<p>（3）掌握修改表中的数据。</p>
<h2>实验内容：</h2>
<p>建立一个名叫“仓库职工”的数据库，接下来请利用实验五的数据，将表中的数据导入到“仓库职工”数据库中。用T-SQL语句完成以下练习题。</p>
<ol>
<li>查询每个城市的仓库的总面积，将查询的结果插入到新表t1中，该表需要自己创建。
创建表t1的代码如下：
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Create</span> <span class="keyword">table</span> t1</span><br><span class="line">(cityname <span class="built_in">char</span>(<span class="number">20</span>),</span><br><span class="line">Sumarea <span class="built_in">int</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure></li>
</ol>
<p>运行代码创建了表t1。
接下来向t1中插入数据，其中数据为某个子查询的结果。代码提示如下：</p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Insert</span> <span class="keyword">into</span> t1</span><br><span class="line"><span class="keyword">Select</span> 城市,<span class="keyword">sum</span>(面积)</span><br><span class="line"><span class="keyword">From</span> 仓库</span><br><span class="line"><span class="keyword">Group</span> <span class="keyword">by</span> 城市</span><br></pre></td></tr></table></figure></p>
<ol start="2">
<li>
<p>插入一个新的供应商元组（S9，智通公司，沈阳）
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> 供应商表</span><br><span class="line"><span class="keyword">values</span> (<span class="string">'S9'</span>,<span class="string">'智通公司'</span>,<span class="string">'沈阳'</span>)</span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>北京的所有仓库增加100M2的面积。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">update</span> ck <span class="keyword">set</span> 面积=面积+<span class="number">100</span> <span class="keyword">where</span> 城市=<span class="string">'北京'</span></span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>给低于所有职工平均工资的职工提高5%（注意要用0.05表示5%）的工资。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> 职工表</span><br><span class="line"><span class="keyword">set</span> 月工资=月工资*(<span class="number">1</span>+<span class="number">0.005</span>)</span><br><span class="line"><span class="keyword">where</span> 月工资&lt;</span><br><span class="line">(<span class="keyword">select</span> <span class="keyword">avg</span>(月工资) <span class="keyword">from</span> 职工表)</span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>给北京的职工加900元工资。（相关子查询，不相关子查询，多表三种方法实现 ）。</p>
</li>
</ol>
<ul>
<li>
<p>用相关子查询实现的代码如下：
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Update</span> 职工</span><br><span class="line"><span class="keyword">Set</span> 月工资=月工资+<span class="number">900</span></span><br><span class="line"><span class="keyword">Where</span> ‘北京’=(<span class="keyword">select</span>  城市</span><br><span class="line"><span class="keyword">From</span> 仓库</span><br><span class="line"><span class="keyword">Where</span> 仓库.仓库号=职工.仓库号)</span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>用不相关子查询实现的代码如下：
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Update</span> 职工</span><br><span class="line"><span class="keyword">Set</span> 月工资=月工资+<span class="number">900</span></span><br><span class="line"><span class="keyword">Where</span> 仓库号=(<span class="keyword">select</span>  仓库号</span><br><span class="line"><span class="keyword">From</span> 仓库</span><br><span class="line"><span class="keyword">Where</span> 城市=’北京’)</span><br></pre></td></tr></table></figure></p>
</li>
</ul>
<p>6．	删除目前没有任何订购单的供应商。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span>  <span class="keyword">from</span>  供应商表</span><br><span class="line"><span class="keyword">where</span> 供应商号 <span class="keyword">not</span> <span class="keyword">in</span></span><br><span class="line">(<span class="keyword">select</span> 供应商号 <span class="keyword">from</span> 订购表)</span><br></pre></td></tr></table></figure></p>
<p>7．	删除由在上海仓库工作的职工发出的所有订购单。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> 订购表</span><br><span class="line"><span class="keyword">where</span> 职工号 <span class="keyword">in</span></span><br><span class="line">(<span class="keyword">select</span> 职工号 <span class="keyword">from</span> 职工表 <span class="keyword">where</span> 仓库号 <span class="keyword">in</span></span><br><span class="line">( <span class="keyword">select</span> 仓库号 <span class="keyword">from</span> 仓库表 <span class="keyword">where</span> 城市=<span class="string">'上海'</span>))</span><br></pre></td></tr></table></figure></p>
<h1>实验九   流程控制语句（选做）</h1>
<p>实验日期：</p>
<h2>实验目标：</h2>
<ul>
<li>（1）掌握流程控制关键字。</li>
<li>（2）查询流程控制关键字的使用方法。
实验内容：
流程控制语句是指那些用来控制程序执行和流程分支的语句，在SQL Server 2008中，流程控制语句用来控制SQL语句、语句块或者存储过程的执行流程。</li>
</ul>
<p>Transact-SQL 语言使用的流程控制命令与常见的程序设计语言类似，主要有以下几种控制命令。</p>
<p>假设有“学生选课”的数据库，数据如实验七。</p>
<p>（1）使用IF...ELSE 语句
<code>IF...ELSE</code>语句是条件判断语句，其中，<code>ELSE子句</code>是可选的，最简单的IF语句没有ELSE子句部分。IF...ELSE语句用来判断当某一条件成立时执行某段程序，条件不成立时执行另一段程序。SQL Server允许嵌套使用IF...ELSE语句，而且嵌套层数没有限制。
IF...ELSE语句的语法形式为：
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">IF &lt;布尔表达式&gt;</span><br><span class="line">           &lt;SQL语句&gt;|&lt;语句块&gt;</span><br><span class="line">     [ELSE</span><br><span class="line">          &lt;SQL语句&gt;|&lt;语句块&gt;]</span><br></pre></td></tr></table></figure></p>
<p>例 在Student表中查询是否有‘张力’这个学生。如果有，则显示这个学生的姓名和系，否则显示没有此人。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">USE</span> 学生选课</span><br><span class="line"><span class="keyword">GO</span></span><br><span class="line"><span class="keyword">DECLARE</span> @message <span class="built_in">VARCHAR</span>(<span class="number">20</span>)</span><br><span class="line"><span class="keyword">IF</span> <span class="keyword">EXISTS</span>(<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> Student <span class="keyword">WHERE</span> SNAME=<span class="string">'张力'</span>)</span><br><span class="line">    <span class="keyword">SELECT</span> SNAME,SDEPT <span class="keyword">FROM</span> Student <span class="keyword">WHERE</span> SNAME=<span class="string">'张力'</span></span><br><span class="line"><span class="keyword">ELSE</span>  </span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">SET</span> @message=<span class="string">'没有此人'</span></span><br><span class="line">    PRINT @message</span><br><span class="line"><span class="keyword">END</span></span><br></pre></td></tr></table></figure></p>
<p>例 在SC表中查询是否有成绩大于90分的学生，有则输出有学生的成绩高于90分，否则输出没有学生的成绩高于90分。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">USE</span> STUDENTS</span><br><span class="line"><span class="keyword">GO</span></span><br><span class="line"><span class="keyword">DECLARE</span> @message <span class="built_in">VARCHAR</span>(<span class="number">20</span>)</span><br><span class="line"><span class="keyword">IF</span> <span class="keyword">EXISTS</span>(<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> SC <span class="keyword">WHERE</span> GRADE&gt;<span class="number">90</span>)</span><br><span class="line">    PRINT <span class="string">'有学生的成绩高于90分'</span></span><br><span class="line"><span class="keyword">ELSE</span>  </span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">SET</span> @message=<span class="string">'抱歉，没有学生的成绩高于90分'</span>               PRINT @message</span><br><span class="line"><span class="keyword">END</span></span><br></pre></td></tr></table></figure></p>
<p>（2）使用<code>BEGIN...END</code> 语句
在控制流程中需要执行两条或两条以上的语句，应该将这些语句定义为一个语句块（称为复合语句）。BEGIN和END必须成对实现。
语法格式：
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"> &lt;<span class="keyword">SQL</span>语句&gt;|&lt;语句块&gt;</span><br><span class="line"> <span class="keyword">END</span></span><br></pre></td></tr></table></figure></p>
<p>（3）使用CASE语句
CASE结构提供比<code>IF……ELSE</code>结构更多的选择和判断的机会。使用CASE表达式可以很方便的实现多重选择的情况，从而可以避免编写多重的IF……ELSE嵌套循环。CASE语句按照使用形式不同，可以分为简单CASE语句和搜索CASE语句，它们的语法形式分别为：</p>
<ol>
<li>简单CASE函数：
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CASE &lt;表达式&gt;</span><br><span class="line">WHEN &lt;表达式&gt; THEN &lt;表达式&gt;</span><br><span class="line">…</span><br><span class="line">WHEN &lt;表达式&gt; THEN &lt;表达式&gt;</span><br><span class="line">[ELSE &lt;表达式&gt;]</span><br><span class="line"><span class="keyword">END</span></span><br></pre></td></tr></table></figure></li>
</ol>
<p>例 从学生表Student中，选取SNO，SSEX，如果SSEX为“男”则输出“M”，如果为“女”输出“F”。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> SNO,SSEX=</span><br><span class="line"><span class="keyword">CASE</span> SSEX</span><br><span class="line">		 <span class="keyword">WHEN</span> <span class="string">'男'</span> <span class="keyword">THEN</span> <span class="string">'M'</span></span><br><span class="line">		 <span class="keyword">WHEN</span> <span class="string">'女'</span> <span class="keyword">THEN</span> <span class="string">'F'</span></span><br><span class="line">  <span class="keyword">END</span></span><br><span class="line"><span class="keyword">FROM</span> Student</span><br></pre></td></tr></table></figure></p>
<p>运行结果如图8.10所示。</p>
<ol start="2">
<li>CASE搜索函数：
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">CASE</span><br><span class="line">   WHEN &lt;条件表达式&gt; THEN &lt;表达式&gt;</span><br><span class="line">	…</span><br><span class="line">WHEN &lt;条件表达式&gt;                                      </span><br><span class="line">THEN &lt;表达式&gt;                                  </span><br><span class="line">   [ELSE &lt;表达式&gt;]</span><br><span class="line"><span class="keyword">END</span></span><br></pre></td></tr></table></figure></li>
</ol>
<p>例 从SC表中查询所有同学选课成绩情况，凡成绩为空者输出“未考”、小于60分输出“不及格”、60分至70分输出“及格”、70分至90分输出“良好”、大于或等于90分时输出“优秀”。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> SNO,CNO,GRADE,</span><br><span class="line">GRADE=<span class="keyword">CASE</span>  </span><br><span class="line">  <span class="keyword">WHEN</span> GRADE <span class="keyword">IS</span> <span class="literal">NULL</span> <span class="keyword">THEN</span> <span class="string">'未考'</span></span><br><span class="line">  <span class="keyword">WHEN</span> GRADE&lt;<span class="number">60</span> <span class="keyword">THEN</span> <span class="string">'不及格'</span></span><br><span class="line">  <span class="keyword">WHEN</span> GRADE&gt;=<span class="number">60</span> <span class="keyword">AND</span> GRADE&lt;<span class="number">70</span> <span class="keyword">THEN</span> <span class="string">'及格'</span></span><br><span class="line"> <span class="keyword">WHEN</span> GRADE&gt;=<span class="number">70</span> <span class="keyword">AND</span> GRADE&lt;<span class="number">90</span> <span class="keyword">THEN</span> <span class="string">'良好'</span></span><br><span class="line">  <span class="keyword">WHEN</span> GRADE&gt;=<span class="number">90</span> <span class="keyword">THEN</span> <span class="string">'优秀'</span></span><br><span class="line">      <span class="keyword">END</span></span><br><span class="line"><span class="keyword">FROM</span> SC</span><br></pre></td></tr></table></figure></p>
<p>（4）使用循环：<code>WHILE语句</code>
WHILE语句用来处理循环。在条件为<code>TRUE</code>的时候，重复执行一条或一个包含多条T-SQL语句的语句块，直到条件表达式为FALSE时退出循环体.
其语法如下：
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">WHILE &lt;条件表达式&gt;</span><br><span class="line">	 [<span class="keyword">BEGIN</span>]</span><br><span class="line">	    &lt;程序块&gt;</span><br><span class="line">	     [BREAK]</span><br><span class="line">	   [CONTINUE]</span><br><span class="line">	    [程序块]</span><br><span class="line">	 [<span class="keyword">END</span>]</span><br></pre></td></tr></table></figure></p>
<p>说明：CONTINUE 命令可以让程序跳过CONTINUE 命令之后的语句，回到WHILE 循环的第一行，继续进行下一次循环。BREAK 命令则让程序完全跳出循环，结束WHILE 命令的执行。<code>WHILE</code>语句也可以嵌套。
例 编程求1到100的和。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> @i <span class="built_in">int</span></span><br><span class="line"><span class="keyword">declare</span> @<span class="keyword">sum</span> <span class="built_in">int</span></span><br><span class="line"><span class="keyword">set</span> @i=<span class="number">1</span></span><br><span class="line"><span class="keyword">set</span> @<span class="keyword">sum</span> =<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> @i&lt;=<span class="number">100</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">set</span> @<span class="keyword">sum</span> =@<span class="keyword">sum</span>+@i</span><br><span class="line">    <span class="keyword">set</span> @i=@i+<span class="number">1</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">select</span> @<span class="keyword">sum</span> <span class="keyword">as</span> 合计 ,@i <span class="keyword">as</span> 循环数</span><br></pre></td></tr></table></figure></p>
<p>图9.1运行结果如图9.1所示。</p>
<p><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://ws1.sinaimg.cn/large/d71f8b2fgy1fq5dx9sxmlj203o01uq2q.jpg" alt title>
                </div>
                <div class="image-caption"></div>
            </figure></p>
<p>请读下列程序并回答下列程序的功能。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DECLARE</span> @i <span class="built_in">INT</span></span><br><span class="line"><span class="keyword">SET</span> @i = <span class="number">1</span></span><br><span class="line"><span class="keyword">WHILE</span> (@i &lt; <span class="number">11</span>)    </span><br><span class="line">  <span class="keyword">BEGIN</span>                      </span><br><span class="line">    <span class="keyword">IF</span>(@i &lt; <span class="number">5</span>)            </span><br><span class="line">    <span class="keyword">BEGIN</span>               </span><br><span class="line">		<span class="keyword">SET</span> @i = @i + <span class="number">1</span>                                 		 </span><br><span class="line">CONTINUE</span><br><span class="line">    <span class="keyword">END</span>       </span><br><span class="line">    PRINT @i</span><br><span class="line">    <span class="keyword">SET</span> @i = @i + <span class="number">1</span></span><br><span class="line">  <span class="keyword">END</span></span><br></pre></td></tr></table></figure></p>
<p>（5）使用GOTO 语句
<code>GOTO</code>：可以将执行流程改变到由标签指定的位置。系统跳过GOTO关键字之后的语句，并在GOTO 语句中指定的标签处继续执行操作。
语法：
GOTO  标识符
求1＋2＋3＋…＋10的总和。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DECLARE</span> @S <span class="built_in">SMALLINT</span>,@I <span class="built_in">SMALLINT</span></span><br><span class="line"><span class="keyword">SET</span> @I=<span class="number">1</span></span><br><span class="line"><span class="keyword">SET</span> @S=<span class="number">0</span></span><br><span class="line">BEG:</span><br><span class="line"><span class="keyword">IF</span> (@I&lt;=<span class="number">10</span>)</span><br><span class="line">   <span class="keyword">BEGIN</span></span><br><span class="line">       <span class="keyword">SET</span> @S=@S+@I</span><br><span class="line">       <span class="keyword">SET</span> @I=@I+<span class="number">1</span></span><br><span class="line">       <span class="keyword">GOTO</span> BEG</span><br><span class="line">   <span class="keyword">END</span></span><br><span class="line">PRINT @S</span><br></pre></td></tr></table></figure></p>
<p>运行结果如图9.2所示。</p>
<p><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://ws1.sinaimg.cn/large/d71f8b2fgy1fq5dzhztndj204t01la9t.jpg" alt title>
                </div>
                <div class="image-caption"></div>
            </figure></p>
<p>（6）调度执行：WAIT  FOR
该语句可以指定它以后的语句在某个时间间隔之后执行，或未来的某一时间执行。
语法如下：
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WAIT  FOR&#123;DELAY 'time'|TIME 'time'&#125;</span><br></pre></td></tr></table></figure></p>
<p>参数含义：
<code>DELAY 'time'</code>是指定SQL Server 等待的时间间隔，最长可达24小时。
<code>TIME 'time'</code>是指定SQL Server等待到某一时刻。
例 若变量<code>“@等待”</code>的值等于“间隔”，查询Studnet表是在等待2分钟后执行，否则在下午2:10执行。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DECLARE</span> @等待 <span class="built_in">CHAR</span>(<span class="number">10</span>)</span><br><span class="line"><span class="keyword">SET</span> @等待= <span class="string">'间隔'</span></span><br><span class="line"><span class="keyword">IF</span> @等待= <span class="string">'间隔'</span></span><br><span class="line">	<span class="keyword">BEGIN</span>  </span><br><span class="line">		WAITFOR DELAY <span class="string">'00:02:00'</span></span><br><span class="line">		<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> STUDENT</span><br><span class="line">	<span class="keyword">END</span></span><br><span class="line"><span class="keyword">ELSE</span></span><br><span class="line">	<span class="keyword">BEGIN</span></span><br><span class="line">		WAITFOR <span class="built_in">TIME</span> <span class="string">'14:10:00'</span></span><br><span class="line">		<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> STUDENT</span><br><span class="line">	<span class="keyword">END</span></span><br></pre></td></tr></table></figure></p>
<h1>实验十  SQL SERVER事务设计（选做）</h1>
<p>实验时间：</p>
<h2>实验目的：</h2>
<ul>
<li>（1）通过实验理解事务的概念、特性，掌握事务的设计思想和事务创建、执行的方法；</li>
<li>（2）掌握事务的提交COMMIT；</li>
<li>（3）掌握事务的回滚ROLLBACK；</li>
<li>（4）了解事务的锁。</li>
</ul>
<h2>实验内容：</h2>
<p>创建一个名为“仓库职工”的数据库，导入以下的四张表到该数据库中，完成以下各题
仓库表</p>
<table>
<thead>
<tr>
<th style="text-align:center">仓库号</th>
<th style="text-align:left">城市</th>
<th style="text-align:center">面积</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">WH1</td>
<td style="text-align:left">北京</td>
<td style="text-align:center">370</td>
</tr>
<tr>
<td style="text-align:center">WH2</td>
<td style="text-align:left">上海</td>
<td style="text-align:center">500</td>
</tr>
<tr>
<td style="text-align:center">WH3</td>
<td style="text-align:left">广州</td>
<td style="text-align:center">200</td>
</tr>
<tr>
<td style="text-align:center">WH4</td>
<td style="text-align:left">武汉</td>
<td style="text-align:center">400</td>
</tr>
</tbody>
</table>
<p>职工表</p>
<table>
<thead>
<tr>
<th style="text-align:center">仓库号</th>
<th style="text-align:center">职工号</th>
<th style="text-align:center">工资</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">WH2</td>
<td style="text-align:center">E1</td>
<td style="text-align:center">1220</td>
</tr>
<tr>
<td style="text-align:center">WH1</td>
<td style="text-align:center">E2</td>
<td style="text-align:center">1210</td>
</tr>
<tr>
<td style="text-align:center">WH2</td>
<td style="text-align:center">E3</td>
<td style="text-align:center">1250</td>
</tr>
<tr>
<td style="text-align:center">WH3</td>
<td style="text-align:center">E4</td>
<td style="text-align:center">1230</td>
</tr>
<tr>
<td style="text-align:center">WH1</td>
<td style="text-align:center">E5</td>
<td style="text-align:center">1250</td>
</tr>
<tr>
<td style="text-align:center">WH3</td>
<td style="text-align:center">E6</td>
<td style="text-align:center">2000</td>
</tr>
<tr>
<td style="text-align:center">WH1</td>
<td style="text-align:center">E7</td>
<td style="text-align:center">2080</td>
</tr>
</tbody>
</table>
<p>订购表</p>
<table>
<thead>
<tr>
<th style="text-align:center">职工号</th>
<th style="text-align:center">供应商号</th>
<th style="text-align:center">订购单号</th>
<th style="text-align:center">订购日期</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">E3</td>
<td style="text-align:center">S7</td>
<td style="text-align:center">OR67</td>
<td style="text-align:center">2009-12-4</td>
</tr>
<tr>
<td style="text-align:center">E1</td>
<td style="text-align:center">S4</td>
<td style="text-align:center">OR73</td>
<td style="text-align:center">2009-4-1</td>
</tr>
<tr>
<td style="text-align:center">E7</td>
<td style="text-align:center">S4</td>
<td style="text-align:center">OR76</td>
<td style="text-align:center">2009-4-2</td>
</tr>
<tr>
<td style="text-align:center">E6</td>
<td style="text-align:center">S6</td>
<td style="text-align:center">OR77</td>
<td style="text-align:center">2009-1-21</td>
</tr>
<tr>
<td style="text-align:center">E3</td>
<td style="text-align:center">S4</td>
<td style="text-align:center">OR79</td>
<td style="text-align:center">2009-11-15</td>
</tr>
<tr>
<td style="text-align:center">E1</td>
<td style="text-align:center">S6</td>
<td style="text-align:center">OR80</td>
<td style="text-align:center">2009-2-1</td>
</tr>
<tr>
<td style="text-align:center">E3</td>
<td style="text-align:center">S6</td>
<td style="text-align:center">OR90</td>
<td style="text-align:center">2009-3-12</td>
</tr>
<tr>
<td style="text-align:center">E3</td>
<td style="text-align:center">S3</td>
<td style="text-align:center">OR91</td>
<td style="text-align:center">2009-3-2</td>
</tr>
</tbody>
</table>
<p>供应商表</p>
<table>
<thead>
<tr>
<th style="text-align:center">供应商号</th>
<th style="text-align:center">供应商名</th>
<th style="text-align:center">地址</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">S3</td>
<td style="text-align:center">振华电子厂</td>
<td style="text-align:center">西安</td>
</tr>
<tr>
<td style="text-align:center">S4</td>
<td style="text-align:center">华通电子公司</td>
<td style="text-align:center">北京</td>
</tr>
<tr>
<td style="text-align:center">S6</td>
<td style="text-align:center">607厂</td>
<td style="text-align:center">郑州</td>
</tr>
<tr>
<td style="text-align:center">S7</td>
<td style="text-align:center">爱华电子厂</td>
<td style="text-align:center">北京</td>
</tr>
<tr>
<td style="text-align:center">S8</td>
<td style="text-align:center">胖熊公司</td>
<td style="text-align:center">广州</td>
</tr>
<tr>
<td style="text-align:center">S9</td>
<td style="text-align:center">巧姑娘日化</td>
<td style="text-align:center">北京</td>
</tr>
</tbody>
</table>
<ol>
<li>创建事务,并执行。功能为实现广州的职工加10%的工资.
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Begin</span> <span class="keyword">transaction</span></span><br><span class="line"><span class="keyword">Use</span> cangku</span><br><span class="line"><span class="keyword">Go</span></span><br><span class="line"><span class="keyword">Update</span> 职工    <span class="keyword">set</span> 工资=工资*<span class="number">1.1</span></span><br><span class="line"><span class="keyword">From</span> 职工,仓库       </span><br><span class="line"><span class="keyword">Where</span> 职工.仓库号=仓库.仓库号   <span class="keyword">and</span>  城市=’广州’</span><br><span class="line"><span class="keyword">Go</span></span><br><span class="line"><span class="keyword">Commit</span></span><br><span class="line"><span class="keyword">Go</span></span><br></pre></td></tr></table></figure></li>
</ol>
<p>（2）在select 语句中加锁，悲观锁定职工表。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Begin</span> <span class="keyword">transaction</span></span><br><span class="line"><span class="keyword">Select</span>  * <span class="keyword">From</span>职工表<span class="keyword">with</span>(xlock)</span><br><span class="line"><span class="keyword">Insert</span> <span class="keyword">into</span> 职工表(仓库号,职工号)  <span class="keyword">values</span>(‘WH2’,’E10’)</span><br><span class="line"><span class="keyword">Update</span>  职工表  <span class="keyword">set</span> 工资=<span class="number">2980</span></span><br><span class="line"><span class="keyword">Where</span> 仓库号=‘WH2’ <span class="keyword">and</span> 职工号=‘E10’</span><br><span class="line"><span class="keyword">Commit</span> <span class="keyword">transaction</span></span><br></pre></td></tr></table></figure></p>
<p>（3）使用HOLDLOCK对供应商表加共享锁。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Begin</span> <span class="keyword">transaction</span> t2</span><br><span class="line"><span class="keyword">Select</span>  供应商号  <span class="keyword">From</span>  供应商表<span class="keyword">with</span>(holdlock)</span><br><span class="line"><span class="keyword">Select</span>  <span class="keyword">count</span>(供应商号)  <span class="keyword">From</span>  供应商表</span><br><span class="line"><span class="keyword">Commit</span></span><br></pre></td></tr></table></figure></p>
<h2>思考题：</h2>
<ol>
<li>什么是事务？事务和程序是一个概念吗？</li>
</ol>
<p>事务是由一系列访问和更新操作组成的程序执行单元</p>
<p>事务是应用程序中一系列严密的操作，所有操作必须成功完成，否则在每个操作中所作的所有更改都会被撤消。也就是事务具有原子性，一个事务中的一系列的操作要么全部成功，要么一个都不做。</p>
<p>不是同一概念</p>
<ol start="2">
<li>解释语句rollback和commit的作用。</li>
</ol>
<p>Commit是提交事务，即提交某个事务的所有的操作；具体地说，就是将事务中所有对数据库的更新写回到磁盘上的物理数据库中去，事务正常结束。</p>
<p>Rollback表示回滚，即将事务运行的过程中发生了某种故障，事务不能继续执行，系统将事务中对数据库的所有已完成的操作全部撤销，回滚到事务开始的状态。</p>
<ol start="3">
<li>为何使用事务？</li>
</ol>
<p>答：通过事务，SQL Server能将逻辑相关的一组操作绑定在一起，以便服务器保持数据的完整性。主要用于一些对操作过程的完整性比较高的程序。比如银行系统，用户在转账的过程中程序出现错误，但是这个转账操作没有完成。那么这个操作就被退回。</p>
<ol start="4">
<li>乐观锁和悲观锁的优缺点各是什么？</li>
</ol>
<p>答：
乐观锁:
优势是:乐观锁机制避免了长事务中的数据库加锁解锁开销，大大提升了大并发量下的系统整体性能表现；</p>
<p>劣势是，只能在提交数据时才发现业务事务将要失败，如果系统的冲突非常的多，而且一旦冲突就要因为重新计算提交而造成较大的代价的话，乐观锁也会带来很大的问题，在某些情况下，发现失败太迟的代价会非常的大。而且乐观锁也无法解决读”脏”数据的问题。</p>
<p>悲观锁:</p>
<p>优势是，能避免冲突的发生；</p>
<p>劣势是，开销较大，而且加锁时间较长，对于并发的访问性支持不好。</p>
<h1>实验十一  SQL SERVER的存储过程（选做）</h1>
<p>实验时间：</p>
<h2>实验目的：</h2>
<p>（1）掌握存储过程的定义；
（2）掌握存储过程的有点；
（3）掌握定义带输入与输出参数的存储过程；
（4）调用存储过程。
（5）删除存储过程</p>
<h2>实验内容：</h2>
<p>注意：这次实验的示例数据库为学生选课数据库，请运行例题中的代码。</p>
<p>存储过程（procedure）类似于C语言中的函数，JAVA的方法。它可以重复调用。当存储过程执行一次后，可以将语句缓存中，这样下次执行的时候直接使用缓存中的语句。这样就可以提高存储过程的性能。
存储过程是一组编译在单个执行计划中的Transact-SQL语句，将一些固定的操作集中起来交给SQL Server数据库服务器完成，以实现某个任务。</p>
<h3>存储过程的优点：</h3>
<p>（1）与其他应用程序共享应用程序逻辑，因而确保了数据访问和修改的一致性。</p>
<p>（2）防止数据库中表的细节暴露给用户。</p>
<p>（3）提供安全机制。</p>
<p>（4）改进性能。</p>
<p>（5）减少网络流量。</p>
<h4>1．存储过程的分类</h4>
<p>（1) 用户定义的存储过程</p>
<p>用户定义的<code>Transact-SQL</code>存储过程中包含一组<code>Transact-SQL</code> 语句集合，可以接受和返回用户提供的参数。</p>
<p>（2）扩展存储过程</p>
<p>扩展存储过程是指<code>Microsoft SQL Server</code>的实例可以动态加载和运行的 DLL，是由用户使用编程语言（例如C）创建的自己的外部例程，扩展存储过程一般使用<code>sp_</code>或<code>xp_</code>前缀。</p>
<p>（3）系统存储过程</p>
<p>由系统提供的存储过程，可以作为命令执行各种操作。系统存储过程定义在系统数据库master中，其前缀是sp_，例如常用的显示系统信息的sp_help存储过程。</p>
<h4>2．如何创建存储过程</h4>
<p>创建简单的存储过程的语法:
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span>  PROC[EDURE]  存储过程名</span><br><span class="line">[<span class="keyword">WITH</span>  ENCRYPTION]</span><br><span class="line">[<span class="keyword">WITH</span>  RECOMPILE]</span><br><span class="line"><span class="keyword">AS</span></span><br></pre></td></tr></table></figure></p>
<p>SQL语句
说明：<code>WITH ENCRYPTION</code>--对存储过程进行加密，加密的存储过程用sp_helptext查看不到存储过程的原码；<code>WITH RECOMPILE</code>--对存储过程重新编译。
执行存储过程的语法：
EXEC 存储过程名
例 创建一个名为GetInfo存储过程，用于获取所有学生信息。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> GetInfo</span><br><span class="line"><span class="keyword">AS</span>  </span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> Student</span><br><span class="line">执行存储过程：</span><br><span class="line">EXEC GetInfo</span><br></pre></td></tr></table></figure></p>
<p>接下来学习编写带参数的存储过程。上例中的存储过程可以获取所有学生信息，如果要获取指定学生的信息怎么做？这里就需要创建带参数的存储过程。</p>
<p>存储过程的参数分两种：输入参数和输出参数。输入参数用于向存储过程传入值，类似C语言的按值传递；输出参数用于在调用存储过程后返回结果，类似C语言的按引用传递；</p>
<p>带参数的存储过程的语法：
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span>  PROC[EDURE]  存储过程名</span><br><span class="line">@参数<span class="number">1</span>  数据类型 = 默认值[<span class="keyword">OUTPUT</span>],</span><br><span class="line">  …,</span><br><span class="line">@参数n  数据类型 = 默认值 [<span class="keyword">OUTPUT</span>]</span><br><span class="line"><span class="keyword">AS</span></span><br></pre></td></tr></table></figure></p>
<p>SQL语句</p>
<p>例 创建一个带输入参数的存储过程，要求用于获取指定学生的信息。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> StuInfo</span><br><span class="line">@<span class="keyword">name</span> <span class="built_in">CHAR</span>(<span class="number">10</span>)</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line">   <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> STUDENT <span class="keyword">WHERE</span> SNAME=@<span class="keyword">name</span></span><br><span class="line">执行存储过程</span><br><span class="line">EXEC StuInfo @<span class="keyword">name</span>=<span class="string">'李晨'</span></span><br><span class="line">或按位置传递参数值</span><br><span class="line">EXEC StuInfo <span class="string">'李晨'</span></span><br></pre></td></tr></table></figure></p>
<p>执行完毕的结果如图11.1所示：</p>
<p><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://ws1.sinaimg.cn/large/d71f8b2fgy1fq5e0nh2yvj20730213yc.jpg" alt title>
                </div>
                <div class="image-caption"></div>
            </figure></p>
<p>图11.1执行存储过程结果
例 创建一个带输入和输出参数的存储过程GetScore，获取指定课程的平均成绩、最高成绩、最低成绩，并返回结果。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> GetScore</span><br><span class="line">@kcID <span class="built_in">CHAR</span>(<span class="number">10</span>),@AVGScore <span class="built_in">INT</span> <span class="keyword">OUTPUT</span>,</span><br><span class="line">@MAXScore <span class="built_in">INT</span> <span class="keyword">OUTPUT</span>,@MINScore <span class="built_in">INT</span> <span class="keyword">OUTPUT</span></span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span>    @AVGScore=<span class="keyword">AVG</span>(Grade),@MAXScore=<span class="keyword">MAX</span>(Grade),@MINScore=<span class="keyword">MIN</span>(Grade)</span><br><span class="line"> <span class="keyword">FROM</span> SC</span><br><span class="line"> <span class="keyword">WHERE</span> Cno=@kcID</span><br><span class="line"> <span class="keyword">SELECT</span>  @AVGScore <span class="keyword">as</span> 平均成绩,@MAXScore <span class="keyword">as</span> 最高成绩,@MINScore <span class="keyword">as</span> 最低成绩</span><br><span class="line">执行存储过程</span><br><span class="line"><span class="keyword">DECLARE</span> @kcID <span class="built_in">CHAR</span>(<span class="number">10</span>),@AVGScore <span class="built_in">INT</span>,@MAXScore <span class="built_in">INT</span>,@MINScore <span class="built_in">INT</span></span><br><span class="line"><span class="keyword">SET</span> @kcID=<span class="string">'C001'</span></span><br><span class="line">EXEC GetScore @kcID,@AVGScore,@MAXScore,@MINScore</span><br></pre></td></tr></table></figure></p>
<p>执行完毕的结果如图8.20所示：</p>
<p><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://ws1.sinaimg.cn/large/d71f8b2fgy1fq5e29ufetj206u023mwz.jpg" alt title>
                </div>
                <div class="image-caption"></div>
            </figure></p>
<p>图11.2 执行存储过程结果
3．查看存储过程
在SQL Server中，根据不同需要，可以使用<code>sp_helptext、sp_help</code>、<code>sp_depends</code>系统存储过程来查看用户自定义函数的不同信息。
例29. 查看Students数据库中存储过程GetInfo信息。
代码如下：
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">EXEC sp_helptext GetInfo</span><br><span class="line">EXEC sp_help GetInfo</span><br><span class="line">EXEC sp_depends GetInfo</span><br></pre></td></tr></table></figure></p>
<p>运行后得到存储过程的定义、参数和依赖信息。
4．存储过程的修改
修改存储过程是由ALTER语句来完成的，其语法如下：
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">PROCEDURE</span> procedure_name</span><br><span class="line">[<span class="keyword">WITH</span> ENCRYPTION]</span><br><span class="line">[<span class="keyword">WITH</span> RECOMPILE]</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line">Sql_statement</span><br></pre></td></tr></table></figure></p>
<p>例 修改存储过程StuInfo，根据用户提供的系名进行统计这个系的人数，并要求加密。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">PROCEDURE</span> StuInfo</span><br><span class="line">@dept <span class="built_in">CHAR</span>(<span class="number">10</span>),</span><br><span class="line">@<span class="keyword">num</span> <span class="built_in">INT</span> <span class="keyword">OUTPUT</span></span><br><span class="line"><span class="keyword">WITH</span> ENCRYPTION</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> @<span class="keyword">num</span>=<span class="keyword">COUNT</span>(*) <span class="keyword">FROM</span> Student <span class="keyword">WHERE</span> SDEPT=@dept</span><br><span class="line">PRINT @<span class="keyword">num</span></span><br></pre></td></tr></table></figure></p>
<p>执行存储过程
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DECLARE</span> @dept <span class="built_in">CHAR</span>(<span class="number">10</span>),@<span class="keyword">num</span> <span class="built_in">INT</span></span><br><span class="line"><span class="keyword">SET</span> @dept=<span class="string">'CS'</span></span><br><span class="line">EXEC StuInfo @dept,@<span class="keyword">num</span></span><br></pre></td></tr></table></figure></p>
<p>5．存储过程的删除</p>
<p>存储过程的删除是通过DROP语句来实现的。</p>
<p>例31. 使用Transact-SQL语句来删除存储过程StuInfo。
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">PROCEDURE</span> StuInfo</span><br></pre></td></tr></table></figure></p>

    

        <a href="/posts/SQLexam.html" class="post-more waves-effect waves-button">
            阅读全文…
        </a>
    </div>
    
    <div class="post-footer">
        
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SQL/">SQL</a></li></ul>

    </div>
    
</article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-Ubuntu-Theme"
  class="article-card article-type-post" itemprop="blogPost">

    <div class="post-meta">
        <time class="post-time" title="2018-04-05 11:21:24" datetime="2018-04-05T03:21:24.000Z"  itemprop="datePublished"><i class="icon icon-calendar"></i> 2018-04-05</time>
        
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Linux/">Linux</a></li></ul>



           
    </div>

    


  
    <h3 class="post-title" itemprop="name">
      <a class="post-title-link" href="/posts/Ubuntu-Theme.html">Ubuntu 美化</a>
    </h3>
  




    <div class="post-content" id="post-content" itemprop="postContent">

    
        <p>Ubuntu美化
&lt;!--more--&gt;</p>
<h1>主题</h1>
<p>unity-tweak-tool
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install unity-tweak-tool</span><br></pre></td></tr></table></figure></p>
<p>Flatabulous 主题
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo add-apt-repository ppa:noobslab/themes</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install flatabulous-theme</span><br></pre></td></tr></table></figure></p>
<p>配套的图标
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo add-apt-repository ppa:noobslab/icons</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install ultra-flat-icons</span><br></pre></td></tr></table></figure></p>
<h1>oh-my-zsh</h1>
<p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/robbyrussell/oh-my-zsh/raw/master/tools/install.sh -O - | sh</span><br><span class="line">chsh -s zsh</span><br></pre></td></tr></table></figure></p>
<h2>问题错误</h2>
<p>agnoster 主题不正常</p>
<ul>
<li>
<p>修改字体即可</p>
</li>
<li>
<p>错误提示</p>
</li>
</ul>
<p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">zsh compinit: insecure directories, run compaudit <span class="keyword">for</span> list.</span><br><span class="line">Ignore insecure directories and <span class="built_in">continue</span> [y] or abort compinit [n]?</span><br></pre></td></tr></table></figure></p>
<ul>
<li>解决方法</li>
</ul>
<p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">compaudit</span><br><span class="line"><span class="comment">//会显示如下内容</span></span><br><span class="line">There are insecure <span class="string">directories:</span></span><br><span class="line">  usr<span class="regexp">/local/</span>share<span class="regexp">/zsh/</span>site-functions</span><br><span class="line"><span class="comment">//</span></span><br><span class="line">cd cd <span class="regexp">/usr/</span>local<span class="regexp">/share/</span>zsh</span><br><span class="line">sudo chown -R <span class="string">root:</span>root ./site-functions</span><br><span class="line">cd <span class="regexp">/usr/</span>local<span class="regexp">/share/</span></span><br><span class="line">sudo chmod -R <span class="number">755</span> zsh</span><br><span class="line">sudo chown -R <span class="string">root:</span>staff zsh</span><br></pre></td></tr></table></figure></p>
<hr>
<p><strong>参考</strong></p>
<ul>
<li><a href="https://stackoverflow.com/questions/13762280/zsh-compinit-insecure-directories" target="_blank" rel="noopener">zsh compinit: insecure directories</a></li>
</ul>

    

        <a href="/posts/Ubuntu-Theme.html" class="post-more waves-effect waves-button">
            阅读全文…
        </a>
    </div>
    
    <div class="post-footer">
        
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/">Linux</a></li></ul>

    </div>
    
</article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-Ubuntu-Nodejs"
  class="article-card article-type-post" itemprop="blogPost">

    <div class="post-meta">
        <time class="post-time" title="2018-04-04 21:23:10" datetime="2018-04-04T13:23:10.000Z"  itemprop="datePublished"><i class="icon icon-calendar"></i> 2018-04-04</time>
        
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Linux/">Linux</a></li></ul>



           
    </div>

    


  
    <h3 class="post-title" itemprop="name">
      <a class="post-title-link" href="/posts/Ubuntu-Nodejs.html">Ubuntu 下 Node.Js 安装与版本升级</a>
    </h3>
  




    <div class="post-content" id="post-content" itemprop="postContent">

    
        <p>Ubuntu 下 nodejs 安装与版本升级
&lt;!--more--&gt;</p>
<h2>在Github上获取 Node.Js 源码</h2>
<p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo git <span class="built_in">clone</span> https://github.com/nodejs/node.git　nodejs</span><br></pre></td></tr></table></figure></p>
<h2>安装</h2>
<p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">sudo chmod -R <span class="number">755</span> <span class="keyword">node</span><span class="title"></span></span><br><span class="line"><span class="title">//修改目录权限</span></span><br><span class="line"><span class="title">cd</span> <span class="keyword">node</span><span class="title"></span></span><br><span class="line"><span class="title">//进入node</span>目录</span><br><span class="line">sudo ./configure</span><br><span class="line">使用 ./configure 创建编译文件</span><br><span class="line">sudo make</span><br><span class="line">//下一步，可能时间有点长，耐心等待</span><br><span class="line">sudo make install</span><br><span class="line">$ <span class="keyword">node</span> <span class="title">-v</span></span><br></pre></td></tr></table></figure></p>
<ul>
<li>如果 Node 不是最新的，Node 有一个模块叫 Npm，是专门用来管理 Node.Js的版本的。使用 npm安装 Npm 模块</li>
</ul>
<p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo npm install -g n</span><br></pre></td></tr></table></figure></p>
<ul>
<li>然后，升级node.js到最新稳定版</li>
</ul>
<p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo n stable</span><br></pre></td></tr></table></figure></p>
<ul>
<li>旧版本的 npm，也可以很容易地通过 npm 命令来升级，命令如下：</li>
</ul>
<p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo npm install npm -g</span><br></pre></td></tr></table></figure></p>
<h2>将 Node 和 Npm 设置为全局</h2>
<p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo ln /opt/nodejs/bin/node(安装目录) /usr/<span class="built_in">local</span>/bin/node</span><br><span class="line">sudo ln /opt/nodejs/bin/npm（安装目录） /usr/<span class="built_in">local</span>/bin/npm</span><br></pre></td></tr></table></figure></p>
<h2>几个 Npm 常用命令</h2>
<table>
<thead>
<tr>
<th style="text-align:left">命令</th>
<th style="text-align:left">解析</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">npm -v</td>
<td style="text-align:left">显示版本，检查npm 是否正确安装</td>
</tr>
<tr>
<td style="text-align:left">npm install -g express</td>
<td style="text-align:left">全局安装express模块</td>
</tr>
<tr>
<td style="text-align:left">npm list</td>
<td style="text-align:left">列出已安装模块</td>
</tr>
<tr>
<td style="text-align:left">npm show express</td>
<td style="text-align:left">显示模块详情</td>
</tr>
<tr>
<td style="text-align:left">npm update</td>
<td style="text-align:left">升级当前目录下的项目的所有模块</td>
</tr>
<tr>
<td style="text-align:left">npm update express</td>
<td style="text-align:left">升级当前目录下的项目的指定模块</td>
</tr>
<tr>
<td style="text-align:left">npm update -g express</td>
<td style="text-align:left">升级全局安装的express模块</td>
</tr>
<tr>
<td style="text-align:left">npm uninstall express</td>
<td style="text-align:left">删除指定的模块</td>
</tr>
</tbody>
</table>
<hr>
<p><strong>参考</strong></p>
<ul>
<li><a href="https://blog.csdn.net/lss_csdn/article/details/52165652" target="_blank" rel="noopener">
ubuntu下nodejs安装与版本升级</a></li>
</ul>

    

        <a href="/posts/Ubuntu-Nodejs.html" class="post-more waves-effect waves-button">
            阅读全文…
        </a>
    </div>
    
    <div class="post-footer">
        
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Node-Js/">Node.Js</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Ubuntu/">Ubuntu</a></li></ul>

    </div>
    
</article>

        </li>
    
    </ul>

    
<nav id="page-nav">
    <div class="inner">
    <a class="extend prev" rel="prev" href="/page/14/">上一页</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/">13</a><a class="page-number" href="/page/14/">14</a><span class="page-number current">15</span><a class="page-number" href="/page/16/">16</a><a class="page-number" href="/page/17/">17</a><a class="page-number" href="/page/18/">18</a><a class="extend next" rel="next" href="/page/16/">下一页</a>
    </div>
</nav>


</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/xml/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>博客内容遵循 <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a></span>
        </p>
    </div>
    <div class="bottom">
        <p><span>Vitan &copy; 2017 - 2020</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>


    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: false, REWARD: false };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '您似乎掉线了呢！';
            clearTimeout(titleTime);
        } else {
            document.title = '(つェ⊂)咦!又好了!';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
