<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
    
<!-- Google Analytics -->
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-144334903-1', 'auto');
ga('send', 'pageview');
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<!-- End Google Analytics -->


    <script data-ad-client="ca-pub-2581760538335948" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

    

    



    <meta charset="utf-8">
    
    
    
    <link rel="canonical" href="https://vitan.me/">
    
    
    <title>Vitan&#39;s Blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="Coder,Linux,Web,Blog...">
    <meta name="description" content="Vitan&apos;s Personal Website.">
<meta name="keywords" content="Coder,Linux,Web,Blog...">
<meta property="og:type" content="website">
<meta property="og:title" content="Vitan&#39;s Blog">
<meta property="og:url" content="https://vitan.me/index.html">
<meta property="og:site_name" content="Vitan&#39;s Blog">
<meta property="og:description" content="Vitan&apos;s Personal Website.">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Vitan&#39;s Blog">
<meta name="twitter:description" content="Vitan&apos;s Personal Website.">
    
        <link rel="alternate" type="application/atom+xml" title="Vitan&#39;s Blog" href="/xml/atom.xml">
    
    <link rel="shortcut icon" href="/img/favicon.png">
    <link rel="stylesheet" href="/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>
<body>
    <div id="loading" class="active"></div>

    <aside id="menu"  >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/ivitan.png">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Vitan</h5>
          <a href="mailto:admin@vitan.me" title="admin@vitan.me" class="mail">admin@vitan.me</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect active">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                分类
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                归档
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                标签
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/about"  >
                <i class="icon icon-lg icon-info-circle"></i>
                关于
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/ivitan" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
            <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Vitan&#39;s Blog</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off"
                placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        
        <a href="https://github.com/ivitan" class="header-icon waves-effect waves-circle waves-light" target="_blank" title="Github">
            <i class="icon icon-lg icon-github"></i>
        </a>
        
    </div>
</header>
<header class="content-header index-header">

    <div class="container fade-scale">
        <h1 class="title">Vitan&#39;s Blog</h1>
        <h5 class="subtitle">
            
            ⁣⁣⁣Stay Hungry, Stay Foolish.
            
        </h5>
    </div>

    


</header>

<div class="container body-wrap">

    <ul class="post-list">
    
        <li class="post-list-item fade">
            <article id="post-Termux"
    class="article-card article-type-post" itemprop="blogPost">

      <div class="post-meta">
          <time class="post-time" title="2018-06-25 07:52:16" datetime="2018-06-24T23:52:16.000Z"  itemprop="datePublished"><i class="icon icon-calendar"></i> 2018-06-25</time>

          
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Diary/">Diary</a></li></ul>



          
              <span><icon class="icon icon-thumb-tack icon-pr"></icon><font color="ff4081">置顶</font></span>
          
      </div>

      


  
    <h3 class="post-title" itemprop="name">
      <a class="post-title-link" href="/posts/Termux.html">Termux</a>
    </h3>
  



      <div class="post-content" id="post-content" itemprop="postContent">

      
          <blockquote>
<p><a href="https://wiki.termux.com/wiki/Main_Page" target="_blank" rel="noopener">Termux</a> 是一个 Android 下一个高级的终端模拟器, 开源且不需要 root, 支持 apt 管理软件包，十分方便安装软件包, 完美支持 Python PHP Ruby Go Nodejs MySQL 等。</p>
</blockquote>
<h1>部署脚本</h1>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -c <span class="string">"<span class="variable">$(curl -fsSL https://raw.githubusercontent.com/ivitan/Shell/master/Termux/Termux.sh)</span>"</span></span><br></pre></td></tr></table></figure></p>
<h1>命令</h1>
<h2>基本命令</h2>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">pkg search &lt;query&gt;  <span class="comment">#搜索包</span></span><br><span class="line">pkg install &lt;package&gt; <span class="comment">#安装包</span></span><br><span class="line">pkg uninstall &lt;package&gt; <span class="comment">#卸载包</span></span><br><span class="line">pkg reinstall &lt;package&gt; <span class="comment">#重新安装包</span></span><br><span class="line">pkg update  <span class="comment">#更新源</span></span><br><span class="line">pkg upgrade <span class="comment">#升级软件包</span></span><br><span class="line">pkg list-all <span class="comment">#列出可供安装的所有包</span></span><br><span class="line">pkg list-installed  <span class="comment">#列出已经安装的包</span></span><br><span class="line">pkg shoe &lt;package&gt;  <span class="comment">#显示某个包的详细信息</span></span><br><span class="line">pkg files &lt;package&gt;  <span class="comment">#显示某个包的</span></span><br></pre></td></tr></table></figure></p>
<p>&lt;!--more--&gt;</p>
<h2>安装 *.deb 文件</h2>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dpkg -i ./package.deb <span class="comment">#安装</span></span><br><span class="line">dpkg --remove [package name] <span class="comment">#卸载</span></span><br><span class="line">dpkg --remove [package name] <span class="comment">#列出所有已安装的包</span></span><br></pre></td></tr></table></figure></p>
<h1>换源</h1>
<h2>清华源</h2>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sed -i <span class="string">'s@^\(deb.*stable main\)$@#\1\ndeb https://mirrors.tuna.tsinghua.edu.cn/termux stable main@'</span> <span class="variable">$PREFIX</span>/etc/apt/sources.list</span><br><span class="line">apt update &amp;&amp; apt upgrade -y</span><br></pre></td></tr></table></figure></p>
<p>https://mirrors.tuna.tsinghua.edu.cn/termux 代替原文中的 https://termux.net 保存退出
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> EDITOR=vim <span class="comment"># 设置默认编辑器</span></span><br><span class="line">apt edit-sources</span><br></pre></td></tr></table></figure></p>
<h2>官方其他源</h2>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pkg install root-repo</span><br><span class="line">pkg install x11-repo</span><br><span class="line">pkg install unstable-repo</span><br></pre></td></tr></table></figure></p>
<h2><a href="https://github.com/its-pointless/its-pointless.github.io" target="_blank" rel="noopener">its-pointless</a></h2>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pkg install wget</span><br><span class="line"><span class="variable">$PREFIX</span>/bin/wget https://its-pointless.github.io/setup-pointless-repo.sh</span><br><span class="line">bash setup-pointless-repo.sh</span><br></pre></td></tr></table></figure></p>
<ul>
<li>库包括 gcc-7,gfortran，octave，r-cran（R语言），rustc，scipy 和许多游戏.</li>
</ul>
<h2><a href="https://github.com/thioshp/termux-extra-packages" target="_blank" rel="noopener">Extra</a></h2>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将PGP密钥添加到APT的密钥环中</span></span><br><span class="line">pkg install dirmngr</span><br><span class="line">apt-key adv --keyserver pool.sks-keyservers.net --recv 9D6D488416B493F0</span><br></pre></td></tr></table></figure></p>
<h3>手动下载公钥并添加它</h3>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -LO https://raw.githubusercontent.com/xeffyr/termux-extra-packages/master/pubkey.asc</span><br><span class="line">apt-key add pubkey.asc</span><br></pre></td></tr></table></figure></p>
<ul>
<li><code>apt edit-sources</code> 加入下方内容</li>
</ul>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Xeffyr's Extra packages</span></span><br><span class="line">deb https://termux.xeffyr.ml/ extra main x11</span><br></pre></td></tr></table></figure></p>
<ul>
<li>库有　OpenJDK</li>
</ul>
<h1>修改启动问候语</h1>
<h2>修改</h2>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim <span class="variable">$PREFIX</span>/etc/motd</span><br></pre></td></tr></table></figure></p>
<h2>不显示</h2>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">touch ~/.hushlogin</span><br></pre></td></tr></table></figure></p>
<h1>恢复双层键盘</h1>
<p>Termux在 0.66 取消了双层键盘</p>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir <span class="variable">$HOME</span>/.termux</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"extra-keys = [['ESC','/','-','HOME','UP','END','PGUP'],['TAB','CTRL','ALT','LEFT','DOWN','RIGHT','PGDN']]"</span> &gt;&gt; <span class="variable">$HOME</span>/.termux/termux.properties</span><br></pre></td></tr></table></figure></p>
<h1>管理员权限 root 问题</h1>
<h2>虚拟管理员(未root)</h2>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pkg install proot</span><br><span class="line">termux-chroot <span class="comment"># 启动命令</span></span><br></pre></td></tr></table></figure></p>
<ul>
<li>模拟root环境的同时，还会模拟linux的文件路径。</li>
<li>普通文件路径是【/data/data/com.termux/file/home】</li>
<li>开启后的文件路径是【/home】</li>
</ul>
<h2>真实管理员(已root)</h2>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pkg install tsu</span><br><span class="line">tsu <span class="comment"># 启动命令</span></span><br></pre></td></tr></table></figure></p>
<ul>
<li>执行后文件路径不变，因此可以进入手机的任何一个目录</li>
</ul>
<h1>安装 SSH</h1>
<p>安装
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt install openssh</span><br></pre></td></tr></table></figure></p>
<h2>设置 SSH Key</h2>
<p>配置账户信息</p>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name <span class="string">"UserName"</span></span><br><span class="line">git config --global user.email <span class="string">"email@example.com"</span></span><br></pre></td></tr></table></figure></p>
<h2>创建 SSH Key</h2>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C <span class="string">"email@example.com"</span></span><br></pre></td></tr></table></figure></p>
<h2>复制 Key</h2>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat ~/.ssh/id_rsa.pub</span><br></pre></td></tr></table></figure></p>
<h2>验证 SSH</h2>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -T git@github.com</span><br></pre></td></tr></table></figure></p>
<h2>SSH 基础使用</h2>
<h3>远程主机登录</h3>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ssh root@host</span><br><span class="line">ssh host</span><br><span class="line"><span class="comment">#本地用户名与远程用户名一致，登录时可以省略用户名</span></span><br><span class="line">ssh -p 2222 root@host</span><br><span class="line"><span class="comment"># SSH 的默认端口是22，使用 p 参数，可以修改这个端口。</span></span><br></pre></td></tr></table></figure></p>
<h3>公钥登录</h3>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh-copy-id user@host</span><br><span class="line"><span class="comment">#将公钥传送到远程主机 host 上面</span></span><br></pre></td></tr></table></figure></p>
<ul>
<li>如果还是不行，就打开远程主机的 <code>/etc/ssh/sshd_config</code> 这个文件，检查下面几行前面&quot;#&quot;注释是否取掉。</li>
</ul>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">RSAAuthentication yes</span><br><span class="line">PubkeyAuthentication yes</span><br><span class="line">AuthorizedKeysFile</span><br><span class="line">.ssh/authorized_keys</span><br></pre></td></tr></table></figure></p>
<ul>
<li>然后，重启远程主机的ssh服务。
<ul>
<li>Ubuntu系统 service ssh restart</li>
<li>Debian系统 /etc/init.d/ssh restart</li>
</ul>
</li>
</ul>
<h1>Oh My ZSH</h1>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apt install git zsh curl -y</span><br><span class="line">sh -c <span class="string">"<span class="variable">$(curl -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh)</span>"</span></span><br><span class="line">chsh -s zsh</span><br></pre></td></tr></table></figure></p>
<h1>OpenJDK</h1>
<ul>
<li>JDK1.8
<ul>
<li><a href="https://drive.google.com/file/d/1PdNqmLrhFlBoRlpCW-mC6CHbVS_Lva9D/view?usp=drivesdk" target="_blank" rel="noopener">aarch64谷歌云盘</a></li>
<li><a href="https://pan.baidu.com/s/14T-2L2j3gZaxfbwkZxJxqg" target="_blank" rel="noopener">aarch64百度云盘密码:ryea</a></li>
</ul>
</li>
<li>JDK1.9
<ul>
<li><s><a href="https://drive.google.com/file/d/1U3o34Z3aI_g8mvkJ2gP3YfBB6aaQS1xK/view?usp=drivesdk" target="_blank" rel="noopener">aarch64下载</a></s></li>
</ul>
</li>
</ul>
<h2>安装</h2>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> storage/下载目录</span><br><span class="line">dpkg -i openjdk9_9.2017.8.20_aarch64.deb</span><br></pre></td></tr></table></figure></p>
<h2>Java 8</h2>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/ivitan/Shell/releases/download/Java/java8.deb -O ~/Java.deb</span><br><span class="line">dpkg -i ~/Java.deb</span><br><span class="line">rm -rf ~/Java.deb</span><br></pre></td></tr></table></figure></p>
<h1>安装 Nodejs</h1>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pkg install nodejs</span><br><span class="line">pkg install nodejs-lts</span><br></pre></td></tr></table></figure></p>
<h2>解决 npm 出现 npm err! cannot read property ‘length’ of undefined 问题</h2>
<ul>
<li>复制下面内容</li>
</ul>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(require(<span class="string">'os'</span>).cpus() || &#123; length: 1 &#125;).length</span><br></pre></td></tr></table></figure></p>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim ../usr/lib/node_modules/npm/node_modules/worker-farm/lib/farm.js</span><br></pre></td></tr></table></figure></p>
<ul>
<li>修改如下</li>
</ul>
<p><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/ivitan/Picture/master/images/5b3044e8a329d.jpg" alt title>
                </div>
                <div class="image-caption"></div>
            </figure></p>
<h1>安装 Hexo</h1>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mkdir blog</span><br><span class="line"><span class="built_in">cd</span> blog</span><br><span class="line">npm install hexo-cli -g</span><br><span class="line">npm init</span><br><span class="line">npm install</span><br><span class="line">npm install hexo-deployer-git</span><br><span class="line">hexo g      <span class="comment">#生成静态文件</span></span><br><span class="line">hexo s      <span class="comment">#启动 Hexo</span></span><br><span class="line">hexo d      <span class="comment">#部署到 Github</span></span><br><span class="line">hexo new <span class="string">"my blog"</span> <span class="comment">#新建文章</span></span><br><span class="line">hexo s      <span class="comment">#开启本地服务</span></span><br><span class="line">hexo clean  <span class="comment">#清除 public</span></span><br><span class="line">npm update -g <span class="comment">#版本更新</span></span><br></pre></td></tr></table></figure></p>
<h1>Mariadb(MySQL)</h1>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pkg install mariadb</span><br></pre></td></tr></table></figure></p>
<h2>安装基本数据</h2>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql_install_db</span><br></pre></td></tr></table></figure></p>
<ul>
<li>mysqld: Can't read dir ofソdata/data/com . termux/files/usr/e tc/my.cnf.d' (Errcode: 2 &quot;No such file or directory&quot;) Fatal error in defaults handling. Program aborted
<ul>
<li>先在<code>my.cnf</code>所在目录下新建<code>my.cnf.d</code>文件夹，然后执行<code>mysql_install_db</code></li>
</ul>
</li>
</ul>
<h2>启动 Mariadb 服务</h2>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqld</span><br></pre></td></tr></table></figure></p>
<ul>
<li>启动mysql后，该回话便无法进行任何操作，需要左滑唤醒会话菜单，开启新的回话。而倘若不在一个会话里启动mysqld，而是直接运行mysql，则会2002错误。</li>
</ul>
<h2>修改密码</h2>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql_secure_installation</span><br><span class="line"><span class="comment"># 输入旧密码，空则直接回车</span></span><br><span class="line">Set root password? [Y/n] y</span><br><span class="line">New password:</span><br><span class="line">Re-enter new password:<span class="comment"># 两次输入新密码</span></span><br><span class="line"></span><br><span class="line">Remove anonymous users? [Y/n] Y <span class="comment">#是否移除匿名用户</span></span><br><span class="line">Disallow root login remotely? [Y/n] n <span class="comment">#是否不允许root远程登录</span></span><br><span class="line">Remove <span class="built_in">test</span> database and access to it? [Y/n] n <span class="comment">#是否移除test数据库</span></span><br><span class="line">Reload privilege tables now? [Y/n] y <span class="comment">#是否重新加载表的权限</span></span><br></pre></td></tr></table></figure></p>
<h2>登录 MySQL</h2>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -p</span><br><span class="line">Enter password: ***apache2</span><br></pre></td></tr></table></figure></p>
<ul>
<li>或者使用</li>
</ul>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -p******</span><br></pre></td></tr></table></figure></p>
<h1>Python 环境部署</h1>
<h2>Python 2</h2>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pkg install python2</span><br></pre></td></tr></table></figure></p>
<h2>Python 3</h2>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pkg install python</span><br></pre></td></tr></table></figure></p>
<h2>升级 pip 版本</h2>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python2 -m pip install --upgrade pip</span><br><span class="line">python -m pip install --upgrade pip</span><br></pre></td></tr></table></figure></p>
<p>pip 版本查看
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip -v</span><br><span class="line">pip3.6 -v</span><br></pre></td></tr></table></figure></p>
<h2>ipython</h2>
<p>ipython 是一个 python 的交互式 shell，支持变量自动补全，自动缩进，支持 bash shell 命令，内置了许多很有用的功能和函数。学习 ipython 将会让我们以一种更高的效率来使用 python。
先安装clang, 否则直接使用pip安装ipython会失败报错.</p>
<ul>
<li>安装</li>
</ul>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pkg install clang</span><br><span class="line">pip install ipython</span><br><span class="line">pip3.6 install ipython</span><br></pre></td></tr></table></figure></p>
<ul>
<li>使用</li>
</ul>
<p>别使用<code>ipython</code>和<code>ipython2</code>进入<code>py2</code>和<code>py3</code>控制台:</p>
<h1>PHP部署</h1>
<h2>安装</h2>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pkg install php <span class="comment"># 可采用phpinfo进行测试</span></span><br><span class="line">php -S 127.0.0.1:8080 -t www/</span><br></pre></td></tr></table></figure></p>
<ul>
<li>编写测试文件</li>
</ul>
<ol>
<li>在家目录下建一个www文件夹: <code>mkdir www</code></li>
<li>在www文件夹下新建一个 <code>index.php</code> 文件, 其内容为</li>
</ol>
<p><figure class="highlight php"><figcaption><span>index.php</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> phpinfo();<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p>
<h1>Nmap(口扫描必备工具)</h1>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pkg install nmap</span><br></pre></td></tr></table></figure></p>
<h1>hydra</h1>
<p>Hydra 是著名的黑客组织 THC 的一款开源暴力破解工具这是一个验证性质的工具，主要目的是：展示安全研究人员从远程获取一个系统认证权限。</p>
<ul>
<li>安装</li>
</ul>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pkg install hydra</span><br></pre></td></tr></table></figure></p>
<h1>sslscan</h1>
<p>SSLscan 主要探测基于 ssl 的服务，如 https。SSLscan 是一款探测目标服务器所支持的 SSL 加密算法工具。</p>
<ul>
<li>安装</li>
</ul>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pkg install sslscan</span><br></pre></td></tr></table></figure></p>
<h1>whatportis</h1>
<p>whatportis 是一款可以通过服务查询默认端口，或者是通过端口查询默认服务的工具，简单易用。在渗透测试过程中，如果需要查询某个端口绑定什么服务器，或者某个应用绑定的默认端口，可以使用 whatportis 查询。</p>
<ul>
<li>安装</li>
</ul>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip2 install whatportis</span><br></pre></td></tr></table></figure></p>
<h1>RouterSploit</h1>
<p>RouteSploit 框架是一款开源的路由器等嵌入式设备漏洞检测及利用框架。</p>
<ul>
<li>安装</li>
</ul>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pip2 install requests</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/reverse-shell/routersploit</span><br><span class="line"><span class="built_in">cd</span> routersploit</span><br><span class="line">python2 rsf.py</span><br></pre></td></tr></table></figure></p>
<h1>Slowloris 低带宽的 DoS 工具</h1>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/gkbrk/slowloris.git</span><br><span class="line"><span class="built_in">cd</span> slowloris</span><br><span class="line">chmod +x slowloris.py</span><br></pre></td></tr></table></figure></p>
<hr>
<p><strong>参考</strong></p>
<ul>
<li><a href="https://wiki.termux.com/wiki/Package_Management" target="_blank" rel="noopener">Termux Wike</a></li>
<li><a href="http://www.liuxi.site/2018/05/16/android%E4%B8%8A%E7%9A%84%E7%BB%88%E7%AB%AF%E2%80%94%E2%80%94termux/" target="_blank" rel="noopener">android上的终端——termux</a></li>
<li><a href="http://www.sqlsec.com/2018/05/termux.html" target="_blank" rel="noopener">Termux 高级终端安装使用配置教程</a></li>
</ul>

      

          <a href="/posts/Termux.html" class="post-more waves-effect waves-button">
            <i class="icon icon-bookmark">&nbsp;</i> 阅读全文…
          </a>
      </div>
      
      <div class="post-footer">
          
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Termux/">Termux</a></li></ul>

      </div>
      
  </article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-GitReset"
    class="article-card article-type-post" itemprop="blogPost">

      <div class="post-meta">
          <time class="post-time" title="2020-03-05 10:45:08" datetime="2020-03-05T02:45:08.000Z"  itemprop="datePublished"><i class="icon icon-calendar"></i> 2020-03-05</time>

          
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Coding/">Coding</a></li></ul>



          
      </div>

      


  
    <h3 class="post-title" itemprop="name">
      <a class="post-title-link" href="/posts/GitReset.html">Git 版本回退</a>
    </h3>
  



      <div class="post-content" id="post-content" itemprop="postContent">

      
          <blockquote>
<p>Git 版本回退</p>
</blockquote>
<h1>本地替换为远程</h1>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git fetch --all</span><br><span class="line">git reset --hard origin/master</span><br><span class="line">git pull</span><br></pre></td></tr></table></figure></p>
<p>&lt;!--more--&gt;</p>
<h1>撤销</h1>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># 撤销所有的已经add的文件:</span><br><span class="line">git reset HEAD .</span><br><span class="line"></span><br><span class="line"># 撤销某个文件或文件夹</span><br><span class="line">git reset HEAD -filename</span><br><span class="line"></span><br><span class="line"># 回退到上个版本</span><br><span class="line">git reset --hard HEAD^ </span><br><span class="line"></span><br><span class="line"># 退到/进到 指定commit_id</span><br><span class="line">git reset --hard commit_id</span><br></pre></td></tr></table></figure></p>
<ul>
<li>文件被修改了，但未执行git add操作（working tree内撤销）</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git checkout fileName</span><br><span class="line">git checkout .</span><br></pre></td></tr></table></figure></p>
<ul>
<li>同时对多个文件执行了git add操作，但本次只想提交其中一部分文件</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git add *</span><br><span class="line">git status</span><br><span class="line">git reset HEAD &lt;filename&gt;</span><br></pre></td></tr></table></figure></p>
<ul>
<li>文件执行了git add操作，但想撤销对其的修改（index内回滚）</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 取消暂存</span><br><span class="line">git reset HEAD fileName</span><br><span class="line"># 撤销修改</span><br><span class="line">git checkout fileName</span><br></pre></td></tr></table></figure></p>
<ul>
<li>修改的文件已被git commit，但想再次修改不再产生新的Commit</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 修改最后一次提交 </span><br><span class="line">git add sample.txt</span><br><span class="line">git commit --amend -m&quot;说明&quot;</span><br></pre></td></tr></table></figure></p>
<ul>
<li>已在本地进行了多次git commit操作，现在想撤销到其中某次Commit</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git reset [--hard|soft|mixed|merge|keep] [commit|HEAD]</span><br></pre></td></tr></table></figure></p>

      

          <a href="/posts/GitReset.html" class="post-more waves-effect waves-button">
            <i class="icon icon-bookmark">&nbsp;</i> 阅读全文…
          </a>
      </div>
      
      <div class="post-footer">
          
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Git/">Git</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Win/">Win</a></li></ul>

      </div>
      
  </article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-PixelDiag"
    class="article-card article-type-post" itemprop="blogPost">

      <div class="post-meta">
          <time class="post-time" title="2020-03-04 08:29:15" datetime="2020-03-04T00:29:15.000Z"  itemprop="datePublished"><i class="icon icon-calendar"></i> 2020-03-04</time>

          
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Coding/">Coding</a></li></ul>



          
      </div>

      


  
    <h3 class="post-title" itemprop="name">
      <a class="post-title-link" href="/posts/PixelDiag.html">Pixel 2 XL 开启 Diag</a>
    </h3>
  



      <div class="post-content" id="post-content" itemprop="postContent">

      
          <blockquote>
<p>Pixel 2 XL 开启 Diag 破解电信 VoLTE</p>
</blockquote>
<h1>开启端口</h1>
<ol>
<li>安装 Diag Magisk 并输入模块</li>
<li>刷入 Pixel_2_Diag_Port.zip</li>
<li>刷入 VoEnabler-v1.4.zip</li>
<li>连接电脑，输入以下命令开启 Diag 端口</li>
</ol>
<p>&lt;!--more--&gt;</p>
<p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cd D:\adb</span><br><span class="line">adb devices</span><br><span class="line">adb shell</span><br><span class="line">su</span><br><span class="line">setenforce 0</span><br><span class="line">setprop sys.usb.configfs 1 &amp;&amp; setprop sys.usb.config diag,serial_cdev,rmnet_gsi,adb</span><br></pre></td></tr></table></figure></p>
<ul>
<li>su命令需要在手机端 Magisk 确认 root 授权，成功会在设备管理器的端口中看到高通 9091</li>
</ul>
<h1>电信 VoLTE</h1>
<ul>
<li>其他运营商的配置文件方法一样</li>
</ul>
<ol>
<li>安装 QPST</li>
<li>打开 QPST 的 PDC 选择 9091 端口</li>
<li>点击Load加载运营商配置文件mcfg_sw.mbn，建议使用commerci/hvolte_o/mcfg_sw.mbn，</li>
<li>加载出运营商配置文件后，右击该配置，指配到 sub0，最后点激活 active，将会不重启直接开启 VoLTE 模式</li>
</ol>
<h1>所需工具</h1>
<p><a href="https://pan.baidu.com/s/1gDZMKuqvrMsAg7zEjKr5sw" target="_blank" rel="noopener">提取码: j3sc</a></p>

      

          <a href="/posts/PixelDiag.html" class="post-more waves-effect waves-button">
            <i class="icon icon-bookmark">&nbsp;</i> 阅读全文…
          </a>
      </div>
      
      <div class="post-footer">
          
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Win/">Win</a></li></ul>

      </div>
      
  </article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-UsbDriver"
    class="article-card article-type-post" itemprop="blogPost">

      <div class="post-meta">
          <time class="post-time" title="2020-02-25 10:59:14" datetime="2020-02-25T02:59:14.000Z"  itemprop="datePublished"><i class="icon icon-calendar"></i> 2020-02-25</time>

          
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Diary/">Diary</a></li></ul>



          
      </div>

      


  
    <h3 class="post-title" itemprop="name">
      <a class="post-title-link" href="/posts/UsbDriver.html">安装 Google USB Driver</a>
    </h3>
  



      <div class="post-content" id="post-content" itemprop="postContent">

      
          <blockquote>
<p>Google USB Driver 是对 Google 设备执行 adb 调试的驱动。</p>
</blockquote>
<h1>下载</h1>
<ul>
<li><a href="https://dl-ssl.google.com//android/repository/latest_usb_driver_windows.zip" target="_blank" rel="noopener">Windows latest_usb_driver_windows.zip</a></li>
</ul>
<h1>安装</h1>
<p>设备管理器 -&gt; 便携设备 -&gt; 属性 -&gt; 驱动程序 -&gt; 更新驱动程序 -&gt; 选择解压好的文件夹</p>

      

          <a href="/posts/UsbDriver.html" class="post-more waves-effect waves-button">
            <i class="icon icon-bookmark">&nbsp;</i> 阅读全文…
          </a>
      </div>
      
      <div class="post-footer">
          
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Win/">Win</a></li></ul>

      </div>
      
  </article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-Cmder"
    class="article-card article-type-post" itemprop="blogPost">

      <div class="post-meta">
          <time class="post-time" title="2020-01-08 13:40:15" datetime="2020-01-08T05:40:15.000Z"  itemprop="datePublished"><i class="icon icon-calendar"></i> 2020-01-08</time>

          
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Coding/">Coding</a></li></ul>



          
      </div>

      


  
    <h3 class="post-title" itemprop="name">
      <a class="post-title-link" href="/posts/Cmder.html">Cmder 配置</a>
    </h3>
  



      <div class="post-content" id="post-content" itemprop="postContent">

      
          <h1>使用 Bash</h1>
<p><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/ivitan/Picture/master/images/cmder_bash.png" alt title>
                </div>
                <div class="image-caption"></div>
            </figure></p>
<p>&lt;!--more--&gt;</p>
<h1>配置</h1>
<p><figure class="highlight bash"><figcaption><span>D:\cmder\config\user_profile.sh</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 别名</span></span><br><span class="line"><span class="comment">#打开当前文件夹</span></span><br><span class="line"><span class="built_in">alias</span> e.=<span class="string">'explorer .'</span></span><br><span class="line"><span class="built_in">alias</span> ls=<span class="string">'ls --show-control-chars -F --color $*'</span></span><br><span class="line"><span class="built_in">alias</span> clear=cls</span><br><span class="line"><span class="built_in">alias</span> gl=<span class="string">'git pull origin $1'</span></span><br><span class="line"><span class="built_in">alias</span> glm=<span class="string">'git pull origin master'</span></span><br><span class="line"><span class="built_in">alias</span> gp=<span class="string">'git push origin $1'</span></span><br><span class="line"><span class="built_in">alias</span> gpm=<span class="string">'git push origin master'</span></span><br><span class="line"><span class="built_in">alias</span> cpd=<span class="string">'cap production deploy'</span></span><br><span class="line"><span class="built_in">alias</span> cpt=<span class="string">'cap staging deploy'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Git Commit, Add all and Push — in one step.</span></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">gcap</span></span>() &#123;</span><br><span class="line">    git add . &amp;&amp; git commit -m <span class="string">"$*"</span> &amp;&amp; git push</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># NEW.</span></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">gnew</span></span>() &#123;</span><br><span class="line">    gcap <span class="string">"📦 NEW: <span class="variable">$@</span>"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># IMPROVE.</span></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">gimp</span></span>() &#123;</span><br><span class="line">    gcap <span class="string">"👌 IMPROVE: <span class="variable">$@</span>"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># FIX.</span></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">gfix</span></span>() &#123;</span><br><span class="line">    gcap <span class="string">"🐛 FIX: <span class="variable">$@</span>"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># RELEASE.</span></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">grlz</span></span>() &#123;</span><br><span class="line">    gcap <span class="string">"🚀 RELEASE: <span class="variable">$@</span>"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># DOC.</span></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">gdoc</span></span>() &#123;</span><br><span class="line">    gcap <span class="string">"📖 DOC: <span class="variable">$@</span>"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># TEST.</span></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">gtst</span></span>() &#123;</span><br><span class="line">    gcap <span class="string">"✅ TEST: <span class="variable">$@</span>"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

      

          <a href="/posts/Cmder.html" class="post-more waves-effect waves-button">
            <i class="icon icon-bookmark">&nbsp;</i> 阅读全文…
          </a>
      </div>
      
      <div class="post-footer">
          
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Win/">Win</a></li></ul>

      </div>
      
  </article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-TermuxConfig"
    class="article-card article-type-post" itemprop="blogPost">

      <div class="post-meta">
          <time class="post-time" title="2020-01-08 12:11:49" datetime="2020-01-08T04:11:49.000Z"  itemprop="datePublished"><i class="icon icon-calendar"></i> 2020-01-08</time>

          
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Coding/">Coding</a></li></ul>



          
      </div>

      


  
    <h3 class="post-title" itemprop="name">
      <a class="post-title-link" href="/posts/TermuxConfig.html">Termux Config Shell</a>
    </h3>
  



      <div class="post-content" id="post-content" itemprop="postContent">

      
          <blockquote>
<p>写的一个 Termux 配置脚本，配置开发环境、美化等...</p>
</blockquote>
<h2>via curl</h2>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt install curl</span><br><span class="line">bash -c <span class="string">"<span class="variable">$(curl -fsSL https://raw.githubusercontent.com/ivitan/Shell/master/Termux/Termux.sh)</span>"</span></span><br></pre></td></tr></table></figure></p>
<h2>via wget</h2>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt install wget</span><br><span class="line">bash -c <span class="string">"<span class="variable">$(wget -O- https://raw.githubusercontent.com/ivitan/Shell/master/Termux/Termux.sh)</span>"</span></span><br></pre></td></tr></table></figure></p>

      

          <a href="/posts/TermuxConfig.html" class="post-more waves-effect waves-button">
            <i class="icon icon-bookmark">&nbsp;</i> 阅读全文…
          </a>
      </div>
      
      <div class="post-footer">
          
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Win/">Win</a></li></ul>

      </div>
      
  </article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-WNMP"
    class="article-card article-type-post" itemprop="blogPost">

      <div class="post-meta">
          <time class="post-time" title="2019-12-23 13:42:58" datetime="2019-12-23T05:42:58.000Z"  itemprop="datePublished"><i class="icon icon-calendar"></i> 2019-12-23</time>

          
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Coding/">Coding</a></li></ul>



          
      </div>

      


  
    <h3 class="post-title" itemprop="name">
      <a class="post-title-link" href="/posts/WNMP.html">WNMP 环境配置</a>
    </h3>
  



      <div class="post-content" id="post-content" itemprop="postContent">

      
          <h1>Github 仓库</h1>
<p>https://github.com/ivitan/wnmp</p>
<h1>下载</h1>
<ol>
<li><a href="http://nginx.org/en/download.html" target="_blank" rel="noopener">Nginx</a></li>
<li><a href="http://windows.php.net/download/" target="_blank" rel="noopener">PHP</a></li>
<li><a href="http://dev.mysql.com/get/Downloads/MySQL-5.7/mysql-5.7.17-winx64.zip" target="_blank" rel="noopener">MySQL</a></li>
</ol>
<p>&lt;!--more--&gt;</p>
<h1>Nignx</h1>
<ol>
<li>解压 Nignx 到 D:\DevEnv\Nignx</li>
<li>运行 D:\DevEnv\Nignx 下的 nginx.exe</li>
<li>打开浏览器访问 http://localhost 或 http://127.0.0.1</li>
</ol>
<p><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://i.loli.net/2019/12/23/TuIFyje98l4qXvi.png" alt="nginx.png" title>
                </div>
                <div class="image-caption">nginx.png</div>
            </figure></p>
<ol start="4">
<li>配置</li>
</ol>
<p><figure class="highlight bat"><figcaption><span>D:\WNMP\Nignx\nginx.cof</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">#user  nobody;</span><br><span class="line">worker_processes  auto;</span><br><span class="line"></span><br><span class="line">#error_log  logs/error.log;</span><br><span class="line">#error_log  logs/error.log  notice;</span><br><span class="line">#error_log  logs/error.log  info;</span><br><span class="line"></span><br><span class="line">#pid        logs/nginx.pid;</span><br><span class="line"></span><br><span class="line">events &#123;</span><br><span class="line">    worker_connections  <span class="number">1024</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">http &#123;</span><br><span class="line">    include       mime.types;</span><br><span class="line">    #default_type  application/octet-stream;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    autoindex on;</span><br><span class="line">    autoindex_exact_size off;</span><br><span class="line">    autoindex_localtime on;</span><br><span class="line"></span><br><span class="line">    log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '</span><br><span class="line">                      '$status $body_bytes_sent "$http_referer" '</span><br><span class="line">                      '"$http_user_agent" "$http_x_forwarded_for"';</span><br><span class="line">    #access_log  logs/access.log  main;</span><br><span class="line">    sendfile        on;</span><br><span class="line">    #tcp_nopush     on;</span><br><span class="line">    #keepalive_timeout  <span class="number">0</span>;</span><br><span class="line">    keepalive_timeout  <span class="number">65</span>;</span><br><span class="line">    #gzip  on;</span><br><span class="line">	include vhost/*.conf;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><figure class="highlight bash"><figcaption><span>D:\WNMP\Nignx\conf\vhost\default.cof</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    server_name localhost;</span><br><span class="line">    root www/;</span><br><span class="line">    location / &#123;</span><br><span class="line">        index index.php index.html index.htm;</span><br><span class="line">        try_files <span class="variable">$uri</span> <span class="variable">$uri</span>/ /index.php?<span class="variable">$query_string</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    location ~ \.php$ &#123;</span><br><span class="line">        fastcgi_pass 127.0.0.1:9000;</span><br><span class="line">        fastcgi_index index.php;</span><br><span class="line">        fastcgi_param SCRIPT_FILENAME <span class="variable">$document_root</span><span class="variable">$fastcgi_script_name</span>;</span><br><span class="line">        include fastcgi_params;</span><br><span class="line">    &#125;</span><br><span class="line">    access_log logs/access.log main;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2>常用命令</h2>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">nginx -s stop	快速关闭Nginx</span><br><span class="line">nginx -s quit	优雅的关闭Nginx</span><br><span class="line">nginx -s reload 更改配置，使用新配置启动新工作进程，正常关闭旧工作进程</span><br><span class="line">nginx -s reopen 重新打开日志文件</span><br></pre></td></tr></table></figure></p>
<h1>MySQL</h1>
<h2>配置</h2>
<p><figure class="highlight bash"><figcaption><span>%mysql%\my.ini</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">character-set-server=utf8</span><br><span class="line"><span class="comment">#绑定IPv4和3306端口</span></span><br><span class="line">port = 3306</span><br><span class="line"><span class="comment"># 设置mysql的安装目录</span></span><br><span class="line">basedir=D:/WorkPlace/WNMP/mysql</span><br><span class="line"><span class="comment"># 设置mysql数据库的数据的存放目录</span></span><br><span class="line">datadir=D:/WorkPlace/WNMP/mysql/data</span><br><span class="line"><span class="comment"># 允许最大连接数</span></span><br><span class="line">max_connections=2000</span><br><span class="line"><span class="comment"># skip_grant_tables</span></span><br><span class="line">[mysql]</span><br><span class="line">default-character-set=utf8</span><br><span class="line">[mysql.server]</span><br><span class="line">default-character-set=utf8</span><br><span class="line">[mysql_safe]</span><br><span class="line">default-character-set=utf8</span><br><span class="line">[client]</span><br><span class="line">default-character-set=utf8</span><br></pre></td></tr></table></figure></p>
<h2>安装</h2>
<p><figure class="highlight bash"><figcaption><span>%mysql%\bin</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqld.exe -install</span><br></pre></td></tr></table></figure></p>
<p>提示：Service successfully installed. 表示安装成功.</p>
<h3>初始化 MySQL 数据</h3>
<p>创建一个具有空密码的root用户
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqld <span class="comment">--initialize-insecure --user=mysql</span></span><br></pre></td></tr></table></figure></p>
<ul>
<li>最后的参数 --user=mysql 在 windows 也可以不用添加</li>
<li>但在 unix 等系统下好像很重要。</li>
<li>执行命令后系统会自动生成相应的 data 目录，并自动创建好空密码的 root 用户。</li>
</ul>
<h2>启动mysql服务</h2>
<p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">net</span> <span class="built_in">start</span> mysql</span><br></pre></td></tr></table></figure></p>
<h2>进行密码设定</h2>
<p>可执行如下命令：
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysqladmin -u root -p password NewPassword</span><br><span class="line"></span><br><span class="line">password: <span class="comment"># OldPassword</span></span><br></pre></td></tr></table></figure></p>
<ul>
<li>在输入旧密码（或没改过密码的就直接回车）</li>
<li>系统很久没响应，然后报错（10060）。 原因：mysql没有通过windows防火墙 解决方法：将 D:\mysql\bin\mysqld.exe 添加到windows防火墙允许通过的应用中。</li>
</ul>
<h1>PHP</h1>
<ol>
<li>解压 PHP 到 D:\DevEnv\PHP</li>
<li>修改配置，将 D:\PHP\php.ini-development 改为 php.ini,取消下面注释</li>
</ol>
<p><figure class="highlight bat"><figcaption><span>D:\PHP\php.ini</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">;extension=mysql</span><br><span class="line">;extension=mysqli</span><br><span class="line">;enable_dl = Off，改为 enable_dl = On</span><br><span class="line">;fastcgi.impersonate = <span class="number">1</span></span><br><span class="line">;extension=curl</span><br><span class="line">;extension=gd2</span><br><span class="line">;extension=mbstring</span><br><span class="line">;extension=mysqli</span><br><span class="line">;extension=mysql</span><br></pre></td></tr></table></figure></p>
<p>去 <code>;</code> 再修改</p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">;extension_dir = "ext" 改为 extension_dir = "D:\wnmp\php\ext"</span><br><span class="line">;<span class="built_in">date</span>.timezone = 改为<span class="built_in">date</span>.timezone = Asia/Shanghai</span><br><span class="line">;cgi.force_redirect = <span class="number">1</span> 改为cgi.force_redirect = <span class="number">0</span></span><br><span class="line">;cgi.rfc2616_headers = <span class="number">0</span> 改为 cgi.rfc2616_headers = <span class="number">1</span></span><br></pre></td></tr></table></figure></p>
<ol start="3">
<li>
<p>配置 PHP，使其能与 Nginx 配合，取消下面的注释
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">;cgi.fix_pathinfo=<span class="number">1</span></span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>启动PHP
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">D:\<span class="title">WNMP</span>\<span class="title">php</span>\<span class="title">php</span>-<span class="title">cli.exe</span> -<span class="title">b</span> 127.0.1.1:9000 -<span class="title">c</span> <span class="title">D</span>:\<span class="title">WNMP</span>\<span class="title">php</span>\<span class="title">php.ini</span></span></span><br></pre></td></tr></table></figure></p>
</li>
</ol>
<h2>php.ini 配置</h2>
<p>https://github.com/ivitan/wnmp/blob/master/php/php-7.2.25/php.ini</p>
<h1>脚本</h1>
<h2>环境变量</h2>
<p>环境变量Path里面增加 MySQL、Nginx、PHP 执行文件的路径
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">;D:\wnmp\mysql\bin;D:\wnmp\nginx;D:\wnmp\php;</span><br></pre></td></tr></table></figure></p>
<h2>启动 WNMP</h2>
<p><figure class="highlight cmd"><figcaption><span>stat.bat</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"><span class="built_in">set</span> base_path=<span class="variable">%cd%</span></span><br><span class="line"><span class="built_in">set</span> nginx_path=<span class="variable">%base_path%</span>\nginx</span><br><span class="line"><span class="built_in">set</span> php7_path=<span class="variable">%base_path%</span>\php\php-<span class="number">7</span>.<span class="number">2</span>.<span class="number">25</span></span><br><span class="line"><span class="built_in">set</span> mysql_path=<span class="variable">%base_path%</span>\mySql</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> Starting PHP7 FastCGI...</span><br><span class="line">RunHiddenConsole <span class="variable">%php7_path%</span>\php-cgi.exe -b <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">9000</span> -c <span class="variable">%php7_path%</span>\php.ini</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> Starting Nginx...</span><br><span class="line">RunHiddenConsole <span class="variable">%nginx_path%</span>\nginx.exe -c <span class="variable">%nginx_path%</span>\conf\nginx.conf</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> Starting MySql...</span><br><span class="line">RunHiddenConsole <span class="variable">%mysql_path%</span>\bin\mysqld --defaults-file=<span class="variable">%mysql_path%</span>\my.ini --port=<span class="number">3306</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> please open http://<span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> ...</span><br><span class="line"><span class="built_in">ping</span> -n <span class="number">3</span> <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> &gt; <span class="built_in">nul</span></span><br><span class="line"><span class="built_in">start</span> chrome  "design.vitan.me"</span><br><span class="line"><span class="keyword">exit</span></span><br></pre></td></tr></table></figure></p>
<h2>重启 WNMP</h2>
<p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"><span class="built_in">echo</span> Stopping Nginx...</span><br><span class="line"><span class="built_in">taskkill</span> /F /IM nginx.exe &gt; <span class="built_in">nul</span></span><br><span class="line"><span class="built_in">echo</span> Stopping PHP FastCGI...</span><br><span class="line"><span class="built_in">taskkill</span> /F /IM php-cgi.exe &gt; <span class="built_in">nul</span></span><br><span class="line"><span class="built_in">echo</span> Stopping Mysql...</span><br><span class="line"><span class="built_in">taskkill</span> /F /IM mysqld.exe &gt; <span class="built_in">nul</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> base_path=<span class="variable">%cd%</span></span><br><span class="line"><span class="built_in">set</span> nginx_path=<span class="variable">%base_path%</span>\nginx</span><br><span class="line"><span class="built_in">set</span> php7_path=<span class="variable">%base_path%</span>\php\php-<span class="number">7</span>.<span class="number">2</span>.<span class="number">25</span></span><br><span class="line"><span class="built_in">set</span> mysql_path=<span class="variable">%base_path%</span>\mysql</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> Starting PHP7 FastCGI...</span><br><span class="line">RunHiddenConsole <span class="variable">%php7_path%</span>\php-cgi.exe -b <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">9000</span> -c <span class="variable">%php7_path%</span>\php.ini</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> Starting Nginx...</span><br><span class="line">RunHiddenConsole <span class="variable">%nginx_path%</span>\nginx.exe -c <span class="variable">%nginx_path%</span>\conf\nginx.conf</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> Starting MySql...</span><br><span class="line">RunHiddenConsole <span class="variable">%mysql_path%</span>\bin\mysqld --defaults-file=<span class="variable">%mysql_path%</span>\my.ini --port=<span class="number">3306</span></span><br><span class="line"><span class="built_in">echo</span> please open http://<span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> ...</span><br><span class="line"><span class="built_in">ping</span> -n <span class="number">3</span> <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> &gt; <span class="built_in">nul</span></span><br><span class="line"><span class="built_in">start</span> chrome  "design.vitan.me"</span><br><span class="line"><span class="keyword">exit</span></span><br></pre></td></tr></table></figure></p>
<h2>关闭 WNMP</h2>
<p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"><span class="built_in">set</span> base_path=<span class="variable">%cd%</span></span><br><span class="line"><span class="built_in">set</span> nginx_path=<span class="variable">%base_path%</span>\nginx</span><br><span class="line"><span class="built_in">set</span> php7_path=<span class="variable">%base_path%</span>\php\php-<span class="number">7</span>.<span class="number">2</span>.<span class="number">25</span></span><br><span class="line"><span class="built_in">set</span> mysql_path=<span class="variable">%base_path%</span>\mySql</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> Starting PHP7 FastCGI...</span><br><span class="line">RunHiddenConsole <span class="variable">%php7_path%</span>\php-cgi.exe -b <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">9000</span> -c <span class="variable">%php7_path%</span>\php.ini</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> Starting Nginx...</span><br><span class="line">RunHiddenConsole <span class="variable">%nginx_path%</span>\nginx.exe -c <span class="variable">%nginx_path%</span>\conf\nginx.conf</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> Starting MySql...</span><br><span class="line">RunHiddenConsole <span class="variable">%mysql_path%</span>\bin\mysqld --defaults-file=<span class="variable">%mysql_path%</span>\my.ini --port=<span class="number">3306</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> please open http://<span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> ...</span><br><span class="line"><span class="built_in">ping</span> -n <span class="number">3</span> <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> &gt; <span class="built_in">nul</span></span><br><span class="line"><span class="built_in">start</span> chrome  "design.vitan.me"</span><br><span class="line"><span class="keyword">exit</span></span><br></pre></td></tr></table></figure></p>
<h1>整体测试</h1>
<ul>
<li>测试 PHP</li>
</ul>
<p><figure class="highlight php"><figcaption><span>D:\WNMP\www</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	phpinfo();	</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>浏览器访问 http://localhost/phpinfo.php</p>
<ul>
<li>测试 Mysql</li>
</ul>
<p><figure class="highlight php"><figcaption><span>D:\WNMP\www</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">	<span class="keyword">if</span> (mysqli_connect(<span class="string">"localhost"</span>,<span class="string">"root"</span>,<span class="string">"root"</span>)) &#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">"Mysql connect successful！"</span>;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">"Mysql connect error..."</span>;</span><br><span class="line">	&#125;</span><br><span class="line"> <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p>

      

          <a href="/posts/WNMP.html" class="post-more waves-effect waves-button">
            <i class="icon icon-bookmark">&nbsp;</i> 阅读全文…
          </a>
      </div>
      
      <div class="post-footer">
          
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PHP/">PHP</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Win/">Win</a></li></ul>

      </div>
      
  </article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-WinTask"
    class="article-card article-type-post" itemprop="blogPost">

      <div class="post-meta">
          <time class="post-time" title="2019-12-13 10:24:56" datetime="2019-12-13T02:24:56.000Z"  itemprop="datePublished"><i class="icon icon-calendar"></i> 2019-12-13</time>

          
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Coding/">Coding</a></li></ul>



          
      </div>

      


  
    <h3 class="post-title" itemprop="name">
      <a class="post-title-link" href="/posts/WinTask.html">Batch 计划任务</a>
    </h3>
  



      <div class="post-content" id="post-content" itemprop="postContent">

      
          <p>Batch 计划任务</p>
<h1>语法</h1>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SCHTASKS /Create [/S system [/U username [/P [password]]]]</span><br><span class="line">[/RU username [/RP password]] /SC schedule [/MO modifier] [/D day]</span><br><span class="line">[/M months] [/I idletime] /TN taskname /TR taskrun [/ST starttime]</span><br><span class="line">[/RI interval] [ &#123;/ET endtime | /DU duration&#125; [/K] [/XML xmlfile] [/V1]]</span><br><span class="line">[/SD startdate] [/ED enddate] [/IT | /NP] [/Z] [/F] [/HRESULT] [/?]</span><br></pre></td></tr></table></figure></p>
<p>&lt;!--more--&gt;</p>
<p>描述:允许管理员在本地或远程系统上创建计划任务。</p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks /create /tn TaskName /tr TaskRun /sc minute [/mo &#123;<span class="number">1</span> - <span class="number">1439</span>&#125;] [/st StartTime] [/sd StartDate] [/ed EndDate] [/s computer [/u [domain\]user /p password]] [/ru &#123;[Domain\]User | "System"&#125; [/rp Password]]</span><br></pre></td></tr></table></figure></p>
<h1>参数列表</h1>
<table>
<thead>
<tr>
<th style="text-align:center">参数</th>
<th style="text-align:center">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>/S system</code></td>
<td style="text-align:center">指定要连接到的远程系统。如果省略这个系统参数，默认是本地系统。</td>
</tr>
<tr>
<td style="text-align:center"><code>/U username</code></td>
<td style="text-align:center">指定应在其中执行 SchTasks.exe 的用户上下文。</td>
</tr>
<tr>
<td style="text-align:center"><code>/P [password]</code></td>
<td style="text-align:center">指定给定用户上下文的密码。如果省略则提示输入。</td>
</tr>
<tr>
<td style="text-align:center"><code>/RU username</code></td>
<td style="text-align:center">指定任务在其下运行的“运行方式”用户,帐户(用户上下文)。对于系统帐户，有效值是 &quot;&quot;、&quot;NT AUTHORITY\SYSTEM&quot; 或&quot;SYSTEM&quot;。对于 v2 任务，&quot;NT AUTHORITY\LOCALSERVICE&quot;和 &quot;NT AUTHORITY\NETWORKSERVICE&quot;以及常见的 SID 对这三个也都可用。</td>
</tr>
<tr>
<td style="text-align:center"><code>/RP [password]</code></td>
<td style="text-align:center">指定“运行方式”用户的密码。要提示输入密码，值必须是 &quot;*&quot; 或无。系统帐户会忽略该密码。必须和 /RU 或 /XML 开关一起使用。</td>
</tr>
<tr>
<td style="text-align:center"><code>/RU/XML /SC schedule</code></td>
<td style="text-align:center">指定计划频率。有效计划任务:  MINUTE、 HOURLY、DAILY、WEEKLY、 MONTHLY, ONCE, ONSTART, ONLOGON, ONIDLE, ONEVENT.</td>
</tr>
<tr>
<td style="text-align:center"><code>/MO modifier</code></td>
<td style="text-align:center">改进计划类型以允许更好地控制计划重复周期。有效值列于下面“修改者”部分中。</td>
</tr>
<tr>
<td style="text-align:center"><code>/D days</code></td>
<td style="text-align:center">指定该周内运行任务的日期。有效值:MON、TUE、WED、THU、FRI、SAT、SUN和对 MONTHLY 计划的 1 - 31(某月中的日期)。通配符“*”指定所有日期。</td>
</tr>
<tr>
<td style="text-align:center"><code>/M months</code></td>
<td style="text-align:center">指定一年内的某月。默认是该月的第一天。有效值: JAN、FEB、MAR、APR、MAY、JUN、JUL、 AUG、SEP、OCT、NOV  和 DEC。通配符 “*” 指定所有的月。</td>
</tr>
<tr>
<td style="text-align:center"><code>/I idletime</code></td>
<td style="text-align:center">指定运行一个已计划的 ONIDLE 任务之前要等待的空闲时间。有效值范围: 1 到 999 分钟。</td>
</tr>
<tr>
<td style="text-align:center"><code>/TN taskname</code></td>
<td style="text-align:center">以路径\名称形式指定对此计划任务进行唯一标识的字符串。</td>
</tr>
<tr>
<td style="text-align:center"><code>/TR taskrun</code></td>
<td style="text-align:center">指定在这个计划时间运行的程序的路径和文件名。例如: C:\windows\system32\calc.exe</td>
</tr>
<tr>
<td style="text-align:center"><code>/ST starttime</code></td>
<td style="text-align:center">指定运行任务的开始时间。时间格式为 HH:mm (24 小时时间)，例如 14:30 表示 2:30 PM。如果未指定 /ST，则默认值为当前时间。/SC ONCE 必需有此选项。</td>
</tr>
<tr>
<td style="text-align:center"><code>/RI interval</code></td>
<td style="text-align:center">用分钟指定重复间隔。这不适用于计划类型: MINUTE、HOURLY、ONSTART, ONLOGON, ONIDLE, ONEVENT.有效范围: 1 - 599940 分钟。如果已指定 /ET 或 /DU，则其默认值为10 分钟。</td>
</tr>
<tr>
<td style="text-align:center"><code>/ET endtime</code></td>
<td style="text-align:center">指定运行任务的结束时间。时间格式为 HH:mm (24 小时时间)，例如，14:50 表示 2:50 PM。这不适用于计划类型: ONSTART、ONLOGON, ONIDLE, ONEVENT.</td>
</tr>
<tr>
<td style="text-align:center"><code>/DU duration</code></td>
<td style="text-align:center">指定运行任务的持续时间。 时间格式为 HH:mm。这不适用于 /ET 和 计划类型: ONSTART, ONLOGON, ONIDLE, ONEVENT.对于 /V1 任务，如果已指定 /RI，则持续时间默认值为1 小时。</td>
</tr>
<tr>
<td style="text-align:center"><code>/K</code></td>
<td style="text-align:center">在结束时间或持续时间终止任务。这不适用于计划类型: ONSTART、ONLOGON, ONIDLE, ONEVENT.必须指定 /ET 或 /DU。</td>
</tr>
<tr>
<td style="text-align:center"><code>/SD startdate</code></td>
<td style="text-align:center">指定运行任务的第一个日期。格式为 yyyy/mm/dd。默认值为当前日期。这不适用于计划类型: ONCE、ONSTART, ONLOGON, ONIDLE, ONEVENT.</td>
</tr>
<tr>
<td style="text-align:center"><code>/ED enddate</code></td>
<td style="text-align:center">指定此任务运行的最后一天的日期。格式是 yyyy/mm/dd。这不适用于计划类型:ONCE、ONSTART、ONLOGON、ONIDLE。</td>
</tr>
<tr>
<td style="text-align:center"><code>/EC ChannelName</code></td>
<td style="text-align:center">为 OnEvent 触发器指定事件通道。</td>
</tr>
<tr>
<td style="text-align:center"><code>/IT</code></td>
<td style="text-align:center">仅有在 /RU 用户当前已登录且作业正在运行时才可以交互式运行任务。此任务只有在用户已登录的情况下才运行。</td>
</tr>
<tr>
<td style="text-align:center"><code>/NP</code></td>
<td style="text-align:center">不储存任何密码。任务以给定用户的身份非交互的方式运行。只有本地资源可用。</td>
</tr>
<tr>
<td style="text-align:center"><code>/Z</code></td>
<td style="text-align:center">标记在最终运行完任务后删除任务。</td>
</tr>
<tr>
<td style="text-align:center"><code>/XML xmlfile</code></td>
<td style="text-align:center">从文件的指定任务 XML 中创建任务。可以组合使用 /RU 和 /RP 开关，或者在任务 XML 已包含主体时单独使用 /RP。</td>
</tr>
<tr>
<td style="text-align:center"><code>/V1</code></td>
<td style="text-align:center">创建 Vista 以前的平台可以看见的任务。不兼容 /XML。</td>
</tr>
<tr>
<td style="text-align:center"><code>/F</code></td>
<td style="text-align:center">如果指定的任务已经存在，则强制创建任务并抑制警告。</td>
</tr>
<tr>
<td style="text-align:center"><code>/RL level</code></td>
<td style="text-align:center">为作业设置运行级别。有效值为 LIMITED 和 HIGHEST。默认值为 LIMITED。</td>
</tr>
<tr>
<td style="text-align:center"><code>/DELAY delaytime</code></td>
<td style="text-align:center">指定触发触发器后延迟任务运行的等待时间。时间格式为mmmm:ss。此选项仅对计划类型ONSTART, ONLOGON, ONEVENT.</td>
</tr>
<tr>
<td style="text-align:center"><code>/HRESULT</code></td>
<td style="text-align:center">为获得更出色的故障诊断能力，处理退出代码将采用 HRESULT 格式。</td>
</tr>
<tr>
<td style="text-align:center"><code>/?</code></td>
<td style="text-align:center">显示此帮助消息。</td>
</tr>
</tbody>
</table>
<p>修改者: 按计划类型的 /MO 开关的有效值:</p>
<table>
<thead>
<tr>
<th style="text-align:left">参数</th>
<th style="text-align:left">有效值</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">MINUTE</td>
<td style="text-align:left">1 到 1439 分钟</td>
</tr>
<tr>
<td style="text-align:left">HOURLY</td>
<td style="text-align:left">1 - 23 小时</td>
</tr>
<tr>
<td style="text-align:left">DAILY</td>
<td style="text-align:left">1 到 365 天</td>
</tr>
<tr>
<td style="text-align:left">WEEKLY</td>
<td style="text-align:left">1 到 52 周</td>
</tr>
<tr>
<td style="text-align:left">ONCE</td>
<td style="text-align:left">无修改者</td>
</tr>
<tr>
<td style="text-align:left">ONSTART</td>
<td style="text-align:left">无修改者</td>
</tr>
<tr>
<td style="text-align:left">ONLOGON</td>
<td style="text-align:left">无修改者</td>
</tr>
<tr>
<td style="text-align:left">ONIDLE</td>
<td style="text-align:left">无修改者</td>
</tr>
<tr>
<td style="text-align:left">MONTHLY</td>
<td style="text-align:left">1 到 12，或FIRST, SECOND, THIRD, FOURTH, LAST, LASTDAY</td>
</tr>
<tr>
<td style="text-align:left">ONEVENT</td>
<td style="text-align:left">XPath 事件查询字符串</td>
</tr>
</tbody>
</table>
<h2>示例</h2>
<ol>
<li>在远程机器 &quot;ABC&quot; 上创建计划任务 &quot;doc&quot;， &quot;runasuser&quot; 用户下运行 notepad.exe。</li>
</ol>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SCHTASKS /Create /S ABC /U user /P password </span><br><span class="line">/RU runasuser /RP runaspassword /SC HOURLY /TN doc /TR notepad</span><br></pre></td></tr></table></figure></p>
<ol start="2">
<li>远程机器 &quot;ABC&quot; 上创建计划任务 &quot;accountant&quot;， 在指定的开始日期和结束日期之间的开始时间和结束时间内，每隔五分钟运行 calc.exe。</li>
</ol>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SCHTASKS /Create /S ABC /U domain\user /P password </span><br><span class="line">/SC MINUTE /MO <span class="number">5</span> /TN accountant /TR calc.exe /ST <span class="number">12</span>:<span class="number">00</span> </span><br><span class="line">/ET <span class="number">14</span>:<span class="number">00</span> /SD <span class="number">06</span>/<span class="number">06</span>/<span class="number">2006</span> /ED <span class="number">06</span>/<span class="number">06</span>/<span class="number">2006</span> /RU runasuser /RP userpassword</span><br></pre></td></tr></table></figure></p>
<ol start="3">
<li>创建计划任务 &quot;gametime&quot;，在每月的第一个星期天运行“空当接龙”。</li>
</ol>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SCHTASKS /Create /SC MONTHLY /MO first /D SUN </span><br><span class="line">/TN gametime /TR c:\windows\system32\freecell</span><br></pre></td></tr></table></figure></p>
<ol start="4">
<li>在远程机器 &quot;ABC&quot; 创建计划任务 &quot;report&quot;，每个星期运行 notepad.exe。</li>
</ol>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SCHTASKS /Create /S ABC /U user /P password /RU runasuser</span><br><span class="line">/RP runaspassword /SC WEEKLY /TN report /TR notepad.exe</span><br></pre></td></tr></table></figure></p>
<ol start="5">
<li>在远程机器 &quot;ABC&quot; 创建计划任务 &quot;logtracker&quot;，每隔五分钟从指定的开始时间到无结束时间，运行 notepad.exe。将提示输入 /RP 密码。</li>
</ol>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SCHTASKS /Create /S ABC /U domain\user /P password /SC MINUTE</span><br><span class="line">/MO <span class="number">5</span> /TN logtracker</span><br><span class="line">/TR c:\windows\system32\notepad.exe /ST <span class="number">18</span>:<span class="number">30</span></span><br><span class="line">/RU runasuser /RP</span><br></pre></td></tr></table></figure></p>
<ol start="6">
<li>创建计划任务 &quot;gaming&quot;，每天从 12:00 点开始到14:00 点自动结束，运行 freecell.exe。</li>
</ol>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SCHTASKS /Create /SC DAILY /TN gaming /TR c:\freecell /ST <span class="number">12</span>:<span class="number">00</span></span><br><span class="line">/ET <span class="number">14</span>:<span class="number">00</span> /K</span><br></pre></td></tr></table></figure></p>
<ol start="7">
<li>创建计划任务“EventLog”以开始运行 wevtvwr.msc只要在“系统”通道中发布事件 101</li>
</ol>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SCHTASKS /Create /TN EventLog /TR wevtvwr.msc /SC ONEVENT</span><br><span class="line">/EC System /MO *[System/EventID=<span class="number">101</span>]</span><br></pre></td></tr></table></figure></p>
<ol start="8">
<li>文件路径中可以加入空格，但需要加上两组引号，一组引号用于 CMD.EXE，另一组用于 SchTasks.exe。用于 CMD的外部引号必须是一对双引号；内部引号可以是一对单引号或一对转义双引号:</li>
</ol>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SCHTASKS /Create</span><br><span class="line">/tr "'c:\program files\internet explorer\iexplorer.exe'</span><br><span class="line">\"c:\log data\today.xml\"" ...</span><br></pre></td></tr></table></figure></p>
<ol start="9">
<li>令计划安全脚本 Sec.vbs 每 20 分钟运行一次。由于命令没有包含起始日期或时间，任务在命令完成 20 分钟后启动，此后每当系统运行它就每 20 分钟运行一次。请注意，安全脚本源文件位于远程计算机上，但任务在本地计算机上计划并执行。</li>
</ol>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks /create /sc minute /mo <span class="number">20</span> /tn "Security Script" /tr \\central\data\scripts\sec.vbs</span><br></pre></td></tr></table></figure></p>
<h1>其他实例</h1>
<p>转载自:https://blog.csdn.net/lionzl/article/details/40896893</p>
<h2>schtasks create hourly</h2>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks /create /tn TaskName /tr TaskRun /sc hourly [/mo &#123;<span class="number">1</span> - <span class="number">365</span>&#125;] [/st StartTime] [/sd StartDate] [/ed EndDate] [/s computer [/u [domain\]user /p password]] [/ru &#123;[Domain\]User | "System"&#125; [/rp Password]]</span><br></pre></td></tr></table></figure></p>
<p>计划命令在每小时过五分的时候运行。</p>
<ol>
<li>下面的命令将计划 MyApp 程序从午夜过后五分钟起每小时运行一次。因为忽略了 /mo 参数，命令使用了小时计划的默认值，即每 (1) 小时。如果该命令在 12:05 A.M 之后生成，程序将在第二天才会运行。</li>
</ol>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks /create /sc hourly /st <span class="number">00</span>:<span class="number">05</span>:<span class="number">00</span> /tn "My App" /tr c:\apps\myapp.exe</span><br></pre></td></tr></table></figure></p>
<p>计划命令每五小时运行一次</p>
<p>下面的命令计划 MyApp 程序从 2001 年 3 月的第一天起每五小时运行一次。它使用 /mo 参数来指定间隔时间，使用 /sd 参数来指定起始日期。由于命令没有指定起始时间，当前时间被用作起始时间。</p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks /create /sc hourly /mo <span class="number">5</span> /sd <span class="number">03</span>/<span class="number">01</span>/<span class="number">2001</span> /tn "My App" /tr c:\apps\myapp.exe</span><br></pre></td></tr></table></figure></p>
<h2>schtasks create daily</h2>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks /create /tn TaskName /tr TaskRun /sc daily [/mo &#123;<span class="number">1</span> - <span class="number">365</span>&#125;] [/st StartTime] [/sd StartDate] [/ed EndDate] [/s computer [/u [domain\]user /p password]] [/ru &#123;[Domain\]User | "System"&#125; [/rp Password]]</span><br></pre></td></tr></table></figure></p>
<p>计划任务每天运行一次</p>
<p>下面的范例计划 MyApp 程序在每天的 8:00 A.M. 运行一次，直到 2001 年 12 月 31 日结束。由于它忽略了 /mo 参数，所以使用默认间隔 1 来每天运行命令。</p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks /create /tn "My App" /tr c:\apps\myapp.exe /sc daily /st <span class="number">08</span>:<span class="number">00</span>:<span class="number">00</span> /ed <span class="number">12</span>/<span class="number">31</span>/<span class="number">2001</span></span><br></pre></td></tr></table></figure></p>
<p>计划任务每隔一天运行一次</p>
<p>下面的范例计划 MyApp 程序从 2001 年 12 月 31 日起每隔一天在 1:00 P.M. (13:00) 运行。命令使用 /mo 参数来指定两 (2) 天的间隔。</p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks /create /tn "My App" /tr c:\apps\myapp.exe /sc daily /mo <span class="number">2</span> /st <span class="number">13</span>:<span class="number">00</span>:<span class="number">00</span> /sd <span class="number">12</span>/<span class="number">31</span>/<span class="number">2001</span></span><br></pre></td></tr></table></figure></p>
<h2>schtasks create weekly</h2>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks /create /tn TaskName /tr TaskRun /sc weekly [/d &#123;MON - SUN | *&#125;] [/mo &#123;<span class="number">1</span> - <span class="number">52</span>&#125;] [/st StartTime] [/sd StartDate] [/ed EndDate] [/s computer [/u [domain\]user /p password]] [/ru &#123;[Domain\]User | "System"&#125; [/rp Password]]</span><br></pre></td></tr></table></figure></p>
<p>计划任务每六周运行一次</p>
<p>下面的命令计划 MyApp 程序在远程计算机上每六周运行一次。该命令使用 /mo 参数来指定间隔。它也使用 /s 参数来指定远程计算机，使用 /ru 参数来计划任务以用户的 Administrator 帐户权限运行。因为忽略了 /rp 参数，SchTasks.exe 会提示用户输入 Administrator 帐户密码。</p>
<p>另外，因为命令是远程运行的，所以命令中所有的路径，包括到 MyApp.exe 的路径，都是指向远程计算机上的路径。</p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks /create /tn "My App" /tr c:\apps\myapp.exe /sc weekly /mo <span class="number">6</span> /s Server16 /ru Admin01</span><br></pre></td></tr></table></figure></p>
<p>计划任务每隔一周在周五运行</p>
<p>下面的命令计划任务每隔一周在周五运行。它使用 /mo 参数来指定两周的间隔，使用 /d 参数来指定是一周内的哪一天。如计划任务在每个周五运行，要忽略 /mo 参数或将其设置为 1。</p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks /create /tn "My App" /tr c:\apps\myapp.exe /sc weekly /mo <span class="number">2</span> /d FRI</span><br></pre></td></tr></table></figure></p>
<h2>schtasks create monthly</h2>
<h3>常规月计划语法</h3>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks /create /tn TaskName /tr TaskRun /sc monthly [/mo &#123;FIRST | SECOND | THIRD | FOURTH | LAST | LASTDAY] [/d &#123;MON - SUN | <span class="number">1</span> - <span class="number">31</span>&#125;] [/m &#123;JAN - DEC[,JAN - DEC...] | *&#125;] [/st StartTime] [/sd StartDate] [/ed EndDate] [/s computer [/u [domain\]user /p password]] [/ru &#123;[Domain\]User | "System"&#125; [/rp Password]]</span><br></pre></td></tr></table></figure></p>
<ul>
<li>指定周的语法</li>
</ul>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks /create /tn TaskName /tr TaskRun /sc monthly /mo &#123;FIRST | SECOND | THIRD | FOURTH | LAST&#125; /d &#123;MON - SUN&#125; [/m &#123;JAN - DEC[,JAN - DEC...] | *&#125;] [/st StartTime] [/sd StartDate] [/ed EndDate] [/s computer [/u [domain\]user /p password]] [/ru &#123;[Domain\]User | "System"&#125; [/rp Password]]</span><br></pre></td></tr></table></figure></p>
<ul>
<li>Lastday 语法</li>
</ul>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks /create /tn TaskName /tr TaskRun /sc monthly /mo LASTDAY /m &#123;JAN - DEC[,JAN - DEC...] | *&#125; [/st StartTime] [/sd StartDate] [/ed EndDate] [/s computer [/u [domain\]user /p password]] [/ru &#123;[Domain\]User | "System"&#125; [/rp Password]]</span><br></pre></td></tr></table></figure></p>
<ul>
<li>指定日期的语法</li>
</ul>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks /create /tn TaskName /tr TaskRun /sc monthly /d &#123;<span class="number">1</span> - <span class="number">31</span>&#125; [/m &#123;JAN - DEC[,JAN - DEC...] | *&#125;] [/st StartTime] [/sd StartDate] [/ed EndDate] [/s computer [/u [domain\]user /p password]] [/ru &#123;[Domain\]User | "System"&#125; [/rp Password]]</span><br></pre></td></tr></table></figure></p>
<h4>计划任务在每月的第一天运行</h4>
<p>下面的命令计划 MyApp 程序在每月的第一天运行。因为默认修饰符是 none（即：没有修饰符），默认天是第一天，默认的月份是每个月，所以该命令不需要任何其它的参数。</p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks /create /tn "My App" /tr c:\apps\myapp.exe /sc monthly</span><br></pre></td></tr></table></figure></p>
<h4>计划任务在每月的最后一天运行</h4>
<p>下面的命令计划 MyApp 程序在每月的最后一天运行。它使用 /mo 参数指定在每月的最后一天运行程序，使用通配符 (*) 与 /m 参数表明在每月的最后一天运行程序。</p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks /create /tn "My App" /tr c:\apps\myapp.exe /sc monthly /mo lastday /m *</span><br></pre></td></tr></table></figure></p>
<h4>计划任务每三个月运行一次</h4>
<p>下面的命令计划 MyApp 程序每三个月运行一次。.它使用 /mo 参数来指定间隔。</p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks /create /tn "My App" /tr c:\apps\myapp.exe /sc monthly /mo <span class="number">3</span></span><br></pre></td></tr></table></figure></p>
<h4>计划任务在每月的第二个周日运行</h4>
<p>下面的命令计划 MyApp 程序在每月的第二个周日运行。它使用 /mo 参数指定是每月的第二周，使用 /d 参数指定天。</p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks /create /tn "My App" /tr c:\apps\myapp.exe /sc monthly /mo SECOND /d SUN</span><br></pre></td></tr></table></figure></p>
<h4>计划任务在五月和六月的第 15 天运行。</h4>
<p>下面的命令计划 MyApp 程序在五月 15 日和六月 15 日的 3:00 PM (15:00) 运行。它使用 /d 参数来指定日期，使用 /m 参数指定月份。它也使用 /st 参数来指定开始时间。</p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks /create /tn "My App" /tr c:\apps\myapp.exe /sc monthly /d <span class="number">15</span> /m MAY,JUN /st <span class="number">15</span>:<span class="number">00</span>:<span class="number">00</span></span><br></pre></td></tr></table></figure></p>
<h2>schtasks create once</h2>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks /create /tn TaskName /tr TaskRun /sc once /st StartTime /sd StartDate [/s computer [/u [domain\]user /p password]] [/ru &#123;[Domain\]User | "System"&#125; [/rp Password]]</span><br></pre></td></tr></table></figure></p>
<h3>计划任务运行一次</h3>
<p>下面的命令计划 MyApp 程序在 2002 年 1 月 1 日午夜运行一次。它使用 /ru 参数指定以用户的 Administrator 帐户权限运行任务，使用 /rp 参数为 Administrator 帐户提供密码。</p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks /create /tn "My App" /tr c:\apps\myapp.exe /sc once /st <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> /sd <span class="number">01</span>/<span class="number">01</span>/<span class="number">2002</span> /ru Admin23 /rp p@ssworD1</span><br></pre></td></tr></table></figure></p>
<h2>schtasks create onstart</h2>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks /create /tn TaskName /tr TaskRun /sc onstart [/sd StartDate] [/s computer [/u [domain\]user /p password]] [/ru &#123;[Domain\]User | "System"&#125; [/rp Password]]</span><br></pre></td></tr></table></figure></p>
<h3>计划任务在每次系统启动的时候运行</h3>
<p>下面的命令计划 MyApp 程序在每次系统启动的时候运行，起始日期是 2001 年 3 月 15 日。
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks /create /tn "My App" /tr c:\apps\myapp.exe /sc onstart /sd <span class="number">03</span>/<span class="number">15</span>/<span class="number">2001</span></span><br></pre></td></tr></table></figure></p>
<h2>schtasks create onlogon</h2>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks /create /tn TaskName /tr TaskRun /sc onlogon [/sd StartDate] [/s computer [/u [domain\]user /p password]] [/ru &#123;[Domain\]User | "System"&#125; [/rp Password]]</span><br></pre></td></tr></table></figure></p>
<h3>计划任务在用户登录到远程计算机的时候运行</h3>
<p>下面的命令计划批处理文件在用户（任何用户）每次登录到远程计算机上的时候运行。它使用 /s 参数指定远程计算机。因为命令是远程的，所以命令中所有的路径，包括批处理文件的路径，都指定为远程计算机上的路径。</p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks /create /tn "<span class="built_in">Start</span> Web Site" /tr c:\myiis\webstart.bat /sc onlogon /s Server23</span><br></pre></td></tr></table></figure></p>
<h2>schtasks create onidle</h2>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks /create /tn TaskName /tr TaskRun /sc onidle /iIdleTime [/sd StartDate] [/s computer [/u [domain\]user /p password]] [/ru &#123;[Domain\]User | "System"&#125; [/rp Password]]</span><br></pre></td></tr></table></figure></p>
<h3>计划某项任务在计算机空闲的时候运行</h3>
<p>下面的命令计划 MyApp 程序在计算机空闲的时候运行。它使用必需的 /i 参数指定在启动任务之前计算机必需持续空闲十分钟。</p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks /create /tn "My App" /tr c:\apps\myapp.exe /sc onidle /i <span class="number">10</span></span><br></pre></td></tr></table></figure></p>
<h3>创建以 System 权限运行的任务</h3>
<p>下面的命令计划 MyApp 程序以 NT Authority\System 帐户权限运行。在这个范例中，任务计划在每月的第一天运行，但对于以系统权限运行的任务可以使用所有的计划类型。</p>
<p>该命令使用 /ru &quot;System&quot; 参数指定系统安全上下文。因为系统任务不需要密码，所以忽略了 /rp 参数。</p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks /create /tn "My App" /tr c:\apps\myapp.exe /sc monthly /d <span class="number">1</span> /ru "System"</span><br></pre></td></tr></table></figure></p>
<p>作为响应，SchTasks.exe 显示一个信息性消息和一个成功消息。它不提示输入密码。信息：此任务将被创建于用户名下 (&quot;NT AUTHORITY\SYSTEM&quot;)。 成功：计划任务 &quot;My App&quot; 已成功创建。</p>
<h3>创建运行多个程序的任务</h3>
<p>每个任务只能运行一个程序。但是可以创建一个运行多个程序的批处理文件，然后计划一个任务来运行该批处理文件。下面的过程说明了这个方法：</p>
<ol>
<li>创建一个启动要运行程序的批处理文件。</li>
</ol>
<p>在这个范例中创建了一个启动“事件查看器”(Eventvwr.exe) 和“系统监视器”(Perfmon.exe) 的批处理文件。</p>
<ul>
<li>启动文本编辑器，例如“记事本”。</li>
<li>键入每个程序的名称和指向可执行文件的完全合格的路径。在这种情况下，文件包含有下列语句。</li>
</ul>
<p><figure class="highlight bat"><figcaption><span>MyApp.bat</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">C:\<span class="title">Windows</span>\<span class="title">System32</span>\<span class="title">Eventvwr.exe</span></span></span><br><span class="line"><span class="function"><span class="title">C</span>:\<span class="title">Windows</span>\<span class="title">System32</span>\<span class="title">Perfmon.exe</span></span></span><br></pre></td></tr></table></figure></p>
<ol start="2">
<li>使用 SchTasks.exe 创建一个运行 MyApps.bat 的任务。</li>
</ol>
<p>下面的命令创建了 Monitor 任务，每当有人登录它就运行。它使用 /tn 参数命名任务，使用 /tr 参数运行 MyApps.bat。它使用 /sc 参数来指明 OnLogon 计划类型，使用 /ru 参数指定 Administrator 帐户。
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chtasks /create /tn Monitor /tr C:\MyApps.bat /sc onlogon /ru Reskit\Administrator</span><br></pre></td></tr></table></figure></p>
<p>该命令的结果是，每当用户登录到计算机，任务就启动“事件查看器”和“系统监视器”。</p>
<h3>更改计划任务</h3>
<p>更改一个或多个下列任务属性。</p>
<ul>
<li>任务运行的程序 (/tr)。</li>
<li>任务运行的用户帐户 (/ru)。</li>
<li>用户帐户的密码 (/rp)。</li>
</ul>
<p>语法
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks /change /tn TaskName [/s computer [/u [domain\]user /p password]] [/tr TaskRun] [/ru [Domain\]User | "System"] [/rp Password]</span><br></pre></td></tr></table></figure></p>
<table>
<thead>
<tr>
<th style="text-align:center">参数</th>
<th style="text-align:center">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>/tn TaskName</code></td>
<td style="text-align:center">标识要更改的任务。输入任务名</td>
</tr>
<tr>
<td style="text-align:center"><code>/s Computer</code></td>
<td style="text-align:center">指定远程计算机的名称或 IP 地址（带有或者没有反斜杠）。默认值是本地计算机</td>
</tr>
<tr>
<td style="text-align:center"><code>/u [domain\]user</code></td>
<td style="text-align:center">使用特定用户帐户的权限运行命令。默认情况下，使用已登录到运行 SchTasks 的计算机上的用户的权限运行命令</td>
</tr>
<tr>
<td style="text-align:center"><code>/p password</code></td>
<td style="text-align:center">指定在 /u 参数中指定的用户帐户的密码。如果使用 /u 参数，则需要该参数</td>
</tr>
<tr>
<td style="text-align:center"><code>/tr TaskRun</code></td>
<td style="text-align:center">更改任务运行的程序。输入可执行文件、脚本文件或批处理文件的完全合格的路径和文件名。如果忽略了路径，SchTasks.exe 假定文件在 Systemroot\System32 目录下指定的程序替换任务最初运行的程序</td>
</tr>
<tr>
<td style="text-align:center"><code>/ru [Domain\]User &quot;System&quot;</code></td>
<td style="text-align:center">更改用于任务的用户帐户。 [domain]User  指定用户帐户&quot;System&quot; or &quot; 指定为操作系统所使用的 NT Authority\System 帐户。在更改用户帐户的时候，必须也要更改用户密码。如果命令带有 /ru 参数，但没有 /rp 参数，SchTasks.exe 提示要求输入新的密码而且不显示键入的文本。任务以不需要密码的 NT Authority\System 帐户权限运行，SchTasks.exe 不会提示输入密码</td>
</tr>
<tr>
<td style="text-align:center"><code>/p Password</code></td>
<td style="text-align:center">更改用于任务的帐户密码。输入新的密码</td>
</tr>
<tr>
<td style="text-align:center"><code>/?</code></td>
<td style="text-align:center">在命令提示符显示帮助</td>
</tr>
</tbody>
</table>
<p>注释</p>
<ul>
<li>XOX /tn 和 /s 参数标识该任务。/tr、/ru 和 /rp 参数指定可以更改的任务属性。</li>
<li>使用 change 操作的命令必须至少更改一个任务属性。</li>
<li>NT Authority\System 帐户没有交互式登录权限。用户看不到以系统权限运行的程序，不能与其交互。</li>
</ul>
<h3>更改任务运行的程序</h3>
<p>下面的命令将 Virus Check 任务运行的程序由 VirusCheck.exe 更改为 VirusCheck2.exe。此命令使用 /tn 参数标识任务，使用 /tr 参数指定任务的新程序。（不能更改任务名称。）</p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks /change /tn "Virus Check" /tr C:\VirusCheck2.exe</span><br></pre></td></tr></table></figure></p>

      

          <a href="/posts/WinTask.html" class="post-more waves-effect waves-button">
            <i class="icon icon-bookmark">&nbsp;</i> 阅读全文…
          </a>
      </div>
      
      <div class="post-footer">
          
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Batch/">Batch</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Win/">Win</a></li></ul>

      </div>
      
  </article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-Batch"
    class="article-card article-type-post" itemprop="blogPost">

      <div class="post-meta">
          <time class="post-time" title="2019-12-11 09:23:23" datetime="2019-12-11T01:23:23.000Z"  itemprop="datePublished"><i class="icon icon-calendar"></i> 2019-12-11</time>

          
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Coding/">Coding</a></li></ul>



          
      </div>

      


  
    <h3 class="post-title" itemprop="name">
      <a class="post-title-link" href="/posts/Batch.html">Batch</a>
    </h3>
  



      <div class="post-content" id="post-content" itemprop="postContent">

      
          <p>Batch 批量处理</p>
<h1>%~dp0[获取当前路径]</h1>
<ol>
<li>%~dp0 “d”为Drive的缩写，即为驱动器，磁盘、“p”为Path缩写，即为路径，目录</li>
<li>cd %~dp0 ：进入批处理所在目录</li>
<li>cd %~dp0bin\ ：进入批处理所在目录的bin目录
&lt;!--more--&gt;
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">REM 作用：以管理员身份安装Apache</span></span><br><span class="line"><span class="function">d:</span></span><br><span class="line"><span class="function"><span class="title">cd</span> %~<span class="title">dp0bin</span>\</span></span><br><span class="line"><span class="function"><span class="title">httpd.exe</span> -<span class="title">k</span> <span class="title">install</span> -<span class="title">n</span> "<span class="title">Apache24</span>"</span></span><br></pre></td></tr></table></figure></li>
</ol>
<p>以管理员身份运行 示例.bat ，执行结果如下：
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">C:\<span class="title">Windows</span>\<span class="title">system32</span>&gt;<span class="title">d</span>:</span></span><br><span class="line"><span class="function"><span class="title">D</span>:\&gt;<span class="title">cd</span> <span class="title">D</span>:\<span class="title">Server</span>\<span class="title">Apache24</span>\<span class="title">bin</span>\</span></span><br><span class="line"><span class="function"><span class="title">D</span>:\<span class="title">Server</span>\<span class="title">Apache24</span>\<span class="title">bin</span>&gt;<span class="title">httpd.exe</span> -<span class="title">k</span> <span class="title">install</span> -<span class="title">n</span> "<span class="title">Apache24</span>"</span></span><br></pre></td></tr></table></figure></p>
<h1>常用命令</h1>
<h2>%cd%[执行的路径]</h2>
<p>当前执行的路径，并非目标文件的路径</p>
<h2>taskill</h2>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">taskkill</span> /f /im notepad.exe [终止进程]</span><br><span class="line"><span class="built_in">taskkill</span> /?打开帮助</span><br></pre></td></tr></table></figure></p>
<h2>获取命令帮助 xxx /?</h2>
<p>遇到记不清楚的命令，但记得名字，就可以键入 命令名 空格 /?就会有详细的该命令的帮助了，比如：ping /? ,    cd /?</p>
<h2>查看内置命令帮助信息</h2>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ver</span> /?</span><br><span class="line"><span class="built_in">cmd</span> /?</span><br><span class="line"><span class="built_in">set</span> /?</span><br><span class="line"><span class="comment">rem /?</span></span><br><span class="line"><span class="keyword">if</span> /?</span><br><span class="line"><span class="built_in">echo</span> /?</span><br><span class="line"><span class="keyword">goto</span> /?</span><br><span class="line"><span class="keyword">for</span> /?</span><br><span class="line"><span class="built_in">shift</span> /?</span><br><span class="line"><span class="keyword">call</span> /?</span><br></pre></td></tr></table></figure></p>
<h2>其他常用的命令</h2>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">type</span> /?</span><br><span class="line"><span class="built_in">find</span> /?</span><br><span class="line"><span class="built_in">findstr</span> /?</span><br><span class="line"><span class="built_in">copy</span> /?</span><br></pre></td></tr></table></figure></p>
<h1>基础语法</h1>
<ol>
<li>批处理文件是一个“.bat”结尾的文本文件，这个文件的每一行都是一条DOS命令。可以使用任何文本文件编辑工具创建和修改。</li>
<li>批处理是一种简单的程序，可以用 if 和 goto 来控制流程，也可以使用 for 循环。</li>
<li>批处理的编程能力远不如C语言等编程语言，也十分不规范。</li>
<li>每个编写好的批处理文件都相当于一个DOS的外部命令，把它所在的目录放到DOS搜索路径(path)中，即可在任意位置运行。</li>
<li>C:\AUTOEXEC.BAT 是每次系统启动时都会自动运行的，可以将每次启动时都要运行的命令放入该文件中。</li>
<li>大小写不敏感(命令符忽略大小写)</li>
<li>批处理的文件扩展名为 .bat 或 .cmd。</li>
<li>在命令提示下键入批处理文件的名称，或者双击该批处理文件，系统就会调用Cmd.exe来运行该文件。</li>
</ol>
<h1>参数</h1>
<h2>系统参数</h2>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">%SystemRoot%</span> ===&gt; C:\WINDOWS (<span class="variable">%windir%</span> 同样)</span><br><span class="line"><span class="variable">%ProgramFiles%</span> ===&gt; C:\Program Files</span><br><span class="line"><span class="variable">%USERPROFILE%</span> ===&gt; C:\Documents and Settings\Administrator (子目录有“桌面”,“开始菜单”,“收藏夹”等)</span><br><span class="line"><span class="variable">%APPDATA%</span> ===&gt; C:\Documents and Settings\Administrator\Application Data</span><br><span class="line"><span class="variable">%TEMP%</span> ===&gt; C:\DOCUME~<span class="number">1</span>\ADMINI~<span class="number">1</span>\LOCALS~<span class="number">1</span>\Temp (<span class="variable">%TEM%</span> 同样)</span><br><span class="line"><span class="variable">%APPDATA%</span> ===&gt; C:\Documents and Settings\Administrator\Application Data</span><br><span class="line"><span class="variable">%OS%</span> ===&gt; Windows_NT (系统)</span><br><span class="line"><span class="variable">%Path%</span> ===&gt; <span class="variable">%SystemRoot%</span>\system32;<span class="variable">%SystemRoot%</span>;<span class="variable">%SystemRoot%</span>\System32\Wbem (原本的设置)</span><br><span class="line"><span class="variable">%HOMEDRIVE%</span> ===&gt; C: (系统盘)</span><br><span class="line"><span class="variable">%HOMEPATH%</span> ===&gt; \Documents and Settings\Administrator</span><br><span class="line"></span><br><span class="line"><span class="comment">REM 枚举当前的环境变量</span></span><br><span class="line"><span class="built_in">setlocal</span> enabledelayedexpansion</span><br><span class="line"><span class="keyword">FOR</span> /F "usebackq delims==" <span class="variable">%%i</span> <span class="keyword">IN</span> (`<span class="built_in">set</span>`) <span class="keyword">DO</span> @<span class="built_in">echo</span> <span class="variable">%%i</span> <span class="variable">!%%i!</span></span><br></pre></td></tr></table></figure></p>
<h2>传递参数给批处理文件</h2>
<p>%[1-9]表示参数，参数是指在运行批处理文件时在文件名后加的以空格(或者Tab)分隔的字符串。</p>
<p>变量可以从%0到%9，%0表示批处理命令本身，其它参数字符串用 %1 到 %9 顺序表示。</p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">REM 执行同目录下的“test2.bat”文件，并输入两个参数</span></span><br><span class="line"><span class="keyword">call</span> test2.bat "hello" "haha"</span><br></pre></td></tr></table></figure></p>
<p>在“test2.bat”文件里写:</p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> %<span class="number">1</span> (打印: "hello")</span><br><span class="line"><span class="built_in">echo</span> %<span class="number">2</span> (打印: "haha")</span><br><span class="line"><span class="built_in">echo</span> %<span class="number">0</span> (打印: test2.bat)</span><br><span class="line"><span class="built_in">echo</span> %<span class="number">19</span> (打印: "hello"<span class="number">9</span>)</span><br></pre></td></tr></table></figure></p>
<h1>批处理基本命令</h1>
<h2>help 命令</h2>
<p>/? 命令，语法： 命令 /?</p>
<p>可显示此命令的帮助信息</p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">REM 把 type 命令的帮助信息写入到tmp.txt文件里</span></span><br><span class="line"><span class="built_in">type</span> /? &gt;&gt;tmp.txt</span><br></pre></td></tr></table></figure></p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">help</span> <span class="built_in">type</span> (显示跟“<span class="built_in">type</span> /?”一样)</span><br></pre></td></tr></table></figure></p>
<h2>Echo 命令</h2>
<p>语法:
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> [&#123;on|off&#125;] [message]</span><br><span class="line"><span class="built_in">ECHO</span> [ON | OFF] 打开回显或关闭回显功能。</span><br><span class="line"><span class="built_in">ECHO</span> 显示当前回显设置。</span><br><span class="line"><span class="built_in">ECHO</span> [message] 显示信息。</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> off </span><br><span class="line">表示在此语句后所有运行的命令都不显示命令行本身；</span><br><span class="line">默认是on，on时会显示如： C:\文件夹路径&gt;命令行。</span><br></pre></td></tr></table></figure></p>
<p>在实际应用中我们会把这条命令和重定向符号( 也称为管道符号，一般用 &gt; &gt;&gt; ^ )结合来实现输入一些命令到特定格式的文件中。</p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> off</span><br><span class="line"></span><br><span class="line"><span class="comment">REM 显示出“hello world”</span></span><br><span class="line"><span class="built_in">echo</span> hello world </span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> Windows Registry Editor Version <span class="number">5</span>.<span class="number">00</span> &gt; c:\setupreg.reg </span><br><span class="line"></span><br><span class="line"><span class="comment">REM 追加内容进 setupreg.reg 这个文件</span></span><br><span class="line"><span class="built_in">echo</span> "SourcePath"="D:\\Win2003\\" &gt;&gt; c:\setupreg.reg</span><br></pre></td></tr></table></figure></p>
<h2>@ 命令</h2>
<p>表示不显示@后面的命令</p>
<p>@ 与 echo off 相象，但它是加在每个命令行的最前面，表示运行时不显示这一行的命令行(只能影响当前行)。</p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off </span><br><span class="line"><span class="comment">REM 此语句常用于开头，表示不显示所有的命令行信息，包括此句</span></span><br><span class="line"></span><br><span class="line">@<span class="built_in">echo</span> please wait a minite...</span><br><span class="line">@<span class="built_in">format</span> X: /q/u/autoset</span><br></pre></td></tr></table></figure></p>
<p>format 这个命令是不可以使用/y这个参数的，可喜的是微软留了个autoset这个参数给我们，效果和/y是一样的。</p>
<h2>Goto 命令</h2>
<p>语法：goto label (label是参数，指定所要转向的批处理程序中的行。)</p>
<p>指定跳转到标签行，找到标签行后，程序将处理从下一行开始的命令。</p>
<p>label标签的名字可以随便起，但是最好是有意义的，字母前必须加个冒号“:”来表示这个字母是标签。</p>
<p>goto命令就是根据这个冒号来寻找下一步跳到到那里。经常与 if 配合使用，根据不同的条件来执行不同的命令组。</p>
<h2>Rem 命令</h2>
<p>语法：Rem Message...(小技巧：用::代替rem)</p>
<p>注释命令，在C语言中相当与/<em>...</em>/,它并不会被执行，只是起一个注释的作用，便于别人阅读和自己日后修改。
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">@Rem Here is the description.</span></span><br></pre></td></tr></table></figure></p>
<h2>Pause 命令</h2>
<p>会暂停批处理的执行并在屏幕上显示Press any key to continue...的提示，等待用户按任意键后继续
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line">:begin</span><br><span class="line"><span class="built_in">copy</span> a:*.* d:\back</span><br><span class="line"><span class="built_in">echo</span> Please put a new disk into driver A</span><br><span class="line"><span class="built_in">pause</span></span><br><span class="line"><span class="keyword">goto</span> begin</span><br></pre></td></tr></table></figure></p>
<p>在这个例子中，驱动器 A 中磁盘上的所有文件均复制到d:\back中。</p>
<p>显示的信息提示您将另一张磁盘放入驱动器 A 时，pause 命令会使程序挂起，以便您更换磁盘，然后按任意键再次复制。</p>
<h2>Call 命令</h2>
<p>语法:
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">call</span> [[Drive:][<span class="built_in">Path</span>] FileName [BatchParameters]] [:<span class="built_in">label</span> [arguments]]</span><br></pre></td></tr></table></figure></p>
<p>参数:</p>
<p><code>[Drive:][Path] FileName</code> 指定要调用的批处理程序的位置和名称。filename 参数必须具有 <code>.bat</code> 或 <code>.cmd</code> 扩展名。</p>
<p>调用另一个批处理程序，并且不终止父批处理程序。如果不用call而直接调用别的批处理文件，那么执行完那个批处理文件后将无法返回当前文件并执行当前文件的后续命令。call 命令接受用作调用目标的标签。如果在脚本或批处理文件外使用 Call，它将不会在命令行起作用。</p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">REM 调用指定目录下的 test2.bat，且输入3个参数给他</span></span><br><span class="line"><span class="keyword">call</span>="<span class="variable">%cd%</span>\test2.bat" haha kkk aaa</span><br><span class="line"></span><br><span class="line"><span class="comment">REM 调用同目录下的 test2.bat，且输入2个参数给他</span></span><br><span class="line"><span class="keyword">call</span> test2.bat arg1 arg2</span><br></pre></td></tr></table></figure></p>
<p>注：可以调用自身(死循环、递归)</p>
<h2>Start 命令</h2>
<p>调用外部程序，所有的 DOS命令 和 命令行程序 都可以由 start命令 来调用。</p>
<p>常用参数：</p>
<ul>
<li>MIN 开始时窗口最小化</li>
<li>SEPARATE 在分开的空间内开始 16 位 Windows 程序</li>
<li>HIGH 在 HIGH 优先级类别开始应用程序</li>
<li>REALTIME 在 REALTIME 优先级类别开始应用程序</li>
<li>WAIT 启动应用程序并等候它结束</li>
<li>parameters 这些为传送到命令/程序的参数</li>
</ul>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">REM 调用同目录下的 test2.bat，且输入2个参数给他，且本窗口最小化</span></span><br><span class="line"><span class="built_in">start</span> /MIN test2.bat arg1 arg2</span><br><span class="line"></span><br><span class="line"><span class="comment">REM 文件路径名有空格时</span></span><br><span class="line"><span class="function">e:\"<span class="title">program</span> <span class="title">files</span>"\<span class="title">qq.exe</span></span></span><br></pre></td></tr></table></figure></p>
<h2>If 命令</h2>
<p>if 表示将判断是否符合规定的条件，从而决定执行不同的命令。有三种格式:</p>
<p>语法:
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [<span class="keyword">not</span>] "参数" == "字符串" 待执行的命令</span><br></pre></td></tr></table></figure></p>
<p>参数如果等于(not表示不等，下同)指定的字符串，则条件成立，运行命令，否则运行下一句。(注意是两个等号)</p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> "%<span class="number">1</span>" == "a" <span class="built_in">format</span> a:</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> &#123;%<span class="number">1</span>&#125; == &#123;&#125; <span class="keyword">goto</span> noparms</span><br></pre></td></tr></table></figure></p>
<h3>If exist</h3>
<p>语法: if [not] exist [路径]文件名 待执行的命令</p>
<p>如果有指定的文件，则条件成立，运行命令，否则运行下一句。
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">REM 存在这文件，则编辑它，用很难看的系统编辑器</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">exist</span> config.sys edit config.sys</span><br><span class="line"></span><br><span class="line"><span class="comment">REM 如果存在这文件，则显示它的内容</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">exist</span> config.sys <span class="built_in">type</span> config.sys</span><br></pre></td></tr></table></figure></p>
<h3>If errorlevel number</h3>
<p>语法: if [not] errorlevel &lt;数字&gt; 待执行的命令</p>
<p>如果程序返回值等于指定的数字，则条件成立，运行命令，否则运行下一句。(返回值必须按照从大到小的顺序排列)</p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"><span class="built_in">XCOPY</span> F:\test.bat D:\</span><br><span class="line"><span class="keyword">IF</span> <span class="keyword">ERRORLEVEL</span> <span class="number">1</span> (<span class="built_in">ECHO</span> 文件拷贝失败</span><br><span class="line">) <span class="keyword">Else</span> <span class="keyword">IF</span> <span class="keyword">ERRORLEVEL</span> <span class="number">0</span> <span class="built_in">ECHO</span> 成功拷贝文件</span><br><span class="line"></span><br><span class="line"><span class="built_in">pause</span></span><br></pre></td></tr></table></figure></p>
<p>很多DOS程序在运行结束后会返回一个数字值用来表示程序运行的结果(或者状态)，称为错误码errorlevel或称返回码。</p>
<p>常见的返回码为0、1。通过if errorlevel命令可以判断程序的返回值，根据不同的返回值来决定执行不同的命令。</p>
<h3>Else</h3>
<p>语法： if 条件 (成立时执行的命令) else (不成立时执行的命令)</p>
<p>如果是多个条件，建议适当使用括号把各条件包起来，以免出错。
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="number">1</span> == <span class="number">0</span> ( <span class="built_in">echo</span> comment1 ) <span class="keyword">else</span> <span class="keyword">if</span> <span class="number">1</span>==<span class="number">0</span> ( <span class="built_in">echo</span> comment2 ) <span class="keyword">else</span> (<span class="built_in">echo</span> comment3 )</span><br><span class="line"><span class="comment">REM 如果 else 的语句需要换行，if 执行的行尾需用“^”连接，并且 if 执行的动作需用(括起来)，否则报错</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="number">1</span> == <span class="number">0</span> ( <span class="built_in">echo</span> comment1 ) <span class="keyword">else</span> <span class="keyword">if</span> <span class="number">1</span>==<span class="number">0</span> ( <span class="built_in">echo</span> comment2 ) ^</span><br><span class="line"><span class="keyword">else</span> (<span class="built_in">echo</span> comment3 )</span><br></pre></td></tr></table></figure></p>
<h3>比较运算符:</h3>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EQU</span> - 等于 (一般使用“==”)</span><br><span class="line"><span class="keyword">NEQ</span> - 不等于 (没有 “!=”,改用“ <span class="keyword">if</span> <span class="keyword">not</span> <span class="number">1</span>==<span class="number">1</span> ”的写法)</span><br><span class="line"><span class="keyword">LSS</span> - 小于</span><br><span class="line"><span class="keyword">LEQ</span> - 小于或等于</span><br><span class="line"><span class="keyword">GTR</span> - 大于</span><br><span class="line"><span class="keyword">GEQ</span> - 大于或等于</span><br></pre></td></tr></table></figure></p>
<h2>Choice 命令</h2>
<p>choice 使用此命令可以让用户输入一个字符(用于选择)，从而根据用户的选择返回不同的 errorlevel，然后配合 if errorlevel 选择运行不同的命令。</p>
<p>注意：choice命令为DOS或者Windows系统提供的外部命令，不同版本的choice命令语法会稍有不同，请用choice /?查看用法。choice 使用此命令可以让用户输入一个字符，从而运行不同的命令。使用时应该加/c:参数，c:后应写提示可输入的字符，之间无空格。它的返回码为1234……</p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">choice /c:dme defrag,mem,end</span><br></pre></td></tr></table></figure></p>
<p>将显示: defrag,mem,end[D,M,E]?</p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">choice /c:dme defrag,mem,end</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">errorlevel</span> <span class="number">3</span> <span class="keyword">goto</span> defrag (应先判断数值最高的错误码)</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">errorlevel</span> <span class="number">2</span> <span class="keyword">goto</span> mem</span><br><span class="line"><span class="keyword">if</span> errotlevel <span class="number">1</span> <span class="keyword">goto</span> end</span><br></pre></td></tr></table></figure></p>
<h2>For 命令</h2>
<p>for 命令是一个比较复杂的命令，主要用于参数在指定的范围内循环执行命令。</p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> &#123;%variable | <span class="variable">%%v</span>ariable&#125; <span class="keyword">in</span> (<span class="built_in">set</span>) <span class="keyword">do</span> command [command-parameters]</span><br></pre></td></tr></table></figure></p>
<ul>
<li><code>%variable</code> 指定一个单一字母可替换的参数。变量名称是区分大小写的，所以 %i 不同于 %I,在批处理文件中使用 FOR 命令时，指定变量建议用 %%variable而不要用 %variable</li>
<li><code>set</code> 指定一个或一组文件。可以使用通配符</li>
<li><code>command</code> 指定对每个文件执行的命令</li>
<li><code>command-parameters</code> 为特定命令指定参数或命令行开关。</li>
</ul>
<h3>如果命令扩展名被启用，额外的 FOR 命令格式会受到支持</h3>
<p>a.
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FOR</span> /D %variable <span class="keyword">IN</span> (<span class="built_in">set</span>) <span class="keyword">DO</span> command [command-parameters]</span><br></pre></td></tr></table></figure></p>
<p>如果集里面包含通配符，则指定与目录名匹配，而不与文件名匹配。</p>
<p>b.
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FOR</span> /R [[drive:]<span class="built_in">path</span>] %variable <span class="keyword">IN</span> (<span class="built_in">set</span>) <span class="keyword">DO</span> command [command-parameters]</span><br></pre></td></tr></table></figure></p>
<p>检查以 [drive:]path 为根的目录树，指向每个目录中的FOR 语句。</p>
<p>如果在 /R 后没有指定目录，则使用当前目录。如果集仅为一个单点(.)字符，则枚举该目录树。</p>
<p>c.
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FOR</span> /L %variable <span class="keyword">IN</span> (<span class="built_in">start</span>,step,end) <span class="keyword">DO</span> command [command-parameters]</span><br></pre></td></tr></table></figure></p>
<p>该集表示以增量形式从开始到结束的一个数字序列。</p>
<p>如：(1,1,5) 将产生序列 1 2 3 4 5； 而(5,-1,1) 将产生序列 (5 4 3 2 1)。</p>
<p>d.有或者没有 usebackq 选项:
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FOR</span> /F ["options"] %variable <span class="keyword">IN</span> (file-<span class="built_in">set</span>) <span class="keyword">DO</span> command</span><br><span class="line"><span class="keyword">FOR</span> /F ["options"] %variable <span class="keyword">IN</span> ("string") <span class="keyword">DO</span> command</span><br><span class="line"><span class="keyword">FOR</span> /F ["options"] %variable <span class="keyword">IN</span> (command) <span class="keyword">DO</span> command</span><br></pre></td></tr></table></figure></p>
<p>参数&quot;options&quot;为:</p>
<ol>
<li>eol=c - 指一个行注释字符的结尾(就一个,如“;”)</li>
<li>skip=n - 指在文件开始时忽略的行数。</li>
<li>delims=xxx - 指分隔符集。这个替换了空格和跳格键的默认分隔符集。</li>
<li>tokens=x,y,m-n - 指每行的哪一个符号被传递到每个迭代的 for 本身。这会导致额外变量名称的分配。</li>
<li>m-n格式为一个范围。通过 nth 符号指定 mth。</li>
</ol>
<p>如果符号字符串中的最后一个字符星号，那么额外的变量将在最后一个符号解析之后分配并接受行的保留文本。</p>
<p>usebackq - 指定新语法已在下类情况中使用:</p>
<p>在作为命令执行一个后引号的字符串并且一个单引号字符为文字字符串命令并允许在 filenameset中使用双引号扩起文件名称。</p>
<ol>
<li>显示当前目录下所有以bat或者txt为扩展名的文件名</li>
</ol>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> <span class="variable">%%c</span> <span class="keyword">in</span> (*.bat *.txt) <span class="keyword">do</span> (<span class="built_in">echo</span> <span class="variable">%%c</span>)</span><br></pre></td></tr></table></figure></p>
<p>a. 显示当前目录下所有包含有 e 或者 i 的目录名</p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> /D <span class="variable">%%a</span> <span class="keyword">in</span> (*e* *i*) <span class="keyword">do</span> <span class="built_in">echo</span> <span class="variable">%%a</span></span><br></pre></td></tr></table></figure></p>
<p>b. 显示 E盘test目录 下所有以bat或者txt为扩展名的文件名。</p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> /R E:\test <span class="variable">%%b</span> <span class="keyword">in</span> (*.txt *.bat) <span class="keyword">do</span> <span class="built_in">echo</span> <span class="variable">%%b</span></span><br><span class="line"><span class="keyword">for</span> /r <span class="variable">%%c</span> <span class="keyword">in</span> (*) <span class="keyword">do</span> (<span class="built_in">echo</span> <span class="variable">%%c</span>) :: 遍历当前目录下所有文件</span><br></pre></td></tr></table></figure></p>
<p>c. 如下命令行将产生序列 1 2 3 4 5
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> /L <span class="variable">%%c</span> <span class="keyword">in</span> (<span class="number">1</span>,<span class="number">1</span>,<span class="number">5</span>) <span class="keyword">do</span> <span class="built_in">echo</span> <span class="variable">%%c</span></span><br></pre></td></tr></table></figure></p>
<p>d. 以下两句，显示当前的年月日和时间
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">For</span> /f "tokens=<span class="number">1</span>-<span class="number">3</span> delims=-/. " <span class="variable">%%j</span> <span class="keyword">In</span> ('<span class="built_in">Date</span> /T') <span class="keyword">do</span> <span class="built_in">echo</span> <span class="variable">%%j</span>年<span class="variable">%%k</span>月<span class="variable">%%l</span>日</span><br><span class="line"></span><br><span class="line"><span class="keyword">For</span> /f "tokens=<span class="number">1</span>,<span class="number">2</span> delims=: " <span class="variable">%%j</span> <span class="keyword">In</span> ('<span class="built_in">TIME</span> /T') <span class="keyword">do</span> <span class="built_in">echo</span> <span class="variable">%%j</span>时<span class="variable">%%k</span>分</span><br></pre></td></tr></table></figure></p>
<p>e. 把记事本中的内容每一行前面去掉8个字符
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">setlocal</span> enabledelayedexpansion</span><br><span class="line"><span class="keyword">for</span> /f <span class="variable">%%i</span> <span class="keyword">in</span> (zhidian.txt) <span class="keyword">do</span> (</span><br><span class="line"><span class="built_in">set</span> atmp=<span class="variable">%%i</span></span><br><span class="line"><span class="built_in">set</span> atmp=<span class="variable">!atmp:~8!</span></span><br><span class="line"><span class="keyword">if</span> &#123;<span class="variable">!atmp!</span>&#125;==&#123;&#125; ( <span class="built_in">echo</span>.) <span class="keyword">else</span> <span class="built_in">echo</span> <span class="variable">!atmp!</span></span><br><span class="line"></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">REM 读取记事本里的内容(使用 delims 是为了把一行显示全,否则会以空格为分隔符)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> /f "delims=" <span class="variable">%%a</span> <span class="keyword">in</span> (zhidian.txt) <span class="keyword">do</span> <span class="built_in">echo</span>.<span class="variable">%%a</span></span><br></pre></td></tr></table></figure></p>
<h2>continue 和 break</h2>
<p>利用 goto 实现程序中常用的 continue 和 break 命令, 其实非常简单</p>
<ol>
<li><code>continue</code> 在 for 循环的最后一行写上一个标签，跳转到这位置即可</li>
<li><code>break</code> 在 for 循环的外面的下一句写上一个标签，跳转到这位置即可</li>
</ol>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> /F ["options"] %variable <span class="keyword">IN</span> (command) <span class="keyword">DO</span> (</span><br><span class="line">... <span class="keyword">do</span> command ...</span><br><span class="line"><span class="keyword">if</span> ... <span class="keyword">goto</span> continue</span><br><span class="line"><span class="keyword">if</span> ... <span class="keyword">goto</span> <span class="built_in">break</span></span><br><span class="line">... <span class="keyword">do</span> command ...</span><br><span class="line">:continue</span><br><span class="line">)</span><br><span class="line">:<span class="built_in">break</span></span><br></pre></td></tr></table></figure></p>
<h1>其它命令</h1>
<h2>ping 命令</h2>
<p>测试网络联接状况以及信息包发送和接收状况。但是不能够测试端口。</p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ping</span> IP地址或主机名 [-t] [-a] [-n count] [-l size]</span><br></pre></td></tr></table></figure></p>
<p>参数含义：</p>
<ul>
<li>-t 不停地向目标主机发送数据；</li>
<li>-a 以IP地址格式来显示目标主机的网络地址；</li>
<li>-n count 指定要Ping多少次，具体次数由count来指定；</li>
<li>-l size 指定发送到目标主机的数据包的大小。</li>
</ul>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">REM 不停的测试192.168.0.1，按ctrl+c停止</span></span><br><span class="line"><span class="built_in">ping</span> <span class="number">192</span>.<span class="number">168</span>.<span class="number">0</span>.<span class="number">1</span> -t ()</span><br><span class="line"></span><br><span class="line"><span class="comment">REM ping一下所有的局域网电脑</span></span><br><span class="line"><span class="keyword">for</span> /L <span class="variable">%%a</span> <span class="keyword">in</span> (<span class="number">0</span>,<span class="number">1</span>,<span class="number">255</span>) <span class="keyword">do</span> <span class="built_in">ping</span> <span class="number">192</span>.<span class="number">168</span>.<span class="number">0</span>.<span class="variable">%%a</span> -n <span class="number">1</span> &gt;&gt; tmp.txt</span><br></pre></td></tr></table></figure></p>
<h2>telnet 命令</h2>
<p>测试端口使用 telnet IP地址或主机名 端口，使用tcp协议的
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">telnet <span class="number">192</span>.<span class="number">168</span>.<span class="number">0</span>.<span class="number">1</span> <span class="number">80</span> (测试<span class="number">192</span>.<span class="number">168</span>.<span class="number">0</span>.<span class="number">1</span>的<span class="number">80</span>端口)</span><br></pre></td></tr></table></figure></p>
<h2>color 命令</h2>
<p>设置背景及字体颜色
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">color</span> bf</span><br></pre></td></tr></table></figure></p>
<p>b 是指定背景色的十六进制数字； f 指定前景颜色(即字体颜色)。</p>
<p>颜色值: 0:黑色 1:蓝色 2:绿色 3:湖蓝 4:红色 5:紫色 6:** 7:白色</p>
<p>8:灰色 9:淡蓝 A:淡绿 B:浅绿 C:淡红 D:淡紫 E:淡黄 F:亮白</p>
<p>如果没有给定任何参数，该命令会将颜色还原到 CMD.EXE 启动时的颜色。</p>
<p>如果两参数一样，视为无效输入。只有一个参数时，设置字体。</p>
<h2>random 命令</h2>
<p>产生随机数(正整数0~)</p>
<h2>exit 命令</h2>
<p>结束程序。即时是被调用的程序，结束后也不会返回原程序</p>
<h2>shutdown命令</h2>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">REM关机</span></span><br><span class="line">shutdown -s</span><br></pre></td></tr></table></figure></p>
<h1>字符串处理</h1>
<h2>分割字符串，以查看时间为例</h2>
<p>%源字符串:~起始值,截取长度% (起始值从0开始；截取长度是可选的，如果省略逗号和截取长度，将会从起始值截取到结尾；</p>
<p>截取长度如果是负数，表示截取到倒数第几个。)</p>
<ol>
<li><code>%time%</code> 显示如：&quot;11:04:23.03&quot; (完整的时间&quot;hh:mm:ss.tt&quot;)</li>
<li><code>%time:~0,5%</code> 显示&quot;hh:mm&quot;(即&quot;11:04&quot;)，其中0表示从右向左移位操作的个数，5表示从左向右移位操作的个数</li>
<li><code>%time:~0,8%</code> 显示标准时间格式&quot;hh:mm:ss&quot;(即&quot;11:04:23&quot;，前8个字符串)</li>
<li><code>%time:~3,-3%</code> 显示&quot;mm:ss&quot;(即从第4个开始,截去最后3个的字符串)</li>
<li><code>%time:~3%</code> 显示&quot;04:23.03&quot;(即去掉前4个字符串)</li>
<li><code>%time:~-3%</code> 显示&quot;.tt&quot;(即最后3个字符串)</li>
</ol>
<p>上面的字串分割格式，也可以用于其它地方，如目录路径：&quot;%cd:~0,10%&quot;</p>
<h2>替换字符串</h2>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> a="abcd1234"</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">%a%</span> 显示："abcd1234"</span><br><span class="line"><span class="built_in">set</span> a=<span class="variable">%a:1=kk%</span> 替换“<span class="number">1</span>”为“kk”</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">%a%</span> 显示："abcdkk234"</span><br></pre></td></tr></table></figure></p>
<h2>字符串合并</h2>
<p>由于没有直接的字符串合并函数，只能用笨方法了。
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> str1=<span class="variable">%str1%</span><span class="variable">%str2%</span> (合并 str1 和 str2)</span><br></pre></td></tr></table></figure></p>
<h2>计算字符串长度</h2>
<p>没有现成的函数。如下程序利用 goto形成循环，不断将字符串截短1，并记录截短的次数，到字符串变成空时的次数即长度。
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> testStr=This is a test string</span><br><span class="line"><span class="comment">REM 将 testStr 复制到str，str 是个临时字符串</span></span><br><span class="line"><span class="built_in">set</span> str=<span class="variable">%testStr%</span></span><br><span class="line"><span class="comment">REM 标签，用于goto跳转</span></span><br><span class="line">:next1</span><br><span class="line"><span class="comment">REM 判断str是不是空，如果不是则执行下边的语句</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> "<span class="variable">%str%</span>"=="" (</span><br><span class="line"><span class="comment">REM 算术运算，使num的值自增1，相当于num++或者++num语句</span></span><br><span class="line"><span class="built_in">set</span> /a num+=<span class="number">1</span></span><br><span class="line"><span class="comment">REM 截取字符串，每次截短1</span></span><br><span class="line"><span class="built_in">set</span> "str=<span class="variable">%str:~1%</span>"</span><br><span class="line"><span class="comment">REM 跳转到next1标签: 这里利用goto和标签，构成循环结构</span></span><br><span class="line"><span class="keyword">goto</span> next1</span><br><span class="line"></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">REM 当以上循环结构执行完毕时，会执行下边的语句</span></span><br><span class="line"><span class="built_in">echo</span> testStr=<span class="variable">%testStr%</span></span><br><span class="line"><span class="built_in">echo</span> testStr的长度为：<span class="variable">%num%</span></span><br></pre></td></tr></table></figure></p>
<h2>截取字符串时，需要传递参数</h2>
<p>直接 echo %args:~%num%,-5% 没办法想要的字符串，需要如下两步
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">setlocal</span> enabledelayedexpansion</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">!args:~%num%,-5!</span></span><br></pre></td></tr></table></figure></p>
<h1>注册表操作</h1>
<h2>备份注册表</h2>
<ul>
<li>将[HKEY_LOCAL_MACHINE ... Run]的内容，备份到“c:\windows\1.reg”</li>
</ul>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">reg export HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run c:\windows\<span class="number">1</span>.reg</span><br><span class="line">reg export HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run c:\windows\<span class="number">2</span>.reg</span><br></pre></td></tr></table></figure></p>
<h2>修改/添加注册表内容</h2>
<ul>
<li>一般的添加或修改
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reg add "HKCU\Environment" /v Java_Home /t reg_sz /d "D:\Java\jdk1.<span class="number">6</span>.<span class="number">0</span>_07" /f</span><br></pre></td></tr></table></figure></li>
</ul>
<p>上句解析：“HKCU”是“HKEY_CURRENT_USER”的缩写，不用缩写用全称也可以；</p>
<p>添加名称为“Java_Home”的变量；类型为“reg_sz”，另一种常见类型是“reg_dword”；值为 D:\Java\jdk1.6.0_07；</p>
<h2>使用变量</h2>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> SoftWareHome=HKEY_LOCAL_MACHINE\SOFTWARE\JavaSoft\Java</span><br><span class="line">reg add "<span class="variable">%SoftWareHome%</span>Web <span class="built_in">Start</span>\<span class="number">1</span>.<span class="number">6</span>.<span class="number">0</span>_07" /v Home /t reg_sz /d "<span class="variable">%cd%</span>\jre1.<span class="number">6</span>.<span class="number">0</span>_07\bin" /f</span><br></pre></td></tr></table></figure></p>
<h2>注册表的名称有空格，或者数据用特殊符号时</h2>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">reg add "<span class="variable">%SoftWareHome2%</span>\HelpCommands" /v "<span class="number">01</span>:Online Documentation" /t reg_sz /d "\"<span class="variable">%cd%</span>\Documentation\Index.htm\"" /f</span><br><span class="line"></span><br><span class="line"><span class="comment">REM 传入值为(值用双引号括起来的)："D:\ProgramFiles\1.work_soft\Sybase\PowerDesigner_12\Documentation\Index.htm"</span></span><br><span class="line">reg add "<span class="variable">%SoftWareHome2%</span>\Paths" /v ReportTemplates /t reg_sz /d "<span class="variable">%cd%</span>\Resource Files\Report Templates\\" /f</span><br><span class="line"></span><br><span class="line">传入值为(“\”结尾的)： E:\Holemar\<span class="number">1</span>.notes\<span class="number">90</span>. Windows\Resource Files\Report Templates\</span><br></pre></td></tr></table></figure></p>
<h2>增加空的内容</h2>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Shared Tools\MSConfig\startupreg\IMJPMIG8.<span class="number">1</span>"</span><br></pre></td></tr></table></figure></p>
<h2>添加或修改默认值</h2>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reg add "<span class="variable">%vpath%</span>InstallPath" /ve /t reg_sz /d "<span class="variable">%cd%</span>" /f</span><br></pre></td></tr></table></figure></p>
<p>这里用“/ve”来代替一般修改时的“/v 变量名”,即可修改默认值了</p>
<h2>删除注册表的内容</h2>
<p>双引号里面的是注册表的目录，下面两句将删除这目录下的所有信息
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">reg delete "HKEY_CURRENT_USER\Software\RealVNC" /f</span><br><span class="line">reg delete "HKEY_LOCAL_MACHINE\SOFTWARE\RealVNC" /f</span><br></pre></td></tr></table></figure></p>
<p>双引号里面的是注册表的目录，下面一句将删除这目录下指定的某个信息
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reg delete "HKEY_LOCAL_MACHINE\Software\RealVNC" /v VNC_Server /f</span><br></pre></td></tr></table></figure></p>
<h2>注册表的常用位置</h2>
<p>系统启动项：
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run]</span><br><span class="line">[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run]</span><br><span class="line"><span class="function">example: <span class="title">REG</span> <span class="title">ADD</span> <span class="title">HKEY_LOCAL_MACHINE</span>\<span class="title">Software</span>\<span class="title">Microsoft</span>\<span class="title">Windows</span>\<span class="title">CurrentVersion</span>\<span class="title">Run</span> /<span class="title">v</span> <span class="title">VNC_Server</span> /<span class="title">t</span> <span class="title">REG_SZ</span> /<span class="title">d</span> "%<span class="title">cd</span>%\<span class="title">VNC_Server.bat</span>" /<span class="title">f</span></span></span><br></pre></td></tr></table></figure></p>
<h2>系统环境变量：</h2>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment]</span><br></pre></td></tr></table></figure></p>
<h2>当前用户的环境变量：</h2>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[HKEY_CURRENT_USER\Environment]</span><br></pre></td></tr></table></figure></p>
<h2>刷新注册表</h2>
<p>修改注册表之后，结束并重新加载explorer.exe进程，可刷新注册表，令其生效</p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">taskkill</span> /f /im explorer.exe &gt;<span class="built_in">nul</span></span><br><span class="line"><span class="built_in">start</span> "" "explorer.exe"</span><br></pre></td></tr></table></figure></p>
<h1>系统服务</h1>
<h2>停止/启动</h2>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">REM 停止服务</span></span><br><span class="line"><span class="built_in">NET</span> STOP 服务名</span><br><span class="line"></span><br><span class="line"><span class="comment">REM 启动服务</span></span><br><span class="line"><span class="built_in">NET</span> <span class="built_in">Start</span> 服务名</span><br></pre></td></tr></table></figure></p>
<h2>设置启动类型</h2>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">REM 自动： </span></span><br><span class="line">SC CONFIG 服务名 <span class="built_in">START</span>= auto</span><br><span class="line"></span><br><span class="line"><span class="comment">REM 手动： </span></span><br><span class="line">SC CONFIG 服务名 <span class="built_in">START</span>= demand</span><br><span class="line"></span><br><span class="line"><span class="comment">REM 已禁用：</span></span><br><span class="line">SC CONFIG 服务名 <span class="built_in">START</span>= disabled</span><br></pre></td></tr></table></figure></p>
<p>附：“START= ”等号后面必须要有一个空格。(start还有boot,system两个值)</p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">REM 打印机加载项，设置成手动，默认自动</span></span><br><span class="line">SC CONFIG Spooler <span class="built_in">START</span>= demand</span><br></pre></td></tr></table></figure></p>
<h2>查看系统服务：</h2>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">start</span> <span class="variable">%SystemRoot%</span>\system32\services.msc /s</span><br></pre></td></tr></table></figure></p>
<h1>setlocal与变量延迟</h1>
<p>在没有开启变量延迟的情况下，某条命令行中的变量改变，必须到下一条命令才能体现。另外例如for命令等，其后用一对圆括号闭合的所有语句也当作一行。</p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> a=<span class="number">4</span></span><br><span class="line"><span class="built_in">set</span> a=<span class="number">5</span> &amp; <span class="built_in">echo</span> <span class="variable">%a%</span></span><br></pre></td></tr></table></figure></p>
<p>结果：4</p>
<p>也可以对这种机制加以利用，如下的变量交换</p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> var1=abc</span><br><span class="line"><span class="built_in">set</span> var2=<span class="number">123</span></span><br><span class="line"><span class="built_in">echo</span> 交换前： var1=<span class="variable">%var1%</span> var2=<span class="variable">%var2%</span></span><br><span class="line"><span class="built_in">set</span> var1=<span class="variable">%var2%</span>&amp; <span class="built_in">set</span> var2=<span class="variable">%var1%</span></span><br><span class="line"><span class="built_in">echo</span> 交换后： var1=<span class="variable">%var1%</span> var2=<span class="variable">%var2%</span></span><br></pre></td></tr></table></figure></p>
<ul>
<li>启动批处理文件中环境变量的本地化。本地化将持续到出现匹配的 endlocal 命令或者到达批处理文件结尾为止。</li>
</ul>
<p>语法:
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">setlocal</span> &#123;enableextension | disableextensions&#125; &#123;enabledelayedexpansion | disabledelayedexpansion&#125;</span><br></pre></td></tr></table></figure></p>
<ol>
<li><code>enableextension</code> 启用命令扩展，直到出现匹配的 endlocal 命令，无论 setlocal 命令之前的设置如何。</li>
<li><code>disableextensions</code> 禁用命令扩展，直到出现匹配的 endlocal 命令，无论 setlocal 命令之前的设置如何。</li>
<li><code>enabledelayedexpansion</code> 启用延迟的环境变量扩展，直到出现匹配的 endlocal 命令，无论 setlocal 命令之前的设置如何。</li>
<li><code>disabledelayedexpansion</code> 禁用延迟的环境变量扩展，直到出现匹配的 endlocal 命令，无论 setlocal 命令之前的设置如何。</li>
</ol>
<ul>
<li>为了能够感知环境变量的动态变化，批处理设计了变量延迟。简单来说，在读取了一条完整的语句之后，不立即对该行的变量赋值，而会在某个单条语句执行之前再进行赋值，也就是说“延迟”了对变量的赋值。</li>
</ul>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">setlocal</span> enabledelayedexpansion</span><br><span class="line"><span class="built_in">set</span> a=<span class="number">4</span></span><br><span class="line"><span class="built_in">set</span> a=<span class="number">5</span> &amp; <span class="built_in">echo</span> <span class="variable">!a!</span></span><br></pre></td></tr></table></figure></p>
<p>结果： 5</p>
<p>变量延迟的启动语句是“setlocal enabledelayedexpansion”，并且变量要用一对叹号“!!”括起来</p>
<p>由于启动了变量延迟，所以批处理能够感知到动态变化，即不是先给该行变量赋值，而是在运行过程中给变量赋值，因此此时a的值就是5了</p>
<p>另外，启动变量延迟，“%”的变量还是不变</p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">setlocal</span> enabledelayedexpansion</span><br><span class="line"><span class="keyword">for</span> /l <span class="variable">%%i</span> <span class="keyword">in</span> (<span class="number">1</span>,<span class="number">1</span>,<span class="number">5</span>) <span class="keyword">do</span> (</span><br><span class="line"><span class="built_in">set</span> a=<span class="variable">%%i</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">!a!</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<p>结果，打印从1到5；如果不变量延迟，一个变量也没有打印</p>
<h1>文件处理</h1>
<h2>删除</h2>
<ul>
<li>删除一个文件或多个文件</li>
</ul>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">del</span> /s /q /f d:\test\a.bat</span><br></pre></td></tr></table></figure></p>
<p>将直接删除d:\test\a.bat，没有任务提示</p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">del</span> temp\* /q /f /s</span><br></pre></td></tr></table></figure></p>
<p>将直接删除 本目录的 temp 目录的所有文件，没有任务提示
删除文件的时候可以使用“*”作通配符</p>
<ul>
<li>删除一个空目录</li>
</ul>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">rd</span> /q /s d:\test\log</span><br></pre></td></tr></table></figure></p>
<p>将直接删除d:\test\log目录，如果log目录里面有文件将无法删除</p>
<ul>
<li>删除一个非空目录 (必须指定目录名称)</li>
</ul>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">rmdir</span> /q /s d:\test\logs</span><br></pre></td></tr></table></figure></p>
<p>必须指定目录名称，不能使用通配符</p>
<ol>
<li><code>/S</code> 除目录本身外，还将删除指定目录下的所有子目录</li>
<li><code>/Q</code> 安静模式，带 /S 删除目录树时不要求确认</li>
</ol>
<p>无论里面是否有文件或文件夹将全部直接删除</p>
<h2>创建目录</h2>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">MKDIR</span> [drive:]<span class="built_in">path</span></span><br><span class="line"><span class="built_in">MD</span> [drive:]<span class="built_in">path</span></span><br></pre></td></tr></table></figure></p>
<p>路径有空格时，可以用双引号括起来，也可以用   替代</p>
<h1>实践部分</h1>
<ol>
<li>
<p>调用其他程序时，对文件的大小写不敏感，文件后缀也可忽略,如：<code>start LeapFTP.exe</code> 与 <code>start leapftp</code> 效果一样，都是运行“LeapFTP.exe”文件。每行的开头的字符串会自动查找程序来运行，还可用双引号引起来(文件名或目录名含空格时必须用),如：&quot;D:\Program Files\Leap FTP.exe&quot; &quot;LeapFTP.exe&quot; 可正常运行文件，start &quot;&quot; &quot;LeapFTP.exe&quot; 也可以正常运行文件(注意，第一个参数是窗口显示的标题)</p>
</li>
<li>
<p><code>copy C:\test\*.* D:\back</code> (复制C盘test文件夹的所有文件(不包括文件夹及子文件夹里的东西)到D盘的back文件夹)</p>
</li>
<li>
<p><code>dir c:\*.* &gt; a.txt</code> (将c盘文件列表写入 a.txt 中)</p>
</li>
<li>
<p><code>&gt;</code> 生成文件并写入内容(如果有这文件则覆盖)，<code>&gt;&gt;</code> 文件里追加内容</p>
</li>
<li>
<p><code>md d:\aa</code> (创建文件夹)</p>
</li>
<li>
<p>在命令末尾加上 <code>&gt;NUL 2&gt;NUL</code>，表示隐蔽返回信息。</p>
</li>
<li>
<p>等待用户输入：set /p 变量名=屏幕显示信息</p>
</li>
</ol>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> /p pass=请输入密码:</span><br></pre></td></tr></table></figure></p>
<ol start="9">
<li>让用户按回车退出,小技巧(替代pause)，文件的最后一句：</li>
</ol>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> /p tmp=操作结束，请按回车键退出...</span><br></pre></td></tr></table></figure></p>
<ol start="10">
<li>
<p>设置标题： <code>title JDK安装</code></p>
</li>
<li>
<p>设置屏幕显示颜色，如绿色: <code>color 0a</code></p>
</li>
<li>
<p>清屏： <code>cls</code></p>
</li>
<li>
<p>查看自己的IP</p>
</li>
</ol>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> /f "tokens=<span class="number">15</span>" <span class="variable">%%i</span> <span class="keyword">in</span> ('<span class="built_in">ipconfig</span> ^| <span class="built_in">find</span> /i "ip address"') <span class="keyword">do</span> <span class="built_in">set</span> ip=<span class="variable">%%i</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">%ip%</span> (这时的 <span class="variable">%ip%</span> 就是自己的IP地址)</span><br></pre></td></tr></table></figure></p>
<ol start="14">
<li>修改文件的更新日期</li>
</ol>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">copy</span> 文件名+,,&gt;<span class="built_in">nul</span> (修改为当前时间，如果要修改为指定时间，先修改系统时间，再改回系统时间)</span><br></pre></td></tr></table></figure></p>
<ol start="15">
<li>修改文件的后缀名</li>
</ol>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ren</span> C:\test\*.jpg *.JPG</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> /r <span class="variable">%%c</span> <span class="keyword">in</span> (*.jpg) <span class="keyword">do</span> (<span class="built_in">ren</span> <span class="variable">%%c</span> *.JPG) :: 修改当前目录下的所有文件的后缀名，包括子目录的</span><br></pre></td></tr></table></figure></p>
<ol start="16">
<li>修改文件的文件名</li>
</ol>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">rename</span> test.jpg test2.JPG</span><br><span class="line"><span class="built_in">rename</span> *.jpg *.<span class="number">888</span>.JPG</span><br></pre></td></tr></table></figure></p>
<ol start="17">
<li>查看DNS、IP、Mac等</li>
</ol>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">REM Win08</span></span><br><span class="line">winipcfg</span><br><span class="line"></span><br><span class="line"><span class="built_in">Ipconfig</span> /all</span><br><span class="line"></span><br><span class="line">NSLOOKUP</span><br></pre></td></tr></table></figure></p>
<ol start="18">
<li>查看IP上的共享资源，就可以</li>
</ol>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">net</span> view <span class="number">192</span>.<span class="number">168</span>.<span class="number">10</span>.<span class="number">8</span></span><br></pre></td></tr></table></figure></p>
<ol start="19">
<li>共享</li>
</ol>
<p>A. 查看你机器的共享资源:
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">net</span> share</span><br></pre></td></tr></table></figure></p>
<p>B. 手工删除共享</p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">net</span> share 共享资源名称$ /d</span><br></pre></td></tr></table></figure></p>
<p>注意$后有空格。</p>
<p>C. 增加一个共享：</p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">net</span> share mymovie=e:\downloads\movie /users:<span class="number">3</span></span><br></pre></td></tr></table></figure></p>
<p>mymovie 共享成功。 同时限制链接用户数为3人。</p>
<ol start="20">
<li>打开某网站</li>
</ol>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">start</span> iexplore.exe http://www.baidu.com</span><br></pre></td></tr></table></figure></p>
<h1>实例</h1>
<ol>
<li>生成 reg 文件，运行它，再删除它</li>
</ol>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> "更改windows安装文件的路径"</span><br><span class="line"><span class="built_in">echo</span> Windows Registry Editor Version <span class="number">5</span>.<span class="number">00</span> &gt; c:\setupreg.reg</span><br><span class="line"><span class="built_in">echo</span> [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Setup] &gt;&gt; c:\setupreg.reg</span><br><span class="line"><span class="built_in">echo</span> "ServicePackSourcePath"="D:\\Win2003\\" &gt;&gt; c:\setupreg.reg</span><br><span class="line"><span class="built_in">echo</span> "SourcePath"="D:\\Win2003\\" &gt;&gt; c:\setupreg.reg</span><br><span class="line"></span><br><span class="line"><span class="comment">REM 写入注册表</span></span><br><span class="line">regedit /S c:\setupreg.reg</span><br><span class="line"></span><br><span class="line"><span class="comment">REM 删除注册表文件</span></span><br><span class="line"><span class="built_in">del</span> c:\setupreg.reg</span><br></pre></td></tr></table></figure></p>
<ol start="2">
<li>调用了exe文件,结束后没有关闭，解决方法:用start命令运行文件，如</li>
</ol>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">start</span> LeapFTP.exe <span class="number">192</span>.<span class="number">168</span>.<span class="number">0</span>.<span class="number">100</span></span><br></pre></td></tr></table></figure></p>
<ol start="3">
<li>设置系统环境变量</li>
</ol>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">REM 有这个环境变量，则不需再设置，直接结束</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> "<span class="variable">%JAVA_HOME%</span>" == "" <span class="keyword">exit</span></span><br><span class="line"></span><br><span class="line"><span class="comment">REM 设置环境变量的地址</span></span><br><span class="line"><span class="built_in">set</span> inputJavaHome=<span class="variable">%cd%</span>\jdk1.<span class="number">6</span>.<span class="number">0</span>_07</span><br><span class="line"></span><br><span class="line"><span class="comment">REM 设置环境变量，也可以设置当前用户的变量</span></span><br><span class="line"><span class="built_in">set</span> EnvironmentHome=HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> 正在设置环境变量，请稍候......</span><br><span class="line">reg add "<span class="variable">%EnvironmentHome%</span>" /v JAVA_HOME /t reg_sz /d "<span class="variable">%inputJavaHome%</span>" /f</span><br><span class="line">reg add "<span class="variable">%EnvironmentHome%</span>" /v ClassPath /t reg_sz /d ".;<span class="variable">%%J</span>AVA_HOME<span class="variable">%%\</span>lib" /f</span><br><span class="line">reg add "<span class="variable">%EnvironmentHome%</span>" /v <span class="built_in">Path</span> /t reg_sz /d "<span class="variable">%%J</span>AVA_HOME<span class="variable">%%\</span>bin;<span class="variable">%Path%</span>" /f]</span><br><span class="line"></span><br><span class="line"><span class="comment">REM 刷新，令环境变量生效</span></span><br><span class="line"><span class="built_in">taskkill</span> /f /im explorer.exe &gt;<span class="built_in">nul</span></span><br><span class="line"><span class="built_in">start</span> "" "explorer.exe"</span><br></pre></td></tr></table></figure></p>
<ol start="4">
<li>隐藏某目录的所有文件及文件夹</li>
</ol>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /d 要隐藏的目录(如：D:)</span><br><span class="line"><span class="keyword">for</span> /f "usebackq delims=" <span class="variable">%%A</span> <span class="keyword">in</span> (`<span class="built_in">dir</span> /a /b`) <span class="keyword">do</span> (<span class="built_in">attrib</span> "<span class="variable">%%A</span>" -r +h -s)</span><br></pre></td></tr></table></figure></p>
<ol start="5">
<li>在批处理中使用密码。密码为admin，输入正确，跳转到next1 ，若输入密码错误3次，则锁屏。</li>
</ol>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"><span class="built_in">set</span> num=<span class="number">0</span></span><br><span class="line">:<span class="number">11</span></span><br><span class="line"><span class="built_in">set</span> /p pass=请输入密码:</span><br><span class="line"><span class="keyword">if</span> "<span class="variable">%pass%</span>"=="admin" <span class="keyword">goto</span> next1</span><br><span class="line"><span class="built_in">set</span> /a num=<span class="variable">%num%</span> + <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> <span class="variable">%num%</span>==<span class="number">3</span> <span class="keyword">goto</span> no1</span><br><span class="line"><span class="keyword">goto</span> <span class="number">11</span></span><br><span class="line">:no1</span><br><span class="line"><span class="variable">%windir%</span>\system32\rundll32.exe user32.dll,LockWorkStation</span><br><span class="line"><span class="keyword">goto</span> <span class="number">11</span></span><br><span class="line">:next1</span><br><span class="line"><span class="built_in">echo</span> 密码正确，执行下面的程式</span><br><span class="line"><span class="built_in">pause</span></span><br></pre></td></tr></table></figure></p>
<ol start="6">
<li>清空回收站(未成功)</li>
</ol>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"></span><br><span class="line"><span class="built_in">del</span> /f /s /q c:\recycler\*.*</span><br><span class="line"><span class="built_in">del</span> /f /s /q <span class="variable">%systemdrive%</span>\recycled\*.*</span><br><span class="line"></span><br><span class="line"><span class="comment">REM 新屏幕</span></span><br><span class="line"><span class="built_in">taskkill</span> /f /im explorer.exe &gt;<span class="built_in">nul</span></span><br><span class="line"><span class="built_in">start</span> "" "explorer.exe"</span><br></pre></td></tr></table></figure></p>
<ol start="7">
<li>让系统断断续续地鸣叫</li>
</ol>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"></span><br><span class="line">:begin</span><br><span class="line"><span class="comment">REM 发出鸣叫(“”实际就是ASCII码值为7的特殊字符（蜂鸣键beep）</span></span><br><span class="line"><span class="built_in">echo</span></span><br><span class="line"><span class="comment">REM 让程序暂停一小阵子</span></span><br><span class="line"><span class="built_in">ping</span> -n <span class="number">1</span> -l <span class="number">1</span> <span class="number">127</span>.<span class="number">1</span>&gt;<span class="built_in">nul</span></span><br><span class="line"><span class="keyword">goto</span> :begin</span><br></pre></td></tr></table></figure></p>
<ol start="8">
<li>将 FAT 卷转换成 NTFS</li>
</ol>
<p>利用“CONVERT.exe”进行,解析如下：
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">CONVERT</span> volume /<span class="built_in">FS</span>:NTFS [/V] [/CvtArea:filename] [/NoSecurity] [/X]</span><br></pre></td></tr></table></figure></p>
<ul>
<li><code>volume</code> 指定驱动器号(后面跟一个冒号)、装载点或卷名</li>
<li><code>/FS:NTFS</code> 指定要被转换成 NTFS 的卷</li>
<li><code>/V</code> 指定 Convert 应该用详述模式运行</li>
<li><code>/CvtArea:filename</code>将根目录中的一个接续文件指定为NTFS 系统文件的占位符</li>
<li><code>/NoSecurity</code> 指定每个人都可以访问转换的文件和目录的安全设置</li>
<li><code>/X</code> 如果必要，先强行卸载卷。该卷的所有打开的句柄则无效</li>
</ul>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">@ <span class="built_in">ECHO</span> OFF</span><br><span class="line">@ <span class="built_in">ECHO</span>.</span><br><span class="line">@ <span class="built_in">ECHO</span>. 说 明</span><br><span class="line">@ <span class="built_in">ECHO</span> --------------------------------------------------------------------------</span><br><span class="line">@ <span class="built_in">ECHO</span> NTFS是一种磁盘格式。该格式能存放大于<span class="number">4</span>G的单个文件(如高清电影文件)，并可对</span><br><span class="line">@ <span class="built_in">ECHO</span> 文件夹进行加密，但有个缺点是DOS下无法访问。建议D盘及其后的盘使用NTFS格式，</span><br><span class="line">@ <span class="built_in">ECHO</span> C盘如非必要可以不转换，FAT32与NTFS这两种格式的读写速度几乎是没有差别的。</span><br><span class="line">@ <span class="built_in">ECHO</span> --------------------------------------------------------------------------</span><br><span class="line">@ <span class="built_in">ECHO</span>.</span><br><span class="line"></span><br><span class="line"><span class="built_in">convert</span> c: /<span class="built_in">fs</span>:ntfs</span><br><span class="line"><span class="comment">REM D盘也转成 NTFS</span></span><br><span class="line"><span class="built_in">convert</span> d: /<span class="built_in">fs</span>:ntfs</span><br></pre></td></tr></table></figure></p>
<ol start="9">
<li>获取我的文档</li>
</ol>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">SET</span> SF="HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders"</span><br><span class="line"></span><br><span class="line"><span class="keyword">FOR</span> /F "tokens=<span class="number">2</span>,*" <span class="variable">%%I</span> <span class="keyword">IN</span> ('REG QUERY <span class="variable">%SF%</span> /v Personal <span class="number">2</span>^&gt;<span class="built_in">NUL</span>^|<span class="built_in">FIND</span> /I "Personal"') <span class="keyword">DO</span> <span class="built_in">SET</span> "myDoc=<span class="variable">%%~</span>J"</span><br><span class="line"></span><br><span class="line"><span class="comment">REM 复制文件到我的文档</span></span><br><span class="line"><span class="built_in">XCOPY</span> /D /E /R /Y /C "<span class="variable">%cd%</span>\test.txt" "<span class="variable">%myDoc%</span>\test\"</span><br></pre></td></tr></table></figure></p>
<p>10 获取当前目录路径</p>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ./</span><br><span class="line"><span class="built_in">set</span> CURR_PATH=<span class="variable">%cd%</span></span><br></pre></td></tr></table></figure></p>
<ol start="11">
<li>IF-ERRORLEVEL</li>
</ol>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">ECHO</span> OFF</span><br><span class="line"><span class="built_in">XCOPY</span> C:\AUTOEXEC.BAT D:<span class="keyword">IF</span> <span class="keyword">ERRORLEVEL</span> <span class="number">1</span> <span class="built_in">ECHO</span> 文件拷贝失败</span><br><span class="line"><span class="keyword">IF</span> <span class="keyword">ERRORLEVEL</span> <span class="number">0</span> <span class="built_in">ECHO</span> 成功拷贝文件</span><br></pre></td></tr></table></figure></p>
<p>如果文件拷贝成功，屏幕就会显示“成功拷贝文件”，否则就会显示“文件拷贝失败”。</p>
<p><code>IF ERRORLEVEL</code> 是用来测试它的上一个DOS命令的返回值的，注意只是上一个命令的返回值，而且返回值必须依照从大到小次序顺序判断。因此下面的批处理文件是错误的：</p>
<hr>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off //不显示shell的命令。</span><br><span class="line"><span class="built_in">Setlocal</span> //环境改变只适用于这个文件。</span><br><span class="line"><span class="variable">%OS%</span> //为当前的操作系统。</span><br><span class="line"><span class="comment">Rem //注释一行文本。</span></span><br><span class="line"><span class="keyword">Goto</span> 标签 //改变执行顺序，去标签位置.</span><br><span class="line">：标签 //定义一个标签。</span><br><span class="line"><span class="built_in">Set</span> 变量名=值 //定义变量</span><br><span class="line"><span class="keyword">Not</span> //取反</span><br><span class="line">Netstat –na //显示当前被点用的端口.</span><br><span class="line">%<span class="number">0</span> %<span class="number">1</span> %<span class="number">2</span> //用于表示批处理文件的参数<span class="number">0</span>为命令,共<span class="number">1</span>-<span class="number">9</span>个参数。</span><br><span class="line"><span class="built_in">Shift</span> //用于向前一个参数，原<span class="number">1</span>变<span class="number">0</span>，原<span class="number">2</span>变<span class="number">1</span>.每调用一次<span class="built_in">shift</span>向前一移动一位。</span><br><span class="line"><span class="keyword">Call</span> //调用其他批处理文件或命令。</span><br><span class="line"><span class="built_in">Start</span> 命令 参数 //指示出在另一个窗口中开始运行命令。</span><br></pre></td></tr></table></figure></p>
<hr>
<ul>
<li>自动设置Java环境变量</li>
</ul>
<p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"><span class="keyword">IF</span> <span class="keyword">EXIST</span> %<span class="number">1</span>\bin\java.exe (</span><br><span class="line"><span class="comment">rem 如输入正确的 Java2SDK 安装目录，开始设置环境变量</span></span><br><span class="line">@setx JAVA_HOME %<span class="number">1</span></span><br><span class="line">@setx <span class="built_in">path</span> <span class="variable">%path%</span>;<span class="variable">%JAVA_HOME%</span>\bin</span><br><span class="line">@setx classpath <span class="variable">%classpath%</span>;.</span><br><span class="line">@setx classpath <span class="variable">%classpath%</span>;<span class="variable">%JAVA_HOME%</span>\lib\tools.jar</span><br><span class="line">@setx classpath <span class="variable">%classpath%</span>;<span class="variable">%JAVA_HOME%</span>\lib\dt.jar</span><br><span class="line">@setx classpath <span class="variable">%classpath%</span>;<span class="variable">%JAVA_HOME%</span>\jre\lib\rt.jar</span><br><span class="line">@<span class="built_in">echo</span> on</span><br><span class="line">@<span class="built_in">echo</span> Java <span class="number">2</span> SDK 环境参数设置完毕，正常退出。</span><br><span class="line">) <span class="keyword">ELSE</span> (</span><br><span class="line"><span class="keyword">IF</span> "%<span class="number">1</span>"=="" (</span><br><span class="line"><span class="comment">rem 如没有提供安装目录，提示之后退出</span></span><br><span class="line">@<span class="built_in">echo</span> on</span><br><span class="line">@<span class="built_in">echo</span> 没有提供 Java2SDK 的安装目录,不做任何设置，现在退出环境变量设置。</span><br><span class="line">) <span class="keyword">ELSE</span> (</span><br><span class="line"><span class="comment">rem 如果提供非空的安装目录但没有bin\java.exe，则指定的目录为错误的目录</span></span><br><span class="line">@<span class="built_in">echo</span> on</span><br><span class="line">@<span class="built_in">echo</span> 非法的 Java2SDK 的安装目录,不做任何设置，现在退出环境变量设置。</span><br><span class="line">)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<hr>
<p>本文部分内容转载自：http://m18333611647.blog.163.com/blog/static/225533041201422111365439/</p>

      

          <a href="/posts/Batch.html" class="post-more waves-effect waves-button">
            <i class="icon icon-bookmark">&nbsp;</i> 阅读全文…
          </a>
      </div>
      
      <div class="post-footer">
          
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Win/">Win</a></li></ul>

      </div>
      
  </article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-OpenSourceSearch"
    class="article-card article-type-post" itemprop="blogPost">

      <div class="post-meta">
          <time class="post-time" title="2019-11-14 18:23:35" datetime="2019-11-14T10:23:35.000Z"  itemprop="datePublished"><i class="icon icon-calendar"></i> 2019-11-14</time>

          
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Coding/">Coding</a></li></ul>



          
      </div>

      


  
    <h3 class="post-title" itemprop="name">
      <a class="post-title-link" href="/posts/OpenSourceSearch.html">如何高效寻找开源项目</a>
    </h3>
  



      <div class="post-content" id="post-content" itemprop="postContent">

      
          <p>Github 中高效寻找搜索开源项目</p>
<h1>in:name</h1>
<p>搜索时使用 <code>in:name</code> 可以搜索名字包含的内容
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">in</span>:<span class="built_in">name</span> vue</span><br></pre></td></tr></table></figure></p>
<h2>搜索过滤</h2>
<ul>
<li>Stars 数</li>
</ul>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#匹配start书大于1000</span></span><br><span class="line"><span class="keyword">in</span>:name vue stasr&gt;1000</span><br></pre></td></tr></table></figure></p>
<p>&lt;!--more--&gt;</p>
<ul>
<li>Forks 数</li>
</ul>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#匹配Forkt书大于1000</span></span><br><span class="line"><span class="keyword">in</span>:name vue forks&gt;1000</span><br></pre></td></tr></table></figure></p>
<h2>条件并行使用</h2>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#匹配Forkt书大于1000</span></span><br><span class="line"><span class="keyword">in</span>:name vue stars&gt;1000 forks&gt;1000</span><br></pre></td></tr></table></figure></p>
<h1>in:description</h1>
<p>在描述中搜索
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">in:description 前端</span><br></pre></td></tr></table></figure></p>
<h2>language</h2>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">in</span>:description 前端 language:vue</span><br></pre></td></tr></table></figure></p>
<h2>pushed</h2>
<p>更新时间
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">in</span>:description 前端 language:vue pushed &gt;2019-10-01</span><br></pre></td></tr></table></figure></p>
<h2>条件并行使用</h2>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">in</span>:description 爬虫  language:python star&gt;1000  pushed &gt;2019-10-01</span><br></pre></td></tr></table></figure></p>
<h1>in:readme</h1>
<p>在 READMME 中搜索
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">in</span>:readme security stars&gt;1000</span><br></pre></td></tr></table></figure></p>

      

          <a href="/posts/OpenSourceSearch.html" class="post-more waves-effect waves-button">
            <i class="icon icon-bookmark">&nbsp;</i> 阅读全文…
          </a>
      </div>
      
      <div class="post-footer">
          
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Git/">Git</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Github/">Github</a></li></ul>

      </div>
      
  </article>

        </li>
    
    </ul>

    
<nav id="page-nav">
    <div class="inner">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/18/">18</a><a class="extend next" rel="next" href="/page/2/">下一页</a>
    </div>
</nav>


</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/xml/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>博客内容遵循 <a rel="license" href="https://creativecommons.org/licenses/by/4.0/deed.zh_CN">CC BY-NC-SA 4.0 国际协议</a></span>
        </p>
    </div>
    <div class="bottom">
        <p><span>Vitan &copy; 2017 - 2020</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>


    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: false, REWARD: false };


</script>

<script src="//unpkg.com/indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/indigo@latest/js/search.min.js" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '您似乎掉线了呢！';
            clearTimeout(titleTime);
        } else {
            document.title = '(つェ⊂)咦!又好了!';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
